<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Three Cubes Game: Minetest Lua Modding API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Three Cubes Game
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_resources_doc_lua_api.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Minetest Lua Modding API Reference </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>More information at <a href="http://www.minetest.net/">http://www.minetest.net/</a></li>
<li>Developer Wiki: <a href="http://dev.minetest.net/">http://dev.minetest.net/</a></li>
<li>(Unofficial) Minetest Modding Book by rubenwardy: <a href="https://rubenwardy.com/minetest_modding_book/">https://rubenwardy.com/minetest_modding_book/</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md730"></a>
Introduction</h1>
<p>Content and functionality can be added to Minetest using Lua scripting in run-time loaded mods.</p>
<p>A mod is a self-contained bunch of scripts, textures and other related things, which is loaded by and interfaces with Minetest.</p>
<p>Mods are contained and ran solely on the server side. Definitions and media files are automatically transferred to the client.</p>
<p>If you see a deficiency in the API, feel free to attempt to add the functionality in the engine and API, and to document it here.</p>
<h1><a class="anchor" id="autotoc_md731"></a>
Programming in Lua</h1>
<p>If you have any difficulty in understanding this, please read <a href="http://www.lua.org/pil/">Programming in Lua</a>.</p>
<h1><a class="anchor" id="autotoc_md732"></a>
Startup</h1>
<p>Mods are loaded during server startup from the mod load paths by running the <code>init.lua</code> scripts in a shared environment.</p>
<h1><a class="anchor" id="autotoc_md733"></a>
Paths</h1>
<p>Minetest keeps and looks for files mostly in two paths. <code>path_share</code> or <code>path_user</code>.</p>
<p><code>path_share</code> contains possibly read-only content for the engine (incl. games and mods). <code>path_user</code> contains mods or games installed by the user but also the users worlds or settings.</p>
<p>With a local build (<code>RUN_IN_PLACE=1</code>) <code>path_share</code> and <code>path_user</code> both point to the build directory. For system-wide builds on Linux the share path is usually at <code>/usr/share/minetest</code> while the user path resides in <code>.minetest</code> in the home directory. Paths on other operating systems will differ.</p>
<h1><a class="anchor" id="autotoc_md734"></a>
Games</h1>
<p>Games are looked up from:</p>
<ul>
<li><code>$path_share/games/&lt;gameid&gt;/</code></li>
<li><code>$path_user/games/&lt;gameid&gt;/</code></li>
</ul>
<p>Where <code>&lt;gameid&gt;</code> is unique to each game.</p>
<p>The game directory can contain the following files:</p>
<ul>
<li><code>game.conf</code>, with the following keys:<ul>
<li><code>title</code>: Required, a human-readable title to address the game, e.g. <code>title = Minetest <a class="el" href="classGame.html">Game</a></code>.</li>
<li><code>name</code>: (Deprecated) same as title.</li>
<li><code>description</code>: Short description to be shown in the content tab</li>
<li><code>allowed_mapgens = &lt;comma-separated mapgens&gt;</code> e.g. <code>allowed_mapgens = v5,v6,flat</code> Mapgens not in this list are removed from the list of mapgens for the game. If not specified, all mapgens are allowed.</li>
<li><code>disallowed_mapgens = &lt;comma-separated mapgens&gt;</code> e.g. <code>disallowed_mapgens = v5,v6,flat</code> These mapgens are removed from the list of mapgens for the game. When both <code>allowed_mapgens</code> and <code>disallowed_mapgens</code> are specified, <code>allowed_mapgens</code> is applied before <code>disallowed_mapgens</code>.</li>
<li><code>disallowed_mapgen_settings= &lt;comma-separated mapgen settings&gt;</code> e.g. <code>disallowed_mapgen_settings = mgv5_spflags</code> These mapgen settings are hidden for this game in the world creation dialog and game start menu. Add <code>seed</code> to hide the seed input field.</li>
<li><code>disabled_settings = &lt;comma-separated settings&gt;</code> e.g. <code>disabled_settings = enable_damage, creative_mode</code> These settings are hidden for this game in the "Start game" tab and will be initialized as <code>false</code> when the game is started. Prepend a setting name with an exclamation mark to initialize it to <code>true</code> (this does not work for <code>enable_server</code>). Only these settings are supported: <code>enable_damage</code>, <code>creative_mode</code>, <code>enable_server</code>.</li>
<li><code>map_persistent</code>: Specifies whether newly created worlds should use a persistent map backend. Defaults to <code>true</code> (= "sqlite3")</li>
<li><code>author</code>: The author of the game. It only appears when downloaded from ContentDB.</li>
<li><code>release</code>: Ignore this: Should only ever be set by ContentDB, as it is an internal ID used to track versions.</li>
</ul>
</li>
<li><code>minetest.conf</code>: Used to set default settings when running this game.</li>
<li><code>settingtypes.txt</code>: In the same format as the one in builtin. This settingtypes.txt will be parsed by the menu and the settings will be displayed in the "Games" category in the advanced settings tab.</li>
<li>If the game contains a folder called <code>textures</code> the server will load it as a texturepack, overriding mod textures. Any server texturepack will override mod textures and the game texturepack.</li>
</ul>
<h2><a class="anchor" id="autotoc_md735"></a>
Menu images</h2>
<p>Games can provide custom main menu images. They are put inside a <code>menu</code> directory inside the game directory.</p>
<p>The images are named <code>$identifier.png</code>, where <code>$identifier</code> is one of <code>overlay</code>, <code>background</code>, <code>footer</code>, <code>header</code>. If you want to specify multiple images for one identifier, add additional images named like <code>$identifier.$n.png</code>, with an ascending number $n starting with 1, and a random image will be chosen from the provided ones.</p>
<h2><a class="anchor" id="autotoc_md736"></a>
Menu music</h2>
<p>Games can provide custom main menu music. They are put inside a <code>menu</code> directory inside the game directory.</p>
<p>The music files are named <code>theme.ogg</code>. If you want to specify multiple music files for one game, add additional images named like <code>theme.$n.ogg</code>, with an ascending number $n starting with 1 (max 10), and a random music file will be chosen from the provided ones.</p>
<h1><a class="anchor" id="autotoc_md737"></a>
Mods</h1>
<h2><a class="anchor" id="autotoc_md738"></a>
Mod load path</h2>
<p>Paths are relative to the directories listed in the [Paths] section above.</p>
<ul>
<li><code>games/&lt;gameid&gt;/mods/</code></li>
<li><code>mods/</code></li>
<li><code>worlds/&lt;worldname&gt;/worldmods/</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md739"></a>
World-specific games</h2>
<p>It is possible to include a game in a world; in this case, no mods or games are loaded or checked from anywhere else.</p>
<p>This is useful for e.g. adventure worlds and happens if the <code>&lt;worldname&gt;/game/</code> directory exists.</p>
<p>Mods should then be placed in <code>&lt;worldname&gt;/game/mods/</code>.</p>
<h2><a class="anchor" id="autotoc_md740"></a>
Modpacks</h2>
<p>Mods can be put in a subdirectory, if the parent directory, which otherwise should be a mod, contains a file named <code>modpack.conf</code>. The file is a key-value store of modpack details.</p>
<ul>
<li><code>name</code>: The modpack name. Allows Minetest to determine the modpack name even if the folder is wrongly named.</li>
<li><code>description</code>: Description of mod to be shown in the Mods tab of the main menu.</li>
<li><code>author</code>: The author of the modpack. It only appears when downloaded from ContentDB.</li>
<li><code>release</code>: Ignore this: Should only ever be set by ContentDB, as it is an internal ID used to track versions.</li>
<li><code>title</code>: A human-readable title to address the modpack.</li>
</ul>
<p>Note: to support 0.4.x, please also create an empty modpack.txt file.</p>
<h2><a class="anchor" id="autotoc_md741"></a>
Mod directory structure</h2>
<pre class="fragment">mods
├── modname
│   ├── mod.conf
│   ├── screenshot.png
│   ├── settingtypes.txt
│   ├── init.lua
│   ├── models
│   ├── textures
│   │   ├── modname_stuff.png
│   │   ├── modname_stuff_normal.png
│   │   ├── modname_something_else.png
│   │   ├── subfolder_foo
│   │   │   ├── modname_more_stuff.png
│   │   │   └── another_subfolder
│   │   └── bar_subfolder
│   ├── sounds
│   ├── media
│   ├── locale
│   └── &lt;custom data&gt;
└── another
</pre><h3><a class="anchor" id="autotoc_md742"></a>
modname</h3>
<p>The location of this directory can be fetched by using <code>minetest.get_modpath(modname)</code>.</p>
<h3><a class="anchor" id="autotoc_md743"></a>
mod.conf</h3>
<p>A <code><a class="el" href="classSettings.html">Settings</a></code> file that provides meta information about the mod.</p>
<ul>
<li><code>name</code>: The mod name. Allows Minetest to determine the mod name even if the folder is wrongly named.</li>
<li><code>description</code>: Description of mod to be shown in the Mods tab of the main menu.</li>
<li><code>depends</code>: A comma separated list of dependencies. These are mods that must be loaded before this mod.</li>
<li><code>optional_depends</code>: A comma separated list of optional dependencies. Like a dependency, but no error if the mod doesn't exist.</li>
<li><code>author</code>: The author of the mod. It only appears when downloaded from ContentDB.</li>
<li><code>release</code>: Ignore this: Should only ever be set by ContentDB, as it is an internal ID used to track versions.</li>
<li><code>title</code>: A human-readable title to address the mod.</li>
</ul>
<h3><a class="anchor" id="autotoc_md744"></a>
&lt;tt&gt;screenshot.png&lt;/tt&gt;</h3>
<p>A screenshot shown in the mod manager within the main menu. It should have an aspect ratio of 3:2 and a minimum size of 300×200 pixels.</p>
<h3><a class="anchor" id="autotoc_md745"></a>
&lt;tt&gt;depends.txt&lt;/tt&gt;</h3>
<p><b>Deprecated:</b> you should use mod.conf instead.</p>
<p>This file is used if there are no dependencies in mod.conf.</p>
<p>List of mods that have to be loaded before loading this mod.</p>
<p>A single line contains a single modname.</p>
<p><a class="el" href="classOptional.html">Optional</a> dependencies can be defined by appending a question mark to a single modname. This means that if the specified mod is missing, it does not prevent this mod from being loaded.</p>
<h3><a class="anchor" id="autotoc_md746"></a>
&lt;tt&gt;description.txt&lt;/tt&gt;</h3>
<p><b>Deprecated:</b> you should use mod.conf instead.</p>
<p>This file is used if there is no description in mod.conf.</p>
<p>A file containing a description to be shown in the Mods tab of the main menu.</p>
<h3><a class="anchor" id="autotoc_md747"></a>
&lt;tt&gt;settingtypes.txt&lt;/tt&gt;</h3>
<p>The format is documented in <code>builtin/settingtypes.txt</code>. It is parsed by the main menu settings dialogue to list mod-specific settings in the "Mods" category.</p>
<h3><a class="anchor" id="autotoc_md748"></a>
&lt;tt&gt;init.lua&lt;/tt&gt;</h3>
<p>The main Lua script. Running this script should register everything it wants to register. Subsequent execution depends on minetest calling the registered callbacks.</p>
<p><code>minetest.settings</code> can be used to read custom or existing settings at load time, if necessary. (See [<code><a class="el" href="classSettings.html">Settings</a></code>])</p>
<h3><a class="anchor" id="autotoc_md749"></a>
&lt;tt&gt;textures&lt;/tt&gt;, &lt;tt&gt;sounds&lt;/tt&gt;, &lt;tt&gt;media&lt;/tt&gt;, &lt;tt&gt;models&lt;/tt&gt;, &lt;tt&gt;locale&lt;/tt&gt;</h3>
<p>Media files (textures, sounds, whatever) that will be transferred to the client and will be available for use by the mod and translation files for the clients (see [<a class="el" href="classTranslations.html">Translations</a>]).</p>
<p>It is suggested to use the folders for the purpose they are thought for, eg. put textures into <code>textures</code>, translation files into <code>locale</code>, models for entities or meshnodes into <code>models</code> et cetera.</p>
<p>These folders and subfolders can contain subfolders. Subfolders with names starting with <code>_</code> or <code>.</code> are ignored. If a subfolder contains a media file with the same name as a media file in one of its parents, the parent's file is used.</p>
<p>Although it is discouraged, a mod can overwrite a media file of any mod that it depends on by supplying a file with an equal name.</p>
<h2><a class="anchor" id="autotoc_md750"></a>
Naming conventions</h2>
<p>Registered names should generally be in this format: </p><pre class="fragment">modname:&lt;whatever&gt;
</pre><p><code>&lt;whatever&gt;</code> can have these characters: </p><pre class="fragment">a-zA-Z0-9_
</pre><p>This is to prevent conflicting names from corrupting maps and is enforced by the mod loader.</p>
<p>Registered names can be overridden by prefixing the name with <code>:</code>. This can be used for overriding the registrations of some other mod.</p>
<p>The <code>:</code> prefix can also be used for maintaining backwards compatibility.</p>
<h3><a class="anchor" id="autotoc_md751"></a>
Example</h3>
<p>In the mod <code>experimental</code>, there is the ideal item/node/entity name <code>tnt</code>. So the name should be <code>experimental:tnt</code>.</p>
<p>Any mod can redefine <code>experimental:tnt</code> by using the name </p><pre class="fragment">:experimental:tnt
</pre><p>when registering it. For this to work correctly, that mod must have <code>experimental</code> as a dependency.</p>
<h1><a class="anchor" id="autotoc_md752"></a>
Aliases</h1>
<p>Aliases of itemnames can be added by using <code>minetest.register_alias(alias, original_name)</code> or <code>minetest.register_alias_force(alias, original_name)</code>.</p>
<p>This adds an alias <code>alias</code> for the item called <code>original_name</code>. From now on, you can use <code>alias</code> to refer to the item <code>original_name</code>.</p>
<p>The only difference between <code>minetest.register_alias</code> and <code>minetest.register_alias_force</code> is that if an item named <code>alias</code> already exists, <code>minetest.register_alias</code> will do nothing while <code>minetest.register_alias_force</code> will unregister it.</p>
<p>This can be used for maintaining backwards compatibility.</p>
<p>This can also set quick access names for things, e.g. if you have an item called <code>epiclylongmodname:stuff</code>, you could do </p><pre class="fragment">minetest.register_alias("stuff", "epiclylongmodname:stuff")
</pre><p>and be able to use <code>/giveme stuff</code>.</p>
<h2><a class="anchor" id="autotoc_md753"></a>
Mapgen aliases</h2>
<p>In a game, a certain number of these must be set to tell core mapgens which of the game's nodes are to be used for core mapgen generation. For example: </p><pre class="fragment">minetest.register_alias("mapgen_stone", "default:stone")
</pre><h3><a class="anchor" id="autotoc_md754"></a>
Aliases for non-V6 mapgens</h3>
<h4><a class="anchor" id="autotoc_md755"></a>
Essential aliases</h4>
<ul>
<li><code>mapgen_stone</code></li>
<li><code>mapgen_water_source</code></li>
<li><code>mapgen_river_water_source</code></li>
</ul>
<p><code>mapgen_river_water_source</code> is required for mapgens with sloping rivers where it is necessary to have a river liquid node with a short <code>liquid_range</code> and <code>liquid_renewable = false</code> to avoid flooding.</p>
<h4><a class="anchor" id="autotoc_md756"></a>
Optional aliases</h4>
<ul>
<li><code>mapgen_lava_source</code></li>
</ul>
<p>Fallback lava node used if cave liquids are not defined in biome definitions. Deprecated, define cave liquids in biome definitions instead.</p>
<ul>
<li><code>mapgen_cobble</code></li>
</ul>
<p>Fallback node used if dungeon nodes are not defined in biome definitions. Deprecated, define dungeon nodes in biome definitions instead.</p>
<h3><a class="anchor" id="autotoc_md757"></a>
Aliases for Mapgen V6</h3>
<h4><a class="anchor" id="autotoc_md758"></a>
Essential</h4>
<ul>
<li><code>mapgen_stone</code></li>
<li><code>mapgen_water_source</code></li>
<li><code>mapgen_lava_source</code></li>
<li><code>mapgen_dirt</code></li>
<li><code>mapgen_dirt_with_grass</code></li>
<li><code>mapgen_sand</code></li>
<li><code>mapgen_tree</code></li>
<li><code>mapgen_leaves</code></li>
<li><code>mapgen_apple</code></li>
<li><code>mapgen_cobble</code></li>
</ul>
<h4><a class="anchor" id="autotoc_md759"></a>
Optional</h4>
<ul>
<li><code>mapgen_gravel</code> (falls back to stone)</li>
<li><code>mapgen_desert_stone</code> (falls back to stone)</li>
<li><code>mapgen_desert_sand</code> (falls back to sand)</li>
<li><code>mapgen_dirt_with_snow</code> (falls back to dirt_with_grass)</li>
<li><code>mapgen_snowblock</code> (falls back to dirt_with_grass)</li>
<li><code>mapgen_snow</code> (not placed if missing)</li>
<li><code>mapgen_ice</code> (falls back to water_source)</li>
<li><code>mapgen_jungletree</code> (falls back to tree)</li>
<li><code>mapgen_jungleleaves</code> (falls back to leaves)</li>
<li><code>mapgen_junglegrass</code> (not placed if missing)</li>
<li><code>mapgen_pine_tree</code> (falls back to tree)</li>
<li><code>mapgen_pine_needles</code> (falls back to leaves)</li>
<li><code>mapgen_stair_cobble</code> (falls back to cobble)</li>
<li><code>mapgen_mossycobble</code> (falls back to cobble)</li>
<li><code>mapgen_stair_desert_stone</code> (falls back to desert_stone)</li>
</ul>
<h3><a class="anchor" id="autotoc_md760"></a>
Setting the node used in Mapgen Singlenode</h3>
<p>By default the world is filled with air nodes. To set a different node use e.g.: </p><pre class="fragment">minetest.register_alias("mapgen_singlenode", "default:stone")
</pre><h1><a class="anchor" id="autotoc_md761"></a>
Textures</h1>
<p>Mods should generally prefix their textures with <code>modname_</code>, e.g. given the mod name <code>foomod</code>, a texture could be called: </p><pre class="fragment">foomod_foothing.png
</pre><p>Textures are referred to by their complete name, or alternatively by stripping out the file extension:</p>
<ul>
<li>e.g. <code>foomod_foothing.png</code></li>
<li>e.g. <code>foomod_foothing</code></li>
</ul>
<p>Supported texture formats are PNG (<code>.png</code>), JPEG (<code>.jpg</code>), <a class="el" href="classBitmap.html">Bitmap</a> (<code>.bmp</code>) and Targa (<code>.tga</code>). Since better alternatives exist, the latter two may be removed in the future.</p>
<h2><a class="anchor" id="autotoc_md762"></a>
Texture modifiers</h2>
<p>There are various texture modifiers that can be used to let the client generate textures on-the-fly. The modifiers are applied directly in sRGB colorspace, i.e. without gamma-correction.</p>
<h3><a class="anchor" id="autotoc_md763"></a>
Texture overlaying</h3>
<p>Textures can be overlaid by putting a <code>^</code> between them.</p>
<p>Example: </p><pre class="fragment">default_dirt.png^default_grass_side.png
</pre><p><code>default_grass_side.png</code> is overlaid over <code>default_dirt.png</code>. The texture with the lower resolution will be automatically upscaled to the higher resolution texture.</p>
<h3><a class="anchor" id="autotoc_md764"></a>
Texture grouping</h3>
<p>Textures can be grouped together by enclosing them in <code>(</code> and <code>)</code>.</p>
<p>Example: <code>cobble.png^(thing1.png^thing2.png)</code></p>
<p>A texture for <code>thing1.png^thing2.png</code> is created and the resulting texture is overlaid on top of <code>cobble.png</code>.</p>
<h3><a class="anchor" id="autotoc_md765"></a>
Escaping</h3>
<p>Modifiers that accept texture names (e.g. <code>[combine</code>) accept escaping to allow passing complex texture names as arguments. Escaping is done with backslash and is required for <code>^</code>, <code>:</code> and <code>\</code>.</p>
<p>Example: <code>cobble.png^[lowpart:50:color.png\^[mask\:trans.png</code> Or as a Lua string: <code>"cobble.png^[lowpart:50:color.png\\^[mask\\:trans.png"</code></p>
<p>The lower 50 percent of <code>color.png^[mask:trans.png</code> are overlaid on top of <code>cobble.png</code>.</p>
<h3><a class="anchor" id="autotoc_md766"></a>
Advanced texture modifiers</h3>
<h4><a class="anchor" id="autotoc_md767"></a>
Crack</h4>
<ul>
<li><code>[crack:&lt;n&gt;:&lt;p&gt;</code></li>
<li><code>[cracko:&lt;n&gt;:&lt;p&gt;</code></li>
<li><code>[crack:&lt;t&gt;:&lt;n&gt;:&lt;p&gt;</code></li>
<li><code>[cracko:&lt;t&gt;:&lt;n&gt;:&lt;p&gt;</code></li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>&lt;t&gt;</code>: tile count (in each direction)</li>
<li><code>&lt;n&gt;</code>: animation frame count</li>
<li><code>&lt;p&gt;</code>: current animation frame</li>
</ul>
<p>Draw a step of the crack animation on the texture. <code>crack</code> draws it normally, while <code>cracko</code> lays it over, keeping transparent pixels intact.</p>
<p>Example: </p><pre class="fragment">default_cobble.png^[crack:10:1
</pre><h4><a class="anchor" id="autotoc_md768"></a>
&lt;tt&gt;[combine:&lt;w&gt;x&lt;h&gt;:&lt;x1&gt;,&lt;y1&gt;=&lt;file1&gt;:&lt;x2&gt;,&lt;y2&gt;=&lt;file2&gt;:...&lt;/tt&gt;</h4>
<ul>
<li><code>&lt;w&gt;</code>: width</li>
<li><code>&lt;h&gt;</code>: height</li>
<li><code>&lt;x&gt;</code>: x position</li>
<li><code>&lt;y&gt;</code>: y position</li>
<li><code>&lt;file&gt;</code>: texture to combine</li>
</ul>
<p>Creates a texture of size <code>&lt;w&gt;</code> times <code>&lt;h&gt;</code> and blits the listed files to their specified coordinates.</p>
<p>Example: </p><pre class="fragment">[combine:16x32:0,0=default_cobble.png:0,16=default_wood.png
</pre><h4><a class="anchor" id="autotoc_md769"></a>
&lt;tt&gt;[resize:&lt;w&gt;x&lt;h&gt;&lt;/tt&gt;</h4>
<p>Resizes the texture to the given dimensions.</p>
<p>Example: </p><pre class="fragment">default_sandstone.png^[resize:16x16
</pre><h4><a class="anchor" id="autotoc_md770"></a>
&lt;tt&gt;[opacity:&lt;r&gt;&lt;/tt&gt;</h4>
<p>Makes the base image transparent according to the given ratio.</p>
<p><code>r</code> must be between 0 (transparent) and 255 (opaque).</p>
<p>Example: </p><pre class="fragment">default_sandstone.png^[opacity:127
</pre><h4><a class="anchor" id="autotoc_md771"></a>
&lt;tt&gt;[invert:&lt;mode&gt;&lt;/tt&gt;</h4>
<p>Inverts the given channels of the base image. Mode may contain the characters "r", "g", "b", "a". Only the channels that are mentioned in the mode string will be inverted.</p>
<p>Example: </p><pre class="fragment">default_apple.png^[invert:rgb
</pre><h4><a class="anchor" id="autotoc_md772"></a>
&lt;tt&gt;[brighten&lt;/tt&gt;</h4>
<p>Brightens the texture.</p>
<p>Example: </p><pre class="fragment">tnt_tnt_side.png^[brighten
</pre><h4><a class="anchor" id="autotoc_md773"></a>
&lt;tt&gt;[noalpha&lt;/tt&gt;</h4>
<p>Makes the texture completely opaque.</p>
<p>Example: </p><pre class="fragment">default_leaves.png^[noalpha
</pre><h4><a class="anchor" id="autotoc_md774"></a>
&lt;tt&gt;[makealpha:&lt;r&gt;,&lt;g&gt;,&lt;b&gt;&lt;/tt&gt;</h4>
<p>Convert one color to transparency.</p>
<p>Example: </p><pre class="fragment">default_cobble.png^[makealpha:128,128,128
</pre><h4><a class="anchor" id="autotoc_md775"></a>
&lt;tt&gt;[transform&lt;t&gt;&lt;/tt&gt;</h4>
<ul>
<li><code>&lt;t&gt;</code>: transformation(s) to apply</li>
</ul>
<p>Rotates and/or flips the image.</p>
<p><code>&lt;t&gt;</code> can be a number (between 0 and 7) or a transform name. Rotations are counter-clockwise. </p><pre class="fragment">0  I      identity
1  R90    rotate by 90 degrees
2  R180   rotate by 180 degrees
3  R270   rotate by 270 degrees
4  FX     flip X
5  FXR90  flip X then rotate by 90 degrees
6  FY     flip Y
7  FYR90  flip Y then rotate by 90 degrees
</pre><p>Example: </p><pre class="fragment">default_stone.png^[transformFXR90
</pre><h4><a class="anchor" id="autotoc_md776"></a>
&lt;tt&gt;[inventorycube{&lt;top&gt;{&lt;left&gt;{&lt;right&gt;&lt;/tt&gt;</h4>
<p>Escaping does not apply here and <code>^</code> is replaced by <code>&amp;</code> in texture names instead.</p>
<p>Create an inventory cube texture using the side textures.</p>
<p>Example: </p><pre class="fragment">[inventorycube{grass.png{dirt.png&amp;grass_side.png{dirt.png&amp;grass_side.png
</pre><p>Creates an inventorycube with <code>grass.png</code>, <code>dirt.png^grass_side.png</code> and <code>dirt.png^grass_side.png</code> textures</p>
<h4><a class="anchor" id="autotoc_md777"></a>
&lt;tt&gt;[fill:&lt;w&gt;x&lt;h&gt;:&lt;x&gt;,&lt;y&gt;:&lt;color&gt;&lt;/tt&gt;</h4>
<ul>
<li><code>&lt;w&gt;</code>: width</li>
<li><code>&lt;h&gt;</code>: height</li>
<li><code>&lt;x&gt;</code>: x position</li>
<li><code>&lt;y&gt;</code>: y position</li>
<li><code>&lt;color&gt;</code>: a <code>ColorString</code>.</li>
</ul>
<p>Creates a texture of the given size and color, optionally with an &lt;x&gt;,&lt;y&gt; position. An alpha value may be specified in the <code>Colorstring</code>.</p>
<p>The optional &lt;x&gt;,&lt;y&gt; position is only used if the [fill is being overlaid onto another texture with '^'.</p>
<p>When [fill is overlaid onto another texture it will not upscale or change the resolution of the texture, the base texture will determine the output resolution.</p>
<p>Examples: </p><pre class="fragment">[fill:16x16:#20F02080
texture.png^[fill:8x8:4,4:red
</pre><h4><a class="anchor" id="autotoc_md778"></a>
&lt;tt&gt;[lowpart:&lt;percent&gt;:&lt;file&gt;&lt;/tt&gt;</h4>
<p>Blit the lower <code>&lt;percent&gt;</code>% part of <code>&lt;file&gt;</code> on the texture.</p>
<p>Example: </p><pre class="fragment">base.png^[lowpart:25:overlay.png
</pre><h4><a class="anchor" id="autotoc_md779"></a>
&lt;tt&gt;[verticalframe:&lt;t&gt;:&lt;n&gt;&lt;/tt&gt;</h4>
<ul>
<li><code>&lt;t&gt;</code>: animation frame count</li>
<li><code>&lt;n&gt;</code>: current animation frame</li>
</ul>
<p>Crops the texture to a frame of a vertical animation.</p>
<p>Example: </p><pre class="fragment">default_torch_animated.png^[verticalframe:16:8
</pre><h4><a class="anchor" id="autotoc_md780"></a>
&lt;tt&gt;[mask:&lt;file&gt;&lt;/tt&gt;</h4>
<p>Apply a mask to the base image.</p>
<p>The mask is applied using binary AND.</p>
<h4><a class="anchor" id="autotoc_md781"></a>
&lt;tt&gt;[sheet:&lt;w&gt;x&lt;h&gt;:&lt;x&gt;,&lt;y&gt;&lt;/tt&gt;</h4>
<p>Retrieves a tile at position x,y from the base image which it assumes to be a tilesheet with dimensions w,h.</p>
<h4><a class="anchor" id="autotoc_md782"></a>
&lt;tt&gt;[colorize:&lt;color&gt;:&lt;ratio&gt;&lt;/tt&gt;</h4>
<p>Colorize the textures with the given color. <code>&lt;color&gt;</code> is specified as a <code>ColorString</code>. <code>&lt;ratio&gt;</code> is an int ranging from 0 to 255 or the word "`alpha`". If it is an int, then it specifies how far to interpolate between the colors where 0 is only the texture color and 255 is only <code>&lt;color&gt;</code>. If omitted, the alpha of <code>&lt;color&gt;</code> will be used as the ratio. If it is the word "`alpha`", then each texture pixel will contain the RGB of <code>&lt;color&gt;</code> and the alpha of <code>&lt;color&gt;</code> multiplied by the alpha of the texture pixel.</p>
<h4><a class="anchor" id="autotoc_md783"></a>
&lt;tt&gt;[colorizehsl:&lt;hue&gt;:&lt;saturation&gt;:&lt;lightness&gt;&lt;/tt&gt;</h4>
<p>Colorize the texture to the given hue. The texture will be converted into a greyscale image as seen through a colored glass, like "Colorize" in GIMP. Saturation and lightness can optionally be adjusted.</p>
<p><code>&lt;hue&gt;</code> should be from -180 to +180. The hue at 0° on an HSL color wheel is red, 60° is yellow, 120° is green, and 180° is cyan, while -60° is magenta and -120° is blue.</p>
<p><code>&lt;saturation&gt;</code> and <code>&lt;lightness&gt;</code> are optional adjustments.</p>
<p><code>&lt;lightness&gt;</code> is from -100 to +100, with a default of 0</p>
<p><code>&lt;saturation&gt;</code> is from 0 to 100, with a default of 50</p>
<h4><a class="anchor" id="autotoc_md784"></a>
&lt;tt&gt;[multiply:&lt;color&gt;&lt;/tt&gt;</h4>
<p>Multiplies texture colors with the given color. <code>&lt;color&gt;</code> is specified as a <code>ColorString</code>. Result is more like what you'd expect if you put a color on top of another color, meaning white surfaces get a lot of your new color while black parts don't change very much.</p>
<p>A Multiply blend can be applied between two textures by using the overlay modifier with a brightness adjustment: </p><pre class="fragment">textureA.png^[contrast:0:-64^[overlay:textureB.png
</pre><h4><a class="anchor" id="autotoc_md785"></a>
&lt;tt&gt;[screen:&lt;color&gt;&lt;/tt&gt;</h4>
<p>Apply a Screen blend with the given color. A Screen blend is the inverse of a Multiply blend, lightening images instead of darkening them.</p>
<p><code>&lt;color&gt;</code> is specified as a <code>ColorString</code>.</p>
<p>A Screen blend can be applied between two textures by using the overlay modifier with a brightness adjustment: </p><pre class="fragment">textureA.png^[contrast:0:64^[overlay:textureB.png
</pre><h4><a class="anchor" id="autotoc_md786"></a>
&lt;tt&gt;[hsl:&lt;hue&gt;:&lt;saturation&gt;:&lt;lightness&gt;&lt;/tt&gt;</h4>
<p>Adjust the hue, saturation, and lightness of the texture. Like "Hue-Saturation" in GIMP, but with 0 as the mid-point.</p>
<p><code>&lt;hue&gt;</code> should be from -180 to +180</p>
<p><code>&lt;saturation&gt;</code> and <code>&lt;lightness&gt;</code> are optional, and both percentages.</p>
<p><code>&lt;lightness&gt;</code> is from -100 to +100.</p>
<p><code>&lt;saturation&gt;</code> goes down to -100 (fully desaturated) but may go above 100, allowing for even muted colors to become highly saturated.</p>
<h4><a class="anchor" id="autotoc_md787"></a>
&lt;tt&gt;[contrast:&lt;contrast&gt;:&lt;brightness&gt;&lt;/tt&gt;</h4>
<p>Adjust the brightness and contrast of the texture. Conceptually like GIMP's "Brightness-Contrast" feature but allows brightness to be wound all the way up to white or down to black.</p>
<p><code>&lt;contrast&gt;</code> is a value from -127 to +127.</p>
<p><code>&lt;brightness&gt;</code> is an optional value, from -127 to +127.</p>
<p>If only a boost in contrast is required, an alternative technique is to hardlight blend the texture with itself, this increases contrast in the same way as an S-shaped color-curve, which avoids dark colors clipping to black and light colors clipping to white: </p><pre class="fragment">texture.png^[hardlight:texture.png
</pre><h4><a class="anchor" id="autotoc_md788"></a>
&lt;tt&gt;[overlay:&lt;file&gt;&lt;/tt&gt;</h4>
<p>Applies an Overlay blend with the two textures, like the Overlay layer mode in GIMP. Overlay is the same as Hard light but with the role of the two textures swapped, see the <code>[hardlight</code> modifier description for more detail about these blend modes.</p>
<h4><a class="anchor" id="autotoc_md789"></a>
&lt;tt&gt;[hardlight:&lt;file&gt;&lt;/tt&gt;</h4>
<p>Applies a Hard light blend with the two textures, like the Hard light layer mode in GIMP.</p>
<p>Hard light combines Multiply and Screen blend modes. Light parts of the <code>&lt;file&gt;</code> texture will lighten (screen) the base texture, and dark parts of the <code>&lt;file&gt;</code> texture will darken (multiply) the base texture. This can be useful for applying embossing or chiselled effects to textures. A Hard light with the same texture acts like applying an S-shaped color-curve, and can be used to increase contrast without clipping.</p>
<p>Hard light is the same as Overlay but with the roles of the two textures swapped, i.e. <code>A.png^[hardlight:B.png</code> is the same as <code>B.png^[overlay:A.png</code></p>
<h4><a class="anchor" id="autotoc_md790"></a>
&lt;tt&gt;[png:&lt;base64&gt;&lt;/tt&gt;</h4>
<p>Embed a base64 encoded PNG image in the texture string. You can produce a valid string for this by calling <code>minetest.encode_base64(minetest.encode_png(tex))</code>, where <code>tex</code> is pixel data. Refer to the documentation of these functions for details. You can use this to send disposable images such as captchas to individual clients, or render things that would be too expensive to compose with <code>[combine:</code>.</p>
<p>IMPORTANT: Avoid sending large images this way. This is not a replacement for asset files, do not use it to do anything that you could instead achieve by just using a file. In particular consider <code>minetest.dynamic_add_media</code> and test whether using other texture modifiers could result in a shorter string than embedding a whole image, this may vary by use case.</p>
<h2><a class="anchor" id="autotoc_md791"></a>
Hardware coloring</h2>
<p>The goal of hardware coloring is to simplify the creation of colorful nodes. If your textures use the same pattern, and they only differ in their color (like colored wool blocks), you can use hardware coloring instead of creating and managing many texture files. All of these methods use color multiplication (so a white-black texture with red coloring will result in red-black color).</p>
<h3><a class="anchor" id="autotoc_md792"></a>
Static coloring</h3>
<p>This method is useful if you wish to create nodes/items with the same texture, in different colors, each in a new node/item definition.</p>
<h4><a class="anchor" id="autotoc_md793"></a>
Global color</h4>
<p>When you register an item or node, set its <code>color</code> field (which accepts a <code>ColorSpec</code>) to the desired color.</p>
<p>An <code><a class="el" href="structItemStack.html">ItemStack</a></code>'s static color can be overwritten by the <code>color</code> metadata field. If you set that field to a <code>ColorString</code>, that color will be used.</p>
<h4><a class="anchor" id="autotoc_md794"></a>
Tile color</h4>
<p>Each tile may have an individual static color, which overwrites every other coloring method. To disable the coloring of a face, set its color to white (because multiplying with white does nothing). You can set the <code>color</code> property of the tiles in the node's definition if the tile is in table format.</p>
<h3><a class="anchor" id="autotoc_md795"></a>
Palettes</h3>
<p>For nodes and items which can have many colors, a palette is more suitable. A palette is a texture, which can contain up to 256 pixels. Each pixel is one possible color for the node/item. You can register one node/item, which can have up to 256 colors.</p>
<h4><a class="anchor" id="autotoc_md796"></a>
Palette indexing</h4>
<p>When using palettes, you always provide a pixel index for the given node or <code><a class="el" href="structItemStack.html">ItemStack</a></code>. The palette is read from left to right and from top to bottom. If the palette has less than 256 pixels, then it is stretched to contain exactly 256 pixels (after arranging the pixels to one line). The indexing starts from 0.</p>
<p>Examples:</p>
<ul>
<li>16x16 palette, index = 0: the top left corner</li>
<li>16x16 palette, index = 4: the fifth pixel in the first row</li>
<li>16x16 palette, index = 16: the pixel below the top left corner</li>
<li>16x16 palette, index = 255: the bottom right corner</li>
<li>2 (width) x 4 (height) palette, index = 31: the top left corner. The palette has 8 pixels, so each pixel is stretched to 32 pixels, to ensure the total 256 pixels.</li>
<li>2x4 palette, index = 32: the top right corner</li>
<li>2x4 palette, index = 63: the top right corner</li>
<li>2x4 palette, index = 64: the pixel below the top left corner</li>
</ul>
<h4><a class="anchor" id="autotoc_md797"></a>
Using palettes with items</h4>
<p>When registering an item, set the item definition's <code>palette</code> field to a texture. You can also use texture modifiers.</p>
<p>The <code><a class="el" href="structItemStack.html">ItemStack</a></code>'s color depends on the <code>palette_index</code> field of the stack's metadata. <code>palette_index</code> is an integer, which specifies the index of the pixel to use.</p>
<h4><a class="anchor" id="autotoc_md798"></a>
Linking palettes with nodes</h4>
<p>When registering a node, set the item definition's <code>palette</code> field to a texture. You can also use texture modifiers. The node's color depends on its <code>param2</code>, so you also must set an appropriate <code>paramtype2</code>:</p>
<ul>
<li><code>paramtype2 = "color"</code> for nodes which use their full <code>param2</code> for palette indexing. These nodes can have 256 different colors. The palette should contain 256 pixels.</li>
<li><code>paramtype2 = "colorwallmounted"</code> for nodes which use the first five bits (most significant) of <code>param2</code> for palette indexing. The remaining three bits are describing rotation, as in <code>wallmounted</code> paramtype2. Division by 8 yields the palette index (without stretching the palette). These nodes can have 32 different colors, and the palette should contain 32 pixels. Examples:<ul>
<li><code>param2 = 17</code> is 2 * 8 + 1, so the rotation is 1 and the third (= 2 + 1) pixel will be picked from the palette.</li>
<li><code>param2 = 35</code> is 4 * 8 + 3, so the rotation is 3 and the fifth (= 4 + 1) pixel will be picked from the palette.</li>
</ul>
</li>
<li><code>paramtype2 = "colorfacedir"</code> for nodes which use the first three bits of <code>param2</code> for palette indexing. The remaining five bits are describing rotation, as in <code>facedir</code> paramtype2. Division by 32 yields the palette index (without stretching the palette). These nodes can have 8 different colors, and the palette should contain 8 pixels. Examples:<ul>
<li><code>param2 = 17</code> is 0 * 32 + 17, so the rotation is 17 and the first (= 0 + 1) pixel will be picked from the palette.</li>
<li><code>param2 = 35</code> is 1 * 32 + 3, so the rotation is 3 and the second (= 1 + 1) pixel will be picked from the palette.</li>
</ul>
</li>
<li><code>paramtype2 = "color4dir"</code> for nodes which use the first six bits of <code>param2</code> for palette indexing. The remaining two bits are describing rotation, as in <code>4dir</code> paramtype2. Division by 4 yields the palette index (without stretching the palette). These nodes can have 64 different colors, and the palette should contain 64 pixels. Examples:<ul>
<li><code>param2 = 17</code> is 4 * 4 + 1, so the rotation is 1 and the fifth (= 4 + 1) pixel will be picked from the palette.</li>
<li><code>param2 = 35</code> is 8 * 4 + 3, so the rotation is 3 and the ninth (= 8 + 1) pixel will be picked from the palette.</li>
</ul>
</li>
</ul>
<p>To colorize a node on the map, set its <code>param2</code> value (according to the node's paramtype2).</p>
<h3><a class="anchor" id="autotoc_md799"></a>
Conversion between nodes in the inventory and on the map</h3>
<p>Static coloring is the same for both cases, there is no need for conversion.</p>
<p>If the <code><a class="el" href="structItemStack.html">ItemStack</a></code>'s metadata contains the <code>color</code> field, it will be lost on placement, because nodes on the map can only use palettes.</p>
<p>If the <code><a class="el" href="structItemStack.html">ItemStack</a></code>'s metadata contains the <code>palette_index</code> field, it is automatically transferred between node and item forms by the engine, when a player digs or places a colored node. You can disable this feature by setting the <code>drop</code> field of the node to itself (without metadata). To transfer the color to a special drop, you need a drop table.</p>
<p>Example:</p>
<div class="fragment"><div class="line">minetest.register_node(&quot;mod:stone&quot;, {</div>
<div class="line">    description = &quot;Stone&quot;,</div>
<div class="line">    tiles = {&quot;default_stone.png&quot;},</div>
<div class="line">    paramtype2 = &quot;color&quot;,</div>
<div class="line">    palette = &quot;palette.png&quot;,</div>
<div class="line">    drop = {</div>
<div class="line">        items = {</div>
<div class="line">            -- assume that mod:cobblestone also has the same palette</div>
<div class="line">            {items = {&quot;mod:cobblestone&quot;}, inherit_color = true },</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">})</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md800"></a>
Colored items in craft recipes</h3>
<p>Craft recipes only support item strings, but fortunately item strings can also contain metadata. Example craft recipe registration:</p>
<div class="fragment"><div class="line">minetest.register_craft({</div>
<div class="line">    output = minetest.itemstring_with_palette(&quot;wool:block&quot;, 3),</div>
<div class="line">    type = &quot;shapeless&quot;,</div>
<div class="line">    recipe = {</div>
<div class="line">        &quot;wool:block&quot;,</div>
<div class="line">        &quot;dye:red&quot;,</div>
<div class="line">    },</div>
<div class="line">})</div>
</div><!-- fragment --><p>To set the <code>color</code> field, you can use <code>minetest.itemstring_with_color</code>.</p>
<p>Metadata field filtering in the <code>recipe</code> field are not supported yet, so the craft output is independent of the color of the ingredients.</p>
<h2><a class="anchor" id="autotoc_md801"></a>
Soft texture overlay</h2>
<p>Sometimes hardware coloring is not enough, because it affects the whole tile. Soft texture overlays were added to Minetest to allow the dynamic coloring of only specific parts of the node's texture. For example a grass block may have colored grass, while keeping the dirt brown.</p>
<p>These overlays are 'soft', because unlike texture modifiers, the layers are not merged in the memory, but they are simply drawn on top of each other. This allows different hardware coloring, but also means that tiles with overlays are drawn slower. Using too much overlays might cause FPS loss.</p>
<p>For inventory and wield images you can specify overlays which hardware coloring does not modify. You have to set <code>inventory_overlay</code> and <code>wield_overlay</code> fields to an image name.</p>
<p>To define a node overlay, simply set the <code>overlay_tiles</code> field of the node definition. These tiles are defined in the same way as plain tiles: they can have a texture name, color etc. To skip one face, set that overlay tile to an empty string.</p>
<p>Example (colored grass block):</p>
<div class="fragment"><div class="line">minetest.register_node(&quot;default:dirt_with_grass&quot;, {</div>
<div class="line">    description = &quot;Dirt with Grass&quot;,</div>
<div class="line">    -- Regular tiles, as usual</div>
<div class="line">    -- The dirt tile disables palette coloring</div>
<div class="line">    tiles = {{name = &quot;default_grass.png&quot;},</div>
<div class="line">        {name = &quot;default_dirt.png&quot;, color = &quot;white&quot;}},</div>
<div class="line">    -- Overlay tiles: define them in the same style</div>
<div class="line">    -- The top and bottom tile does not have overlay</div>
<div class="line">    overlay_tiles = {&quot;&quot;, &quot;&quot;,</div>
<div class="line">        {name = &quot;default_grass_side.png&quot;}},</div>
<div class="line">    -- Global color, used in inventory</div>
<div class="line">    color = &quot;green&quot;,</div>
<div class="line">    -- Palette in the world</div>
<div class="line">    paramtype2 = &quot;color&quot;,</div>
<div class="line">    palette = &quot;default_foilage.png&quot;,</div>
<div class="line">})</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md802"></a>
Sounds</h1>
<p>Only Ogg Vorbis files are supported.</p>
<p>For positional playing of sounds, only single-channel (mono) files are supported. Otherwise OpenAL will play them non-positionally.</p>
<p>Mods should generally prefix their sounds with <code>modname_</code>, e.g. given the mod name "`foomod`", a sound could be called: </p><pre class="fragment">foomod_foosound.ogg
</pre><p>Sounds are referred to by their name with a dot, a single digit and the file extension stripped out. When a sound is played, the actual sound file is chosen randomly from the matching sounds.</p>
<p>When playing the sound <code>foomod_foosound</code>, the sound is chosen randomly from the available ones of the following files:</p>
<ul>
<li><code>foomod_foosound.ogg</code></li>
<li><code>foomod_foosound.0.ogg</code></li>
<li><code>foomod_foosound.1.ogg</code></li>
<li>(...)</li>
<li><code>foomod_foosound.9.ogg</code></li>
</ul>
<p>Examples of sound parameter tables:</p>
<div class="fragment"><div class="line">-- Play locationless on all clients</div>
<div class="line">{</div>
<div class="line">    gain = 1.0,   -- default</div>
<div class="line">    fade = 0.0,   -- default, change to a value &gt; 0 to fade the sound in</div>
<div class="line">    pitch = 1.0,  -- default</div>
<div class="line">}</div>
<div class="line">-- Play locationless to one player</div>
<div class="line">{</div>
<div class="line">    to_player = name,</div>
<div class="line">    gain = 1.0,   -- default</div>
<div class="line">    fade = 0.0,   -- default, change to a value &gt; 0 to fade the sound in</div>
<div class="line">    pitch = 1.0,  -- default</div>
<div class="line">}</div>
<div class="line">-- Play locationless to one player, looped</div>
<div class="line">{</div>
<div class="line">    to_player = name,</div>
<div class="line">    gain = 1.0,  -- default</div>
<div class="line">    loop = true,</div>
<div class="line">}</div>
<div class="line">-- Play at a location</div>
<div class="line">{</div>
<div class="line">    pos = {x = 1, y = 2, z = 3},</div>
<div class="line">    gain = 1.0,  -- default</div>
<div class="line">    max_hear_distance = 32,  -- default, uses a Euclidean metric</div>
<div class="line">}</div>
<div class="line">-- Play connected to an object, looped</div>
<div class="line">{</div>
<div class="line">    object = &lt;an ObjectRef&gt;,</div>
<div class="line">    gain = 1.0,  -- default</div>
<div class="line">    max_hear_distance = 32,  -- default, uses a Euclidean metric</div>
<div class="line">    loop = true,</div>
<div class="line">}</div>
<div class="line">-- Play at a location, heard by anyone *but* the given player</div>
<div class="line">{</div>
<div class="line">    pos = {x = 32, y = 0, z = 100},</div>
<div class="line">    max_hear_distance = 40,</div>
<div class="line">    exclude_player = name,</div>
<div class="line">}</div>
</div><!-- fragment --><p>Looped sounds must either be connected to an object or played locationless to one player using <code>to_player = name</code>.</p>
<p>A positional sound will only be heard by players that are within <code>max_hear_distance</code> of the sound position, at the start of the sound.</p>
<p><code>exclude_player = name</code> can be applied to locationless, positional and object- bound sounds to exclude a single player from hearing them.</p>
<h2><a class="anchor" id="autotoc_md803"></a>
&lt;tt&gt;SimpleSoundSpec&lt;/tt&gt;</h2>
<p>Specifies a sound name, gain (=volume) and pitch. This is either a string or a table.</p>
<p>In string form, you just specify the sound name or the empty string for no sound.</p>
<p><a class="el" href="structTable.html">Table</a> form has the following fields:</p>
<ul>
<li><code>name</code>: Sound name</li>
<li><code>gain</code>: Volume (<code>1.0</code> = 100%)</li>
<li><code>pitch</code>: Pitch (<code>1.0</code> = 100%)</li>
</ul>
<p><code>gain</code> and <code>pitch</code> are optional and default to <code>1.0</code>.</p>
<p>Examples:</p>
<ul>
<li><code>""</code>: No sound</li>
<li><code>{}</code>: No sound</li>
<li><code>"default_place_node"</code>: Play e.g. <code>default_place_node.ogg</code></li>
<li><code>{name = "default_place_node"}</code>: Same as above</li>
<li><code>{name = "default_place_node", gain = 0.5}</code>: 50% volume</li>
<li><code>{name = "default_place_node", gain = 0.9, pitch = 1.1}</code>: 90% volume, 110% pitch</li>
</ul>
<h2><a class="anchor" id="autotoc_md804"></a>
Special sound files</h2>
<p>These sound files are played back by the engine if provided.</p>
<ul>
<li><code>player_damage</code>: Played when the local player takes damage (gain = 0.5)</li>
<li><code>player_falling_damage</code>: Played when the local player takes damage by falling (gain = 0.5)</li>
<li><code>player_jump</code>: Played when the local player jumps</li>
<li><code>default_dig_&lt;groupname&gt;</code>: Default node digging sound (gain = 0.5) (see node sound definition for details)</li>
</ul>
<h1><a class="anchor" id="autotoc_md805"></a>
Registered definitions</h1>
<p>Anything added using certain [Registration functions] gets added to one or more of the global [Registered definition tables].</p>
<p>Note that in some cases you will stumble upon things that are not contained in these tables (e.g. when a mod has been removed). Always check for existence before trying to access the fields.</p>
<p>Example:</p>
<p>All nodes registered with <code>minetest.register_node</code> get added to the table <code>minetest.registered_nodes</code>.</p>
<p>If you want to check the drawtype of a node, you could do it like this:</p>
<div class="fragment"><div class="line">local def = minetest.registered_nodes[nodename]</div>
<div class="line">local drawtype = def and def.drawtype</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md806"></a>
Nodes</h1>
<p>Nodes are the bulk data of the world: cubes and other things that take the space of a cube. Huge amounts of them are handled efficiently, but they are quite static.</p>
<p>The definition of a node is stored and can be accessed by using</p>
<div class="fragment"><div class="line">minetest.registered_nodes[node.name]</div>
</div><!-- fragment --><p>See [Registered definitions].</p>
<p>Nodes are passed by value between Lua and the engine. They are represented by a table:</p>
<div class="fragment"><div class="line">{name=&quot;name&quot;, param1=num, param2=num}</div>
</div><!-- fragment --><p><code>param1</code> and <code>param2</code> are 8-bit integers ranging from 0 to 255. The engine uses them for certain automated functions. If you don't use these functions, you can use them to store arbitrary values.</p>
<h2><a class="anchor" id="autotoc_md807"></a>
Node paramtypes</h2>
<p>The functions of <code>param1</code> and <code>param2</code> are determined by certain fields in the node definition.</p>
<p>The function of <code>param1</code> is determined by <code>paramtype</code> in node definition. <code>param1</code> is reserved for the engine when <code>paramtype != "none"</code>.</p>
<ul>
<li><code>paramtype = "light"</code><ul>
<li>The value stores light with and without sun in its lower and upper 4 bits respectively.</li>
<li>Required by a light source node to enable spreading its light.</li>
<li>Required by the following drawtypes as they determine their visual brightness from their internal light value:<ul>
<li>torchlike</li>
<li>signlike</li>
<li>firelike</li>
<li>fencelike</li>
<li>raillike</li>
<li>nodebox</li>
<li>mesh</li>
<li>plantlike</li>
<li>plantlike_rooted</li>
</ul>
</li>
</ul>
</li>
<li><code>paramtype = "none"</code><ul>
<li><code>param1</code> will not be used by the engine and can be used to store an arbitrary value</li>
</ul>
</li>
</ul>
<p>The function of <code>param2</code> is determined by <code>paramtype2</code> in node definition. <code>param2</code> is reserved for the engine when <code>paramtype2 != "none"</code>.</p>
<ul>
<li><code>paramtype2 = "flowingliquid"</code><ul>
<li>Used by <code>drawtype = "flowingliquid"</code> and <code>liquidtype = "flowing"</code></li>
<li>The liquid level and a flag of the liquid are stored in <code>param2</code></li>
<li>Bits 0-2: Liquid level (0-7). The higher, the more liquid is in this node; see <code>minetest.get_node_level</code>, <code>minetest.set_node_level</code> and <code>minetest.add_node_level</code> to access/manipulate the content of this field</li>
<li>Bit 3: If set, liquid is flowing downwards (no graphical effect)</li>
</ul>
</li>
<li><code>paramtype2 = "wallmounted"</code><ul>
<li>Supported drawtypes: "torchlike", "signlike", "plantlike", "plantlike_rooted", "normal", "nodebox", "mesh"</li>
<li>The rotation of the node is stored in <code>param2</code></li>
<li><a class="el" href="structNode.html">Node</a> is 'mounted'/facing towards one of 6 directions</li>
<li>You can make this value by using <code>minetest.dir_to_wallmounted()</code></li>
<li>Values range 0 - 5</li>
<li>The value denotes at which direction the node is "mounted": 0 = y+, 1 = y-, 2 = x+, 3 = x-, 4 = z+, 5 = z-</li>
<li>By default, on placement the param2 is automatically set to the appropriate rotation, depending on which side was pointed at</li>
</ul>
</li>
<li><code>paramtype2 = "facedir"</code><ul>
<li>Supported drawtypes: "normal", "nodebox", "mesh"</li>
<li>The rotation of the node is stored in <code>param2</code>.</li>
<li><a class="el" href="structNode.html">Node</a> is rotated around face and axis; 24 rotations in total.</li>
<li>Can be made by using <code>minetest.dir_to_facedir()</code>.</li>
<li>Chests and furnaces can be rotated that way, and also 'flipped'</li>
<li>Values range 0 - 23</li>
<li>facedir / 4 = axis direction: 0 = y+, 1 = z+, 2 = z-, 3 = x+, 4 = x-, 5 = y-</li>
<li>The node is rotated 90 degrees around the X or Z axis so that its top face points in the desired direction. For the y- direction, it's rotated 180 degrees around the Z axis.</li>
<li>facedir modulo 4 = left-handed rotation around the specified axis, in 90° steps.</li>
<li>By default, on placement the param2 is automatically set to the horizontal direction the player was looking at (values 0-3)</li>
<li>Special case: If the node is a connected nodebox, the nodebox will NOT rotate, only the textures will.</li>
</ul>
</li>
<li><code>paramtype2 = "4dir"</code><ul>
<li>Supported drawtypes: "normal", "nodebox", "mesh"</li>
<li>The rotation of the node is stored in <code>param2</code>.</li>
<li>Allows node to be rotated horizontally, 4 rotations in total</li>
<li>Can be made by using <code>minetest.dir_to_fourdir()</code>.</li>
<li>Chests and furnaces can be rotated that way, but not flipped</li>
<li>Values range 0 - 3</li>
<li>4dir modulo 4 = rotation</li>
<li>Otherwise, behavior is identical to facedir</li>
</ul>
</li>
<li><code>paramtype2 = "leveled"</code><ul>
<li>Only valid for "nodebox" with 'type = "leveled"', and "plantlike_rooted".<ul>
<li>Leveled nodebox:<ul>
<li>The level of the top face of the nodebox is stored in <code>param2</code>.</li>
<li>The other faces are defined by 'fixed = {}' like 'type = "fixed"' nodeboxes.</li>
<li>The nodebox height is (<code>param2</code> / 64) nodes.</li>
<li>The maximum accepted value of <code>param2</code> is 127.</li>
</ul>
</li>
<li>Rooted plantlike:<ul>
<li>The height of the 'plantlike' section is stored in <code>param2</code>.</li>
<li>The height is (<code>param2</code> / 16) nodes.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>paramtype2 = "degrotate"</code><ul>
<li>Valid for <code>plantlike</code> and <code>mesh</code> drawtypes. The rotation of the node is stored in <code>param2</code>.</li>
<li>Values range 0–239. The value stored in <code>param2</code> is multiplied by 1.5 to get the actual rotation in degrees of the node.</li>
</ul>
</li>
<li><code>paramtype2 = "meshoptions"</code><ul>
<li>Only valid for "plantlike" drawtype. <code>param2</code> encodes the shape and optional modifiers of the "plant". <code>param2</code> is a bitfield.</li>
<li>Bits 0 to 2 select the shape. Use only one of the values below:<ul>
<li>0 = an "x" shaped plant (ordinary plant)</li>
<li>1 = a "+" shaped plant (just rotated 45 degrees)</li>
<li>2 = a "*" shaped plant with 3 faces instead of 2</li>
<li>3 = a "#" shaped plant with 4 faces instead of 2</li>
<li>4 = a "#" shaped plant with 4 faces that lean outwards</li>
<li>5-7 are unused and reserved for future meshes.</li>
</ul>
</li>
<li>Bits 3 to 7 are used to enable any number of optional modifiers. Just add the corresponding value(s) below to <code>param2</code>:<ul>
<li>8 - Makes the plant slightly vary placement horizontally</li>
<li>16 - Makes the plant mesh 1.4x larger</li>
<li>32 - Moves each face randomly a small bit down (1/8 max)</li>
<li>values 64 and 128 (bits 6-7) are reserved for future use.</li>
</ul>
</li>
<li>Example: <code>param2 = 0</code> selects a normal "x" shaped plant</li>
<li>Example: <code>param2 = 17</code> selects a "+" shaped plant, 1.4x larger (1+16)</li>
</ul>
</li>
<li><code>paramtype2 = "color"</code><ul>
<li><code>param2</code> tells which color is picked from the palette. The palette should have 256 pixels.</li>
</ul>
</li>
<li><code>paramtype2 = "colorfacedir"</code><ul>
<li>Same as <code>facedir</code>, but with colors.</li>
<li>The first three bits of <code>param2</code> tells which color is picked from the palette. The palette should have 8 pixels.</li>
</ul>
</li>
<li><code>paramtype2 = "color4dir"</code><ul>
<li>Same as <code>facedir</code>, but with colors.</li>
<li>The first six bits of <code>param2</code> tells which color is picked from the palette. The palette should have 64 pixels.</li>
</ul>
</li>
<li><code>paramtype2 = "colorwallmounted"</code><ul>
<li>Same as <code>wallmounted</code>, but with colors.</li>
<li>The first five bits of <code>param2</code> tells which color is picked from the palette. The palette should have 32 pixels.</li>
</ul>
</li>
<li><code>paramtype2 = "glasslikeliquidlevel"</code><ul>
<li>Only valid for "glasslike_framed" or "glasslike_framed_optional" drawtypes. "glasslike_framed_optional" nodes are only affected if the "Connected Glass" setting is enabled.</li>
<li>Bits 0-5 define 64 levels of internal liquid, 0 being empty and 63 being full.</li>
<li>Bits 6 and 7 modify the appearance of the frame and node faces. One or both of these values may be added to <code>param2</code>:<ul>
<li>64 - Makes the node not connect with neighbors above or below it.</li>
<li>128 - Makes the node not connect with neighbors to its sides.</li>
</ul>
</li>
<li>Liquid texture is defined using <code>special_tiles = {"modname_tilename.png"}</code></li>
</ul>
</li>
<li><code>paramtype2 = "colordegrotate"</code><ul>
<li>Same as <code>degrotate</code>, but with colors.</li>
<li>The first (most-significant) three bits of <code>param2</code> tells which color is picked from the palette. The palette should have 8 pixels.</li>
<li>Remaining 5 bits store rotation in range 0–23 (i.e. in 15° steps)</li>
</ul>
</li>
<li><code>paramtype2 = "none"</code><ul>
<li><code>param2</code> will not be used by the engine and can be used to store an arbitrary value</li>
</ul>
</li>
</ul>
<p>Nodes can also contain extra data. See [<a class="el" href="structNode.html">Node</a> Metadata].</p>
<h2><a class="anchor" id="autotoc_md808"></a>
Node drawtypes</h2>
<p>There are a bunch of different looking node types.</p>
<p>Look for examples in <code>games/devtest</code> or <code>games/minetest_game</code>.</p>
<ul>
<li><code>normal</code><ul>
<li>A node-sized cube.</li>
</ul>
</li>
<li><code>airlike</code><ul>
<li>Invisible, uses no texture.</li>
</ul>
</li>
<li><code>liquid</code><ul>
<li>The cubic source node for a liquid.</li>
<li>Faces bordering to the same node are never rendered.</li>
<li>Connects to node specified in <code>liquid_alternative_flowing</code>.</li>
<li>You <em>must</em> set <code>liquid_alternative_source</code> to the node's own name.</li>
<li>Use <code>backface_culling = false</code> for the tiles you want to make visible when inside the node.</li>
</ul>
</li>
<li><code>flowingliquid</code><ul>
<li>The flowing version of a liquid, appears with various heights and slopes.</li>
<li>Faces bordering to the same node are never rendered.</li>
<li>Connects to node specified in <code>liquid_alternative_source</code>.</li>
<li>You <em>must</em> set <code>liquid_alternative_flowing</code> to the node's own name.</li>
<li><a class="el" href="structNode.html">Node</a> textures are defined with <code>special_tiles</code> where the first tile is for the top and bottom faces and the second tile is for the side faces.</li>
<li><code>tiles</code> is used for the item/inventory/wield image rendering.</li>
<li>Use <code>backface_culling = false</code> for the special tiles you want to make visible when inside the node</li>
</ul>
</li>
<li><code>glasslike</code><ul>
<li>Often used for partially-transparent nodes.</li>
<li>Only external sides of textures are visible.</li>
</ul>
</li>
<li><code>glasslike_framed</code><ul>
<li>All face-connected nodes are drawn as one volume within a surrounding frame.</li>
<li>The frame appearance is generated from the edges of the first texture specified in <code>tiles</code>. The width of the edges used are 1/16th of texture size: 1 pixel for 16x16, 2 pixels for 32x32 etc.</li>
<li>The glass 'shine' (or other desired detail) on each node face is supplied by the second texture specified in <code>tiles</code>.</li>
</ul>
</li>
<li><code>glasslike_framed_optional</code><ul>
<li>This switches between the above 2 drawtypes according to the menu setting 'Connected Glass'.</li>
</ul>
</li>
<li><code>allfaces</code><ul>
<li>Often used for partially-transparent nodes.</li>
<li>External and internal sides of textures are visible.</li>
</ul>
</li>
<li><code>allfaces_optional</code><ul>
<li>Often used for leaves nodes.</li>
<li>This switches between <code>normal</code>, <code>glasslike</code> and <code>allfaces</code> according to the menu setting: Opaque Leaves / Simple Leaves / Fancy Leaves.</li>
<li>With 'Simple Leaves' selected, the texture specified in <code>special_tiles</code> is used instead, if present. This allows a visually thicker texture to be used to compensate for how <code>glasslike</code> reduces visual thickness.</li>
</ul>
</li>
<li><code>torchlike</code><ul>
<li>A single vertical texture.</li>
<li>If <code>paramtype2="[color]wallmounted"</code>:<ul>
<li>If placed on top of a node, uses the first texture specified in <code>tiles</code>.</li>
<li>If placed against the underside of a node, uses the second texture specified in <code>tiles</code>.</li>
<li>If placed on the side of a node, uses the third texture specified in <code>tiles</code> and is perpendicular to that node.</li>
</ul>
</li>
<li>If <code>paramtype2="none"</code>:<ul>
<li>Will be rendered as if placed on top of a node (see above) and only the first texture is used.</li>
</ul>
</li>
</ul>
</li>
<li><code>signlike</code><ul>
<li>A single texture parallel to, and mounted against, the top, underside or side of a node.</li>
<li>If <code>paramtype2="[color]wallmounted"</code>, it rotates according to <code>param2</code></li>
<li>If <code>paramtype2="none"</code>, it will always be on the floor.</li>
</ul>
</li>
<li><code>plantlike</code><ul>
<li>Two vertical and diagonal textures at right-angles to each other.</li>
<li>See <code>paramtype2 = "meshoptions"</code> above for other options.</li>
</ul>
</li>
<li><code>firelike</code><ul>
<li>When above a flat surface, appears as 6 textures, the central 2 as <code>plantlike</code> plus 4 more surrounding those.</li>
<li>If not above a surface the central 2 do not appear, but the texture appears against the faces of surrounding nodes if they are present.</li>
</ul>
</li>
<li><code>fencelike</code><ul>
<li>A 3D model suitable for a wooden fence.</li>
<li>One placed node appears as a single vertical post.</li>
<li>Adjacently-placed nodes cause horizontal bars to appear between them.</li>
</ul>
</li>
<li><code>raillike</code><ul>
<li>Often used for tracks for mining carts.</li>
<li>Requires 4 textures to be specified in <code>tiles</code>, in order: Straight, curved, t-junction, crossing.</li>
<li>Each placed node automatically switches to a suitable rotated texture determined by the adjacent <code>raillike</code> nodes, in order to create a continuous track network.</li>
<li>Becomes a sloping node if placed against stepped nodes.</li>
</ul>
</li>
<li><code>nodebox</code><ul>
<li>Often used for stairs and slabs.</li>
<li>Allows defining nodes consisting of an arbitrary number of boxes.</li>
<li>See [<a class="el" href="structNode.html">Node</a> boxes] below for more information.</li>
</ul>
</li>
<li><code>mesh</code><ul>
<li>Uses models for nodes.</li>
<li>Tiles should hold model materials textures.</li>
<li>Only static meshes are implemented.</li>
<li>For supported model formats see Irrlicht engine documentation.</li>
</ul>
</li>
<li><code>plantlike_rooted</code><ul>
<li>Enables underwater <code>plantlike</code> without air bubbles around the nodes.</li>
<li>Consists of a base cube at the co-ordinates of the node plus a <code>plantlike</code> extension above</li>
<li>If <code>paramtype2="leveled", the</code>plantlike<code>extension has a height of</code>param2 / 16<code>nodes, otherwise it's the height of 1 node</code></li>
<li><code>If</code>paramtype2="wallmounted"<code>, the</code>plantlike` extension will be at one of the corresponding 6 sides of the base cube. Also, the base cube rotates like a <code>normal</code> cube would</li>
<li>The <code>plantlike</code> extension visually passes through any nodes above the base cube without affecting them.</li>
<li>The base cube texture tiles are defined as normal, the <code>plantlike</code> extension uses the defined special tile, for example: <code>special_tiles = {{name = "default_papyrus.png"}},</code></li>
</ul>
</li>
</ul>
<p><code>*_optional</code> drawtypes need less rendering time if deactivated (always client-side).</p>
<h2><a class="anchor" id="autotoc_md809"></a>
Node boxes</h2>
<p><a class="el" href="structNode.html">Node</a> selection boxes are defined using "node boxes".</p>
<p>A nodebox is defined as any of:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    -- A normal cube; the default in most things</div>
<div class="line">    type = &quot;regular&quot;</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">    -- A fixed box (or boxes) (facedir param2 is used, if applicable)</div>
<div class="line">    type = &quot;fixed&quot;,</div>
<div class="line">    fixed = box OR {box1, box2, ...}</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">    -- A variable height box (or boxes) with the top face position defined</div>
<div class="line">    -- by the node parameter &#39;leveled = &#39;, or if &#39;paramtype2 == &quot;leveled&quot;&#39;</div>
<div class="line">    -- by param2.</div>
<div class="line">    -- Other faces are defined by &#39;fixed = {}&#39; as with &#39;type = &quot;fixed&quot;&#39;.</div>
<div class="line">    type = &quot;leveled&quot;,</div>
<div class="line">    fixed = box OR {box1, box2, ...}</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">    -- A box like the selection box for torches</div>
<div class="line">    -- (wallmounted param2 is used, if applicable)</div>
<div class="line">    type = &quot;wallmounted&quot;,</div>
<div class="line">    wall_top = box,</div>
<div class="line">    wall_bottom = box,</div>
<div class="line">    wall_side = box</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">    -- A node that has optional boxes depending on neighboring nodes&#39;</div>
<div class="line">    -- presence and type. See also `connects_to`.</div>
<div class="line">    type = &quot;connected&quot;,</div>
<div class="line">    fixed = box OR {box1, box2, ...}</div>
<div class="line">    connect_top = box OR {box1, box2, ...}</div>
<div class="line">    connect_bottom = box OR {box1, box2, ...}</div>
<div class="line">    connect_front = box OR {box1, box2, ...}</div>
<div class="line">    connect_left = box OR {box1, box2, ...}</div>
<div class="line">    connect_back = box OR {box1, box2, ...}</div>
<div class="line">    connect_right = box OR {box1, box2, ...}</div>
<div class="line">    -- The following `disconnected_*` boxes are the opposites of the</div>
<div class="line">    -- `connect_*` ones above, i.e. when a node has no suitable neighbor</div>
<div class="line">    -- on the respective side, the corresponding disconnected box is drawn.</div>
<div class="line">    disconnected_top = box OR {box1, box2, ...}</div>
<div class="line">    disconnected_bottom = box OR {box1, box2, ...}</div>
<div class="line">    disconnected_front = box OR {box1, box2, ...}</div>
<div class="line">    disconnected_left = box OR {box1, box2, ...}</div>
<div class="line">    disconnected_back = box OR {box1, box2, ...}</div>
<div class="line">    disconnected_right = box OR {box1, box2, ...}</div>
<div class="line">    disconnected = box OR {box1, box2, ...} -- when there is *no* neighbor</div>
<div class="line">    disconnected_sides = box OR {box1, box2, ...} -- when there are *no*</div>
<div class="line">                                                  -- neighbors to the sides</div>
<div class="line">}</div>
</div><!-- fragment --><p>A <code>box</code> is defined as:</p>
<div class="fragment"><div class="line">{x1, y1, z1, x2, y2, z2}</div>
</div><!-- fragment --><p>A box of a regular node would look like:</p>
<div class="fragment"><div class="line">{-0.5, -0.5, -0.5, 0.5, 0.5, 0.5},</div>
</div><!-- fragment --><p>To avoid collision issues, keep each value within the range of +/- 1.45. This also applies to leveled nodeboxes, where the final height shall not exceed this soft limit.</p>
<h1><a class="anchor" id="autotoc_md810"></a>
Map terminology and coordinates</h1>
<h2><a class="anchor" id="autotoc_md811"></a>
Nodes, mapblocks, mapchunks</h2>
<p>A 'node' is the fundamental cubic unit of a world and appears to a player as roughly 1x1x1 meters in size.</p>
<p>A 'mapblock' (often abbreviated to 'block') is 16x16x16 nodes and is the fundamental region of a world that is stored in the world database, sent to clients and handled by many parts of the engine. 'mapblock' is preferred terminology to 'block' to help avoid confusion with 'node', however 'block' often appears in the API.</p>
<p>A 'mapchunk' (sometimes abbreviated to 'chunk') is usually 5x5x5 mapblocks (80x80x80 nodes) and is the volume of world generated in one operation by the map generator. The size in mapblocks has been chosen to optimize map generation.</p>
<h2><a class="anchor" id="autotoc_md812"></a>
Coordinates</h2>
<h3><a class="anchor" id="autotoc_md813"></a>
Orientation of axes</h3>
<p>For node and mapblock coordinates, +X is East, +Y is up, +Z is North.</p>
<h3><a class="anchor" id="autotoc_md814"></a>
Node coordinates</h3>
<p>Almost all positions used in the API use node coordinates.</p>
<h3><a class="anchor" id="autotoc_md815"></a>
Mapblock coordinates</h3>
<p>Occasionally the API uses 'blockpos' which refers to mapblock coordinates that specify a particular mapblock. For example blockpos (0,0,0) specifies the mapblock that extends from node position (0,0,0) to node position (15,15,15).</p>
<h4><a class="anchor" id="autotoc_md816"></a>
Converting node position to the containing blockpos</h4>
<p>To calculate the blockpos of the mapblock that contains the node at 'nodepos', for each axis:</p>
<ul>
<li>blockpos = math.floor(nodepos / 16)</li>
</ul>
<h4><a class="anchor" id="autotoc_md817"></a>
Converting blockpos to min/max node positions</h4>
<p>To calculate the min/max node positions contained in the mapblock at 'blockpos', for each axis:</p>
<ul>
<li>Minimum: nodepos = blockpos * 16</li>
<li>Maximum: nodepos = blockpos * 16 + 15</li>
</ul>
<h1><a class="anchor" id="autotoc_md818"></a>
HUD</h1>
<h2><a class="anchor" id="autotoc_md819"></a>
HUD element types</h2>
<p>The position field is used for all element types. To account for differing resolutions, the position coordinates are the percentage of the screen, ranging in value from <code>0</code> to <code>1</code>.</p>
<p>The <code>name</code> field is not yet used, but should contain a description of what the HUD element represents.</p>
<p>The <code>direction</code> field is the direction in which something is drawn. <code>0</code> draws from left to right, <code>1</code> draws from right to left, <code>2</code> draws from top to bottom, and <code>3</code> draws from bottom to top.</p>
<p>The <code>alignment</code> field specifies how the item will be aligned. It is a table where <code>x</code> and <code>y</code> range from <code>-1</code> to <code>1</code>, with <code>0</code> being central. <code>-1</code> is moved to the left/up, and <code>1</code> is to the right/down. Fractional values can be used.</p>
<p>The <code>offset</code> field specifies a pixel offset from the position. Contrary to position, the offset is not scaled to screen size. This allows for some precisely positioned items in the HUD.</p>
<p><b>Note</b>: <code>offset</code> <em>will</em> adapt to screen DPI as well as user defined scaling factor!</p>
<p>The <code>z_index</code> field specifies the order of HUD elements from back to front. Lower z-index elements are displayed behind higher z-index elements. Elements with same z-index are displayed in an arbitrary order. Default 0. Supports negative values. By convention, the following values are recommended:</p>
<ul>
<li>-400: Graphical effects, such as vignette</li>
<li>-300: Name tags, waypoints</li>
<li>-200: Wieldhand</li>
<li>-100: Things that block the player's view, e.g. masks</li>
<li>0: Default. For standard in-game HUD elements like crosshair, hotbar, minimap, builtin statbars, etc.</li>
<li>100: Temporary text messages or notification icons</li>
<li>1000: Full-screen effects such as full-black screen or credits. This includes effects that cover the entire screen</li>
</ul>
<p>If your HUD element doesn't fit into any category, pick a number between the suggested values</p>
<p>Below are the specific uses for fields in each type; fields not listed for that type are ignored.</p>
<h3><a class="anchor" id="autotoc_md820"></a>
&lt;tt&gt;image&lt;/tt&gt;</h3>
<p>Displays an image on the HUD.</p>
<ul>
<li><code>scale</code>: The scale of the image, with 1 being the original texture size. Only the X coordinate scale is used (positive values). Negative values represent that percentage of the screen it should take; e.g. <code>x=-100</code> means 100% (width).</li>
<li><code>text</code>: The name of the texture that is displayed.</li>
<li><code>alignment</code>: The alignment of the image.</li>
<li><code>offset</code>: offset in pixels from position.</li>
</ul>
<h3><a class="anchor" id="autotoc_md821"></a>
&lt;tt&gt;text&lt;/tt&gt;</h3>
<p>Displays text on the HUD.</p>
<ul>
<li><code>scale</code>: Defines the bounding rectangle of the text. A value such as <code>{x=100, y=100}</code> should work.</li>
<li><code>text</code>: The text to be displayed in the HUD element.</li>
<li><code>number</code>: An integer containing the RGB value of the color used to draw the text. Specify <code>0xFFFFFF</code> for white text, <code>0xFF0000</code> for red, and so on.</li>
<li><code>alignment</code>: The alignment of the text.</li>
<li><code>offset</code>: offset in pixels from position.</li>
<li><code>size</code>: size of the text. The player-set font size is multiplied by size.x (y value isn't used).</li>
<li><code>style</code>: determines font style Bitfield with 1 = bold, 2 = italic, 4 = monospace</li>
</ul>
<h3><a class="anchor" id="autotoc_md822"></a>
&lt;tt&gt;statbar&lt;/tt&gt;</h3>
<p>Displays a horizontal bar made up of half-images with an optional background.</p>
<ul>
<li><code>text</code>: The name of the texture to use.</li>
<li><code>text2</code>: <a class="el" href="classOptional.html">Optional</a> texture name to enable a background / "off state" texture (useful to visualize the maximal value). Both textures must have the same size.</li>
<li><code>number</code>: The number of half-textures that are displayed. If odd, will end with a vertically center-split texture.</li>
<li><code>item</code>: Same as <code>number</code> but for the "off state" texture</li>
<li><code>direction</code>: To which direction the images will extend to</li>
<li><code>offset</code>: offset in pixels from position.</li>
<li><code>size</code>: If used, will force full-image size to this value (override texture pack image size)</li>
</ul>
<h3><a class="anchor" id="autotoc_md823"></a>
&lt;tt&gt;inventory&lt;/tt&gt;</h3>
<ul>
<li><code>text</code>: The name of the inventory list to be displayed.</li>
<li><code>number</code>: Number of items in the inventory to be displayed.</li>
<li><code>item</code>: Position of item that is selected.</li>
<li><code>direction</code>: Direction the list will be displayed in</li>
<li><code>offset</code>: offset in pixels from position.</li>
</ul>
<h3><a class="anchor" id="autotoc_md824"></a>
&lt;tt&gt;waypoint&lt;/tt&gt;</h3>
<p>Displays distance to selected world position.</p>
<ul>
<li><code>name</code>: The name of the waypoint.</li>
<li><code>text</code>: Distance suffix. Can be blank.</li>
<li><code>precision</code>: Waypoint precision, integer &gt;= 0. Defaults to 10. If set to 0, distance is not shown. Shown value is <code>floor(distance*precision)/precision</code>. When the precision is an integer multiple of 10, there will be <code>log_10(precision)</code> digits after the decimal point. <code>precision = 1000</code>, for example, will show 3 decimal places (eg: <code>0.999</code>). <code>precision = 2</code> will show multiples of <code>0.5</code>; precision = 5 will show multiples of <code>0.2</code> and so on: <code>precision = n</code> will show multiples of <code>1/n</code></li>
<li><code>number:</code> An integer containing the RGB value of the color used to draw the text.</li>
<li><code>world_pos</code>: World position of the waypoint.</li>
<li><code>offset</code>: offset in pixels from position.</li>
<li><code>alignment</code>: The alignment of the waypoint.</li>
</ul>
<h3><a class="anchor" id="autotoc_md825"></a>
&lt;tt&gt;image_waypoint&lt;/tt&gt;</h3>
<p>Same as <code>image</code>, but does not accept a <code>position</code>; the position is instead determined by <code>world_pos</code>, the world position of the waypoint.</p>
<ul>
<li><code>scale</code>: The scale of the image, with 1 being the original texture size. Only the X coordinate scale is used (positive values). Negative values represent that percentage of the screen it should take; e.g. <code>x=-100</code> means 100% (width).</li>
<li><code>text</code>: The name of the texture that is displayed.</li>
<li><code>alignment</code>: The alignment of the image.</li>
<li><code>world_pos</code>: World position of the waypoint.</li>
<li><code>offset</code>: offset in pixels from position.</li>
</ul>
<h3><a class="anchor" id="autotoc_md826"></a>
&lt;tt&gt;compass&lt;/tt&gt;</h3>
<p>Displays an image oriented or translated according to current heading direction.</p>
<ul>
<li><code>size</code>: The size of this element. Negative values represent percentage of the screen; e.g. <code>x=-100</code> means 100% (width).</li>
<li><code>scale</code>: Scale of the translated image (used only for dir = 2 or dir = 3).</li>
<li><code>text</code>: The name of the texture to use.</li>
<li><code>alignment</code>: The alignment of the image.</li>
<li><code>offset</code>: Offset in pixels from position.</li>
<li><code>direction</code>: How the image is rotated/translated:<ul>
<li>0 - Rotate as heading direction</li>
<li>1 - Rotate in reverse direction</li>
<li>2 - Translate as landscape direction</li>
<li>3 - Translate in reverse direction</li>
</ul>
</li>
</ul>
<p>If translation is chosen, texture is repeated horizontally to fill the whole element.</p>
<h3><a class="anchor" id="autotoc_md827"></a>
&lt;tt&gt;minimap&lt;/tt&gt;</h3>
<p>Displays a minimap on the HUD.</p>
<ul>
<li><code>size</code>: Size of the minimap to display. <a class="el" href="classMinimap.html">Minimap</a> should be a square to avoid distortion.</li>
<li><code>alignment</code>: The alignment of the minimap.</li>
<li><code>offset</code>: offset in pixels from position.</li>
</ul>
<h1><a class="anchor" id="autotoc_md828"></a>
Representations of simple things</h1>
<h2><a class="anchor" id="autotoc_md829"></a>
Vector (ie. a position)</h2>
<div class="fragment"><div class="line">vector.new(x, y, z)</div>
</div><!-- fragment --><p>See [Spatial Vectors] for details.</p>
<h2><a class="anchor" id="autotoc_md830"></a>
&lt;tt&gt;pointed_thing&lt;/tt&gt;</h2>
<ul>
<li><code>{type="nothing"}</code></li>
<li><code>{type="node", under=pos, above=pos}</code><ul>
<li>Indicates a pointed node selection box.</li>
<li><code>under</code> refers to the node position behind the pointed face.</li>
<li><code>above</code> refers to the node position in front of the pointed face.</li>
</ul>
</li>
<li><code>{type="object", ref=<a class="el" href="classObjectRef.html">ObjectRef</a>}</code></li>
</ul>
<p>Exact pointing location (currently only <code>Raycast</code> supports these fields):</p>
<ul>
<li><code>pointed_thing.intersection_point</code>: The absolute world coordinates of the point on the selection box which is pointed at. May be in the selection box if the pointer is in the box too.</li>
<li><code>pointed_thing.box_id</code>: The ID of the pointed selection box (counting starts from 1).</li>
<li><code>pointed_thing.intersection_normal</code>: Unit vector, points outwards of the selected selection box. This specifies which face is pointed at. Is a null vector <code>vector.zero()</code> when the pointer is inside the selection box. For entities with rotated selection boxes, this will be rotated properly by the entity's rotation - it will always be in absolute world space.</li>
</ul>
<h1><a class="anchor" id="autotoc_md831"></a>
Flag Specifier Format</h1>
<p>Flags using the standardized flag specifier format can be specified in either of two ways, by string or table.</p>
<p>The string format is a comma-delimited set of flag names; whitespace and unrecognized flag fields are ignored. Specifying a flag in the string sets the flag, and specifying a flag prefixed by the string <code>"no"</code> explicitly clears the flag from whatever the default may be.</p>
<p>In addition to the standard string flag format, the schematic flags field can also be a table of flag names to boolean values representing whether or not the flag is set. Additionally, if a field with the flag name prefixed with <code>"no"</code> is present, mapped to a boolean of any value, the specified flag is unset.</p>
<p>E.g. A flag field of value</p>
<div class="fragment"><div class="line">{place_center_x = true, place_center_y=false, place_center_z=true}</div>
</div><!-- fragment --><p>is equivalent to</p>
<div class="fragment"><div class="line">{place_center_x = true, noplace_center_y=true, place_center_z=true}</div>
</div><!-- fragment --><p>which is equivalent to</p>
<div class="fragment"><div class="line">&quot;place_center_x, noplace_center_y, place_center_z&quot;</div>
</div><!-- fragment --><p>or even</p>
<div class="fragment"><div class="line">&quot;place_center_x, place_center_z&quot;</div>
</div><!-- fragment --><p>since, by default, no schematic attributes are set.</p>
<h1><a class="anchor" id="autotoc_md832"></a>
Items</h1>
<p>Items are things that can be held by players, dropped in the map and stored in inventories. Items come in the form of item stacks, which are collections of equal items that occupy a single inventory slot.</p>
<h2><a class="anchor" id="autotoc_md833"></a>
Item types</h2>
<p>There are three kinds of items: nodes, tools and craftitems.</p>
<ul>
<li><a class="el" href="structNode.html">Node</a>: Placeable item form of a node in the world's voxel grid</li>
<li>Tool: Has a changeable wear property but cannot be stacked</li>
<li>Craftitem: Has no special properties</li>
</ul>
<p>Every registered node (the voxel in the world) has a corresponding item form (the thing in your inventory) that comes along with it. This item form can be placed which will create a node in the world (by default). Both the 'actual' node and its item form share the same identifier. For all practical purposes, you can treat the node and its item form interchangeably. We usually just say 'node' to the item form of the node as well.</p>
<p>Note the definition of tools is purely technical. The only really unique thing about tools is their wear, and that's basically it. Beyond that, you can't make any gameplay-relevant assumptions about tools or non-tools. It is perfectly valid to register something that acts as tool in a gameplay sense as a craftitem, and vice-versa.</p>
<p>Craftitems can be used for items that neither need to be a node nor a tool.</p>
<h2><a class="anchor" id="autotoc_md834"></a>
Amount and wear</h2>
<p>All item stacks have an amount between 0 and 65535. It is 1 by default. Tool item stacks cannot have an amount greater than 1.</p>
<p>Tools use a wear (damage) value ranging from 0 to 65535. The value 0 is the default and is used for unworn tools. The values 1 to 65535 are used for worn tools, where a higher value stands for a higher wear. Non-tools technically also have a wear property, but it is always 0. There is also a special 'toolrepair' crafting recipe that is only available to tools.</p>
<h2><a class="anchor" id="autotoc_md835"></a>
Item formats</h2>
<p>Items and item stacks can exist in three formats: Serializes, table format and <code><a class="el" href="structItemStack.html">ItemStack</a></code>.</p>
<p>When an item must be passed to a function, it can usually be in any of these formats.</p>
<h3><a class="anchor" id="autotoc_md836"></a>
Serialized</h3>
<p>This is called "stackstring" or "itemstring". It is a simple string with 1-4 components:</p>
<ol type="1">
<li>Full item identifier ("item name")</li>
<li><a class="el" href="classOptional.html">Optional</a> amount</li>
<li><a class="el" href="classOptional.html">Optional</a> wear value</li>
<li><a class="el" href="classOptional.html">Optional</a> item metadata</li>
</ol>
<p>Syntax: </p><pre class="fragment">&lt;identifier&gt; [&lt;amount&gt;[ &lt;wear&gt;[ &lt;metadata&gt;]]]
</pre><p>Examples:</p>
<ul>
<li><code>"default:apple"</code>: 1 apple</li>
<li><code>"default:dirt 5"</code>: 5 dirt</li>
<li><code>"default:pick_stone"</code>: a new stone pickaxe</li>
<li><code>"default:pick_wood 1 21323"</code>: a wooden pickaxe, ca. 1/3 worn out</li>
<li><code>[[default:pick_wood 1 21323 "\u0001description\u0002My worn out pick\u0003"]]</code>:<ul>
<li>a wooden pickaxe from the <code>default</code> mod,</li>
<li>amount must be 1 (pickaxe is a tool), ca. 1/3 worn out (it's a tool),</li>
<li>with the <code>description</code> field set to <code>"My worn out pick"</code> in its metadata</li>
</ul>
</li>
<li><code>[[default:dirt 5 0 "\u0001description\u0002Special dirt\u0003"]]</code>:<ul>
<li>analogous to the above example</li>
<li>note how the wear is set to <code>0</code> as dirt is not a tool</li>
</ul>
</li>
</ul>
<p>You should ideally use the <code><a class="el" href="structItemStack.html">ItemStack</a></code> format to build complex item strings (especially if they use item metadata) without relying on the serialization format. Example: </p><pre class="fragment">local stack = ItemStack("default:pick_wood")
stack:set_wear(21323)
stack:get_meta():set_string("description", "My worn out pick")
local itemstring = stack:to_string()
</pre><p>Additionally the methods <code>minetest.itemstring_with_palette(item, palette_index)</code> and <code>minetest.itemstring_with_color(item, colorstring)</code> may be used to create item strings encoding color information in their metadata.</p>
<h3><a class="anchor" id="autotoc_md837"></a>
Table format</h3>
<p>Examples:</p>
<p>5 dirt nodes:</p>
<div class="fragment"><div class="line">{name=&quot;default:dirt&quot;, count=5, wear=0, metadata=&quot;&quot;}</div>
</div><!-- fragment --><p>A wooden pick about 1/3 worn out:</p>
<div class="fragment"><div class="line">{name=&quot;default:pick_wood&quot;, count=1, wear=21323, metadata=&quot;&quot;}</div>
</div><!-- fragment --><p>An apple:</p>
<div class="fragment"><div class="line">{name=&quot;default:apple&quot;, count=1, wear=0, metadata=&quot;&quot;}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md838"></a>
&lt;tt&gt;ItemStack&lt;/tt&gt;</h3>
<p>A native C++ format with many helper methods. Useful for converting between formats. See the [Class reference] section for details.</p>
<h1><a class="anchor" id="autotoc_md839"></a>
Groups</h1>
<p>In a number of places, there is a group table. Groups define the properties of a thing (item, node, armor of entity, tool capabilities) in such a way that the engine and other mods can can interact with the thing without actually knowing what the thing is.</p>
<h2><a class="anchor" id="autotoc_md840"></a>
Usage</h2>
<p>Groups are stored in a table, having the group names with keys and the group ratings as values. Group ratings are integer values within the range [-32767, 32767]. For example:</p>
<div class="fragment"><div class="line">-- Default dirt</div>
<div class="line">groups = {crumbly=3, soil=1}</div>
<div class="line"> </div>
<div class="line">-- A more special dirt-kind of thing</div>
<div class="line">groups = {crumbly=2, soil=1, level=2, outerspace=1}</div>
</div><!-- fragment --><p>Groups always have a rating associated with them. If there is no useful meaning for a rating for an enabled group, it shall be <code>1</code>.</p>
<p>When not defined, the rating of a group defaults to <code>0</code>. Thus when you read groups, you must interpret <code>nil</code> and <code>0</code> as the same value, <code>0</code>.</p>
<p>You can read the rating of a group for an item or a node by using</p>
<div class="fragment"><div class="line">minetest.get_item_group(itemname, groupname)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md841"></a>
Groups of items</h2>
<p>Groups of items can define what kind of an item it is (e.g. wool).</p>
<h2><a class="anchor" id="autotoc_md842"></a>
Groups of nodes</h2>
<p>In addition to the general item things, groups are used to define whether a node is destroyable and how long it takes to destroy by a tool.</p>
<h2><a class="anchor" id="autotoc_md843"></a>
Groups of entities</h2>
<p>For entities, groups are, as of now, used only for calculating damage. The rating is the percentage of damage caused by items with this damage group. See [<a class="el" href="structEntity.html">Entity</a> damage mechanism].</p>
<div class="fragment"><div class="line">object:get_armor_groups() --&gt; a group-rating table (e.g. {fleshy=100})</div>
<div class="line">object:set_armor_groups({fleshy=30, cracky=80})</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md844"></a>
Groups of tool capabilities</h2>
<p>Groups in tool capabilities define which groups of nodes and entities they are effective towards.</p>
<h2><a class="anchor" id="autotoc_md845"></a>
Groups in crafting recipes</h2>
<p>In crafting recipes, you can specify a group as an input item. This means that any item in that group will be accepted as input.</p>
<p>The basic syntax is:</p>
<div class="fragment"><div class="line">&quot;group:&lt;group_name&gt;&quot;</div>
</div><!-- fragment --><p>For example, <code>"group:meat"</code> will accept any item in the <code>meat</code> group.</p>
<p>It is also possible to require an input item to be in multiple groups at once. The syntax for that is:</p>
<div class="fragment"><div class="line">&quot;group:&lt;group_name_1&gt;,&lt;group_name_2&gt;,(...),&lt;group_name_n&gt;&quot;</div>
</div><!-- fragment --><p>For example, <code>"group:leaves,birch,trimmed"</code> accepts any item which is member of <em>all</em> the groups <code>leaves</code> <em>and</em> <code>birch</code> <em>and</em> <code>trimmed</code>.</p>
<p>An example recipe: Craft a raw meat soup from any meat, any water and any bowl:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    output = &quot;food:meat_soup_raw&quot;,</div>
<div class="line">    recipe = {</div>
<div class="line">        {&quot;group:meat&quot;},</div>
<div class="line">        {&quot;group:water&quot;},</div>
<div class="line">        {&quot;group:bowl&quot;},</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><p>Another example: Craft red wool from white wool and red dye (here, "red dye" is defined as any item which is member of <em>both</em> the groups <code>dye</code> and <code>basecolor_red</code>).</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    type = &quot;shapeless&quot;,</div>
<div class="line">    output = &quot;wool:red&quot;,</div>
<div class="line">    recipe = {&quot;wool:white&quot;, &quot;group:dye,basecolor_red&quot;},</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md846"></a>
Special groups</h2>
<p>The asterisk <code>(*)</code> after a group name describes that there is no engine functionality bound to it, and implementation is left up as a suggestion to games.</p>
<h3><a class="anchor" id="autotoc_md847"></a>
Node and item groups</h3>
<ul>
<li><code>not_in_creative_inventory</code>: (*) Special group for inventory mods to indicate that the item should be hidden in item lists.</li>
</ul>
<h3><a class="anchor" id="autotoc_md848"></a>
Node-only groups</h3>
<ul>
<li><code>attached_node</code>: the node is 'attached' to a neighboring node. It checks whether the node it is attached to is walkable. If it isn't, the node will drop as an item.<ul>
<li><code>1</code>: if the node is wallmounted, the node is attached in the wallmounted direction. Otherwise, the node is attached to the node below.</li>
<li><code>2</code>: if the node is facedir or 4dir, the facedir or 4dir direction is checked. No effect for other nodes. Note: The "attaching face" of this node is tile no. 5 (back face).</li>
<li><code>3</code>: the node is always attached to the node below.</li>
<li><code>4</code>: the node is always attached to the node above.</li>
</ul>
</li>
<li><code>bouncy</code>: value is bounce speed in percent. If positive, jump/sneak on floor impact will increase/decrease bounce height. Negative value is the same bounciness, but non-controllable.</li>
<li><code>connect_to_raillike</code>: makes nodes of raillike drawtype with same group value connect to each other</li>
<li><code>dig_immediate</code>: <a class="el" href="classPlayer.html">Player</a> can always pick up node without reducing tool wear<ul>
<li><code>2</code>: the node always gets the digging time 0.5 seconds (rail, sign)</li>
<li><code>3</code>: the node always gets the digging time 0 seconds (torch)</li>
</ul>
</li>
<li><code>disable_jump</code>: <a class="el" href="classPlayer.html">Player</a> (and possibly other things) cannot jump from node or if their feet are in the node. Note: not supported for <code>new_move = false</code></li>
<li><code>fall_damage_add_percent</code>: modifies the fall damage suffered when hitting the top of this node. There's also an armor group with the same name. The final player damage is determined by the following formula: damage = collision speed<ul>
<li>((node_fall_damage_add_percent + 100) / 100) &ndash; node group</li>
<li>((player_fall_damage_add_percent + 100) / 100) &ndash; player armor group</li>
<li>(14) &ndash; constant tolerance Negative damage values are discarded as no damage.</li>
</ul>
</li>
<li><code>falling_node</code>: if there is no walkable block under the node it will fall</li>
<li><code>float</code>: the node will not fall through liquids (<code>liquidtype ~= "none"</code>)</li>
<li><code>level</code>: Can be used to give an additional sense of progression in the game.<ul>
<li>A larger level will cause e.g. a weapon of a lower level make much less damage, and get worn out much faster, or not be able to get drops from destroyed nodes.</li>
<li><code>0</code> is something that is directly accessible at the start of gameplay</li>
<li>There is no upper limit</li>
<li>See also: <code>leveldiff</code> in [Tool Capabilities]</li>
</ul>
</li>
<li><code>slippery</code>: Players and items will slide on the node. Slipperiness rises steadily with <code>slippery</code> value, starting at 1.</li>
</ul>
<h3><a class="anchor" id="autotoc_md849"></a>
Tool-only groups</h3>
<ul>
<li><code>disable_repair</code>: If set to 1 for a tool, it cannot be repaired using the <code>"toolrepair"</code> crafting recipe</li>
</ul>
<h3><a class="anchor" id="autotoc_md850"></a>
&lt;tt&gt;ObjectRef&lt;/tt&gt; armor groups</h3>
<ul>
<li><code>immortal</code>: Skips all damage and breath handling for an object. This group will also hide the integrated HUD status bars for players. It is automatically set to all players when damage is disabled on the server and cannot be reset (subject to change).</li>
<li><code>fall_damage_add_percent</code>: Modifies the fall damage suffered by players when they hit the ground. It is analog to the node group with the same name. See the node group above for the exact calculation.</li>
<li><code>punch_operable</code>: For entities; disables the regular damage mechanism for players punching it by hand or a non-tool item, so that it can do something else than take damage.</li>
</ul>
<h2><a class="anchor" id="autotoc_md851"></a>
Known damage and digging time defining groups</h2>
<ul>
<li><code>crumbly</code>: dirt, sand</li>
<li><code>cracky</code>: tough but crackable stuff like stone.</li>
<li><code>snappy</code>: something that can be cut using things like scissors, shears, bolt cutters and the like, e.g. leaves, small plants, wire, sheets of metal</li>
<li><code>choppy</code>: something that can be cut using force; e.g. trees, wooden planks</li>
<li><code>fleshy</code>: Living things like animals and the player. This could imply some blood effects when hitting.</li>
<li><code>explody</code>: Especially prone to explosions</li>
<li><code>oddly_breakable_by_hand</code>: Can be added to nodes that shouldn't logically be breakable by the hand but are. Somewhat similar to <code>dig_immediate</code>, but times are more like <code>{[1]=3.50,[2]=2.00,[3]=0.70}</code> and this does not override the digging speed of an item if it can dig at a faster speed than this suggests for the hand.</li>
</ul>
<h2><a class="anchor" id="autotoc_md852"></a>
Examples of custom groups</h2>
<p>Item groups are often used for defining, well, <em>groups of items</em>.</p>
<ul>
<li><code>meat</code>: any meat-kind of a thing (rating might define the size or healing ability or be irrelevant &ndash; it is not defined as of yet)</li>
<li><code>eatable</code>: anything that can be eaten. Rating might define HP gain in half hearts.</li>
<li><code>flammable</code>: can be set on fire. Rating might define the intensity of the fire, affecting e.g. the speed of the spreading of an open fire.</li>
<li><code>wool</code>: any wool (any origin, any color)</li>
<li><code>metal</code>: any metal</li>
<li><code>weapon</code>: any weapon</li>
<li><code>heavy</code>: anything considerably heavy</li>
</ul>
<h2><a class="anchor" id="autotoc_md853"></a>
Digging time calculation specifics</h2>
<p>Groups such as <code>crumbly</code>, <code>cracky</code> and <code>snappy</code> are used for this purpose. Rating is <code>1</code>, <code>2</code> or <code>3</code>. A higher rating for such a group implies faster digging time.</p>
<p>The <code>level</code> group is used to limit the toughness of nodes an item capable of digging can dig and to scale the digging times / damage to a greater extent.</p>
<p><b>Please do understand this</b>, otherwise you cannot use the system to it's full potential.</p>
<p>Items define their properties by a list of parameters for groups. They cannot dig other groups; thus it is important to use a standard bunch of groups to enable interaction with items.</p>
<h1><a class="anchor" id="autotoc_md854"></a>
Tool Capabilities</h1>
<p>'Tool capabilities' is a property of items that defines two things:</p>
<p>1) Which nodes it can dig and how fast 2) Which objects it can hurt by punching and by how much</p>
<p>Tool capabilities are available for all items, not just tools. But only tools can receive wear from digging and punching.</p>
<p>Missing or incomplete tool capabilities will default to the player's hand.</p>
<h2><a class="anchor" id="autotoc_md855"></a>
Tool capabilities definition</h2>
<p>Tool capabilities define:</p>
<ul>
<li>Full punch interval</li>
<li>Maximum drop level</li>
<li>For an arbitrary list of node groups:<ul>
<li>Uses (until the tool breaks)</li>
<li>Maximum level (usually <code>0</code>, <code>1</code>, <code>2</code> or <code>3</code>)</li>
<li>Digging times</li>
</ul>
</li>
<li>Damage groups</li>
<li>Punch attack uses (until the tool breaks)</li>
</ul>
<h3><a class="anchor" id="autotoc_md856"></a>
Full punch interval &lt;tt&gt;full_punch_interval&lt;/tt&gt;</h3>
<p>When used as a weapon, the item will do full damage if this time is spent between punches. If e.g. half the time is spent, the item will do half damage.</p>
<h3><a class="anchor" id="autotoc_md857"></a>
Maximum drop level &lt;tt&gt;max_drop_level&lt;/tt&gt;</h3>
<p>Suggests the maximum level of node, when dug with the item, that will drop its useful item. (e.g. iron ore to drop a lump of iron).</p>
<p>This value is not used in the engine; it is the responsibility of the game/mod code to implement this.</p>
<h3><a class="anchor" id="autotoc_md858"></a>
Uses &lt;tt&gt;uses&lt;/tt&gt; (tools only)</h3>
<p>Determines how many uses the tool has when it is used for digging a node, of this group, of the maximum level. The maximum supported number of uses is 65535. The special number 0 is used for infinite uses. For lower leveled nodes, the use count is multiplied by <code>3^leveldiff</code>. <code>leveldiff</code> is the difference of the tool's <code>maxlevel</code> <code>groupcaps</code> and the node's <code>level</code> group. The node cannot be dug if <code>leveldiff</code> is less than zero.</p>
<ul>
<li><code>uses=10, leveldiff=0</code>: actual uses: 10</li>
<li><code>uses=10, leveldiff=1</code>: actual uses: 30</li>
<li><code>uses=10, leveldiff=2</code>: actual uses: 90</li>
</ul>
<p>For non-tools, this has no effect.</p>
<h3><a class="anchor" id="autotoc_md859"></a>
Maximum level &lt;tt&gt;maxlevel&lt;/tt&gt;</h3>
<p>Tells what is the maximum level of a node of this group that the item will be able to dig.</p>
<h3><a class="anchor" id="autotoc_md860"></a>
Digging times &lt;tt&gt;times&lt;/tt&gt;</h3>
<p>List of digging times for different ratings of the group, for nodes of the maximum level.</p>
<p>For example, as a Lua table, <code>times={[2]=2.00, [3]=0.70}</code>. This would result in the item to be able to dig nodes that have a rating of <code>2</code> or <code>3</code> for this group, and unable to dig the rating <code>1</code>, which is the toughest. Unless there is a matching group that enables digging otherwise.</p>
<p>If the result digging time is 0, a delay of 0.15 seconds is added between digging nodes; If the player releases LMB after digging, this delay is set to 0, i.e. players can more quickly click the nodes away instead of holding LMB.</p>
<h3><a class="anchor" id="autotoc_md861"></a>
Damage groups</h3>
<p>List of damage for groups of entities. See [<a class="el" href="structEntity.html">Entity</a> damage mechanism].</p>
<h3><a class="anchor" id="autotoc_md862"></a>
Punch attack uses (tools only)</h3>
<p>Determines how many uses (before breaking) the tool has when dealing damage to an object, when the full punch interval (see above) was always waited out fully.</p>
<p>Wear received by the tool is proportional to the time spent, scaled by the full punch interval.</p>
<p>For non-tools, this has no effect.</p>
<h2><a class="anchor" id="autotoc_md863"></a>
Example definition of the capabilities of an item</h2>
<div class="fragment"><div class="line">tool_capabilities = {</div>
<div class="line">    groupcaps={</div>
<div class="line">        crumbly={maxlevel=2, uses=20, times={[1]=1.60, [2]=1.20, [3]=0.80}}</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><p>This makes the item capable of digging nodes that fulfill both of these:</p>
<ul>
<li>Have the <code>crumbly</code> group</li>
<li>Have a <code>level</code> group less or equal to <code>2</code></li>
</ul>
<p><a class="el" href="structTable.html">Table</a> of resulting digging times: </p><pre class="fragment">crumbly        0     1     2     3     4  &lt;- level
     -&gt;  0     -     -     -     -     -
         1  0.80  1.60  1.60     -     -
         2  0.60  1.20  1.20     -     -
         3  0.40  0.80  0.80     -     -

level diff:    2     1     0    -1    -2
</pre><p><a class="el" href="structTable.html">Table</a> of resulting tool uses: </p><pre class="fragment">-&gt;  0     -     -     -     -     -
    1   180    60    20     -     -
    2   180    60    20     -     -
    3   180    60    20     -     -
</pre><p><b>Notes</b>:</p>
<ul>
<li>At <code>crumbly==0</code>, the node is not diggable.</li>
<li>At <code>crumbly==3</code>, the level difference digging time divider kicks in and makes easy nodes to be quickly breakable.</li>
<li>At <code>level &gt; 2</code>, the node is not diggable, because it's <code>level &gt; maxlevel</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md864"></a>
Entity damage mechanism</h1>
<p>Damage calculation: </p><pre class="fragment">damage = 0
foreach group in cap.damage_groups:
    damage += cap.damage_groups[group]
        * limit(actual_interval / cap.full_punch_interval, 0.0, 1.0)
        * (object.armor_groups[group] / 100.0)
        -- Where object.armor_groups[group] is 0 for inexistent values
return damage
</pre><p><a class="el" href="classClient.html">Client</a> predicts damage based on damage groups. Because of this, it is able to give an immediate response when an entity is damaged or dies; the response is pre-defined somehow (e.g. by defining a sprite animation) (not implemented; TODO). Currently a smoke puff will appear when an entity dies.</p>
<p>The group <code>immortal</code> completely disables normal damage.</p>
<p>Entities can define a special armor group, which is <code>punch_operable</code>. This group disables the regular damage mechanism for players punching it by hand or a non-tool item, so that it can do something else than take damage.</p>
<p>On the Lua side, every punch calls:</p>
<div class="fragment"><div class="line">entity:on_punch(puncher, time_from_last_punch, tool_capabilities, direction,</div>
<div class="line">                damage)</div>
</div><!-- fragment --><p>This should never be called directly, because damage is usually not handled by the entity itself.</p>
<ul>
<li><code>puncher</code> is the object performing the punch. Can be <code>nil</code>. Should never be accessed unless absolutely required, to encourage interoperability.</li>
<li><code>time_from_last_punch</code> is time from last punch (by <code>puncher</code>) or <code>nil</code>.</li>
<li><code>tool_capabilities</code> can be <code>nil</code>.</li>
<li><code>direction</code> is a unit vector, pointing from the source of the punch to the punched object.</li>
<li><code>damage</code> damage that will be done to entity Return value of this function will determine if damage is done by this function (retval true) or shall be done by engine (retval false)</li>
</ul>
<p>To punch an entity/object in Lua, call:</p>
<div class="fragment"><div class="line">object:punch(puncher, time_from_last_punch, tool_capabilities, direction)</div>
</div><!-- fragment --><ul>
<li>Return value is tool wear.</li>
<li>Parameters are equal to the above callback.</li>
<li>If <code>direction</code> equals <code>nil</code> and <code>puncher</code> does not equal <code>nil</code>, <code>direction</code> will be automatically filled in based on the location of <code>puncher</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md865"></a>
Metadata</h1>
<h2><a class="anchor" id="autotoc_md866"></a>
Node Metadata</h2>
<p>The instance of a node in the world normally only contains the three values mentioned in [Nodes]. However, it is possible to insert extra data into a node. It is called "node metadata"; See <code><a class="el" href="classNodeMetaRef.html">NodeMetaRef</a></code>.</p>
<p><a class="el" href="structNode.html">Node</a> metadata contains two things:</p>
<ul>
<li>A key-value store</li>
<li>An inventory</li>
</ul>
<p>Some of the values in the key-value store are handled specially:</p>
<ul>
<li><code>formspec</code>: Defines an inventory menu that is opened with the 'place/use' key. Only works if no <code>on_rightclick</code> was defined for the node. See also [Formspec].</li>
<li><code>infotext</code>: Text shown on the screen when the node is pointed at. Line-breaks will be applied automatically. If the infotext is very long, it will be truncated.</li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line">local meta = minetest.get_meta(pos)</div>
<div class="line"> </div>
<div class="line">-- Set node formspec and infotext</div>
<div class="line">meta:set_string(&quot;formspec&quot;,</div>
<div class="line">        &quot;size[8,9]&quot;..</div>
<div class="line">        &quot;list[context;main;0,0;8,4;]&quot;..</div>
<div class="line">        &quot;list[current_player;main;0,5;8,4;]&quot;)</div>
<div class="line">meta:set_string(&quot;infotext&quot;, &quot;Chest&quot;);</div>
<div class="line"> </div>
<div class="line">-- Set inventory list size of `&quot;main&quot;` list to 32</div>
<div class="line">local inv = meta:get_inventory()</div>
<div class="line">inv:set_size(&quot;main&quot;, 32)</div>
<div class="line"> </div>
<div class="line">-- Dump node metadata</div>
<div class="line">print(dump(meta:to_table()))</div>
<div class="line"> </div>
<div class="line">-- Set node metadata from a metadata table</div>
<div class="line">meta:from_table({</div>
<div class="line">    inventory = {</div>
<div class="line">        -- Set items of inventory in all 32 slots of the `&quot;main&quot;` list</div>
<div class="line">        main = {[1] = &quot;default:dirt&quot;, [2] = &quot;&quot;, [3] = &quot;&quot;, [4] = &quot;&quot;,</div>
<div class="line">                [5] = &quot;&quot;, [6] = &quot;&quot;, [7] = &quot;&quot;, [8] = &quot;&quot;, [9] = &quot;&quot;,</div>
<div class="line">                [10] = &quot;&quot;, [11] = &quot;&quot;, [12] = &quot;&quot;, [13] = &quot;&quot;,</div>
<div class="line">                [14] = &quot;default:cobble&quot;, [15] = &quot;&quot;, [16] = &quot;&quot;, [17] = &quot;&quot;,</div>
<div class="line">                [18] = &quot;&quot;, [19] = &quot;&quot;, [20] = &quot;default:cobble&quot;, [21] = &quot;&quot;,</div>
<div class="line">                [22] = &quot;&quot;, [23] = &quot;&quot;, [24] = &quot;&quot;, [25] = &quot;&quot;, [26] = &quot;&quot;,</div>
<div class="line">                [27] = &quot;&quot;, [28] = &quot;&quot;, [29] = &quot;&quot;, [30] = &quot;&quot;, [31] = &quot;&quot;,</div>
<div class="line">                [32] = &quot;&quot;}</div>
<div class="line">    },</div>
<div class="line">    -- metadata fields</div>
<div class="line">    fields = {</div>
<div class="line">        formspec = &quot;size[8,9]list[context;main;0,0;8,4;]list[current_player;main;0,5;8,4;]&quot;,</div>
<div class="line">        infotext = &quot;Chest&quot;</div>
<div class="line">    }</div>
<div class="line">})</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md867"></a>
Item Metadata</h2>
<p>Item stacks can store metadata too. See [<code><a class="el" href="classItemStackMetaRef.html">ItemStackMetaRef</a></code>].</p>
<p>Item metadata only contains a key-value store.</p>
<p>Some of the values in the key-value store are handled specially:</p>
<ul>
<li><code>description</code>: Set the item stack's description. See also: <code>get_description</code> in [<code><a class="el" href="structItemStack.html">ItemStack</a></code>]</li>
<li><code>short_description</code>: Set the item stack's short description. See also: <code>get_short_description</code> in [<code><a class="el" href="structItemStack.html">ItemStack</a></code>]</li>
<li><code>inventory_image</code>: Override inventory_image</li>
<li><code>inventory_overlay</code>: Override inventory_overlay</li>
<li><code>wield_image</code>: Override wield_image</li>
<li><code>wield_overlay</code>: Override wield_overlay</li>
<li><code>wield_scale</code>: Override wield_scale, use vector.to_string</li>
<li><code>color</code>: A <code>ColorString</code>, which sets the stack's color.</li>
<li><code>palette_index</code>: If the item has a palette, this is used to get the current color from the palette.</li>
<li><code>count_meta</code>: Replace the displayed count with any string.</li>
<li><code>count_alignment</code>: Set the alignment of the displayed count value. This is an int value. The lowest 2 bits specify the alignment in x-direction, the 3rd and 4th bit specify the alignment in y-direction: 0 = default, 1 = left / up, 2 = middle, 3 = right / down The default currently is the same as right/down. Example: 6 = 2 + 1*4 = middle,up</li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line">local meta = stack:get_meta()</div>
<div class="line">meta:set_string(&quot;key&quot;, &quot;value&quot;)</div>
<div class="line">print(dump(meta:to_table()))</div>
</div><!-- fragment --><p>Example manipulations of "description" and expected output behaviors:</p>
<div class="fragment"><div class="line">print(ItemStack(&quot;default:pick_steel&quot;):get_description()) --&gt; Steel Pickaxe</div>
<div class="line">print(ItemStack(&quot;foobar&quot;):get_description()) --&gt; Unknown Item</div>
<div class="line"> </div>
<div class="line">local stack = ItemStack(&quot;default:stone&quot;)</div>
<div class="line">stack:get_meta():set_string(&quot;description&quot;, &quot;Custom description\nAnother line&quot;)</div>
<div class="line">print(stack:get_description()) --&gt; Custom description\nAnother line</div>
<div class="line">print(stack:get_short_description()) --&gt; Custom description</div>
<div class="line"> </div>
<div class="line">stack:get_meta():set_string(&quot;short_description&quot;, &quot;Short&quot;)</div>
<div class="line">print(stack:get_description()) --&gt; Custom description\nAnother line</div>
<div class="line">print(stack:get_short_description()) --&gt; Short</div>
<div class="line"> </div>
<div class="line">print(ItemStack(&quot;mod:item_with_no_desc&quot;):get_description()) --&gt; mod:item_with_no_desc</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md868"></a>
Formspec</h1>
<p>Formspec defines a menu. This supports inventories and some of the typical widgets like buttons, checkboxes, text input fields, etc. It is a string, with a somewhat strange format.</p>
<p>A formspec is made out of formspec elements, which includes widgets like buttons but also can be used to set stuff like background color.</p>
<p>Many formspec elements have a <code>name</code>, which is a unique identifier which is used when the server receives user input. You must not use the name "quit" for formspec elements.</p>
<p>Spaces and newlines can be inserted between the blocks, as is used in the examples.</p>
<p>Position and size units are inventory slots unless the new coordinate system is enabled. <code>X</code> and <code>Y</code> position the formspec element relative to the top left of the menu or container. <code>W</code> and <code>H</code> are its width and height values.</p>
<p>If the new system is enabled, all elements have unified coordinates for all elements with no padding or spacing in between. This is highly recommended for new forms. See <code>real_coordinates[&lt;bool&gt;]</code> and <code>Migrating to Real Coordinates</code>.</p>
<p>Inventories with a <code>player:&lt;name&gt;</code> inventory location are only sent to the player named <code>&lt;name&gt;</code>.</p>
<p>When displaying text which can contain formspec code, e.g. text set by a player, use <code>minetest.formspec_escape</code>. For colored text you can use <code>minetest.colorize</code>.</p>
<p>Since formspec version 3, elements drawn in the order they are defined. All background elements are drawn before all other elements.</p>
<p><b>WARNING</b>: do <em>not</em> use an element name starting with <code>key_</code>; those names are reserved to pass key press events to formspec!</p>
<p><b>WARNING</b>: Minetest allows you to add elements to every single formspec instance using <code>player:set_formspec_prepend()</code>, which may be the reason backgrounds are appearing when you don't expect them to, or why things are styled differently to normal. See [<code>no_prepend[]</code>] and [Styling Formspecs].</p>
<h2><a class="anchor" id="autotoc_md869"></a>
Examples</h2>
<h3><a class="anchor" id="autotoc_md870"></a>
Chest</h3>
<pre class="fragment">size[8,9]
list[context;main;0,0;8,4;]
list[current_player;main;0,5;8,4;]
</pre><h3><a class="anchor" id="autotoc_md871"></a>
Furnace</h3>
<pre class="fragment">size[8,9]
list[context;fuel;2,3;1,1;]
list[context;src;2,1;1,1;]
list[context;dst;5,1;2,2;]
list[current_player;main;0,5;8,4;]
</pre><h3><a class="anchor" id="autotoc_md872"></a>
Minecraft-like player inventory</h3>
<pre class="fragment">size[8,7.5]
image[1,0.6;1,2;player.png]
list[current_player;main;0,3.5;8,4;]
list[current_player;craft;3,0;3,3;]
list[current_player;craftpreview;7,1;1,1;]
</pre><h2><a class="anchor" id="autotoc_md873"></a>
Version History</h2>
<ul>
<li>Formspec version 1 (pre-5.1.0):<ul>
<li>(too much)</li>
</ul>
</li>
<li>Formspec version 2 (5.1.0):<ul>
<li>Forced real coordinates</li>
<li>background9[]: 9-slice scaling parameters</li>
</ul>
</li>
<li>Formspec version 3 (5.2.0):<ul>
<li>Formspec elements are drawn in the order of definition</li>
<li>bgcolor[]: use 3 parameters (bgcolor, formspec (now an enum), fbgcolor)</li>
<li>box[] and image[] elements enable clipping by default</li>
<li>new element: scroll_container[]</li>
</ul>
</li>
<li>Formspec version 4 (5.4.0):<ul>
<li>Allow dropdown indexing events</li>
</ul>
</li>
<li>Formspec version 5 (5.5.0):<ul>
<li>Added padding[] element</li>
</ul>
</li>
<li>Formspec version 6 (5.6.0):<ul>
<li>Add nine-slice images, animated_image, and fgimg_middle</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md874"></a>
Elements</h2>
<h3><a class="anchor" id="autotoc_md875"></a>
&lt;tt&gt;formspec_version[&lt;version&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Set the formspec version to a certain number. If not specified, version 1 is assumed.</li>
<li>Must be specified before <code>size</code> element.</li>
<li>Clients older than this version can neither show newer elements nor display elements with new arguments correctly.</li>
<li>Available since feature <code>formspec_version_element</code>.</li>
<li>See also: [Version History]</li>
</ul>
<h3><a class="anchor" id="autotoc_md876"></a>
&lt;tt&gt;size[&lt;W&gt;,&lt;H&gt;,&lt;fixed_size&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Define the size of the menu in inventory slots</li>
<li><code>fixed_size</code>: <code>true</code>/<code>false</code> (optional)</li>
<li>deprecated: <code>invsize[&lt;W&gt;,&lt;H&gt;;]</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md877"></a>
&lt;tt&gt;position[&lt;X&gt;,&lt;Y&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Must be used after <code>size</code> element.</li>
<li>Defines the position on the game window of the formspec's <code>anchor</code> point.</li>
<li>For X and Y, 0.0 and 1.0 represent opposite edges of the game window, for example:<ul>
<li>[0.0, 0.0] sets the position to the top left corner of the game window.</li>
<li>[1.0, 1.0] sets the position to the bottom right of the game window.</li>
</ul>
</li>
<li>Defaults to the center of the game window [0.5, 0.5].</li>
</ul>
<h3><a class="anchor" id="autotoc_md878"></a>
&lt;tt&gt;anchor[&lt;X&gt;,&lt;Y&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Must be used after both <code>size</code> and <code>position</code> (if present) elements.</li>
<li>Defines the location of the anchor point within the formspec.</li>
<li>For X and Y, 0.0 and 1.0 represent opposite edges of the formspec, for example:<ul>
<li>[0.0, 1.0] sets the anchor to the bottom left corner of the formspec.</li>
<li>[1.0, 0.0] sets the anchor to the top right of the formspec.</li>
</ul>
</li>
<li>Defaults to the center of the formspec [0.5, 0.5].</li>
<li><code>position</code> and <code>anchor</code> elements need suitable values to avoid a formspec extending off the game window due to particular game window sizes.</li>
</ul>
<h3><a class="anchor" id="autotoc_md879"></a>
&lt;tt&gt;padding[&lt;X&gt;,&lt;Y&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Must be used after the <code>size</code>, <code>position</code>, and <code>anchor</code> elements (if present).</li>
<li>Defines how much space is padded around the formspec if the formspec tries to increase past the size of the screen and coordinates have to be shrunk.</li>
<li>For X and Y, 0.0 represents no padding (the formspec can touch the edge of the screen), and 0.5 represents half the screen (which forces the coordinate size to 0). If negative, the formspec can extend off the edge of the screen.</li>
<li>Defaults to [0.05, 0.05].</li>
</ul>
<h3><a class="anchor" id="autotoc_md880"></a>
&lt;tt&gt;no_prepend[]&lt;/tt&gt;</h3>
<ul>
<li>Must be used after the <code>size</code>, <code>position</code>, <code>anchor</code>, and <code>padding</code> elements (if present).</li>
<li>Disables player:set_formspec_prepend() from applying to this formspec.</li>
</ul>
<h3><a class="anchor" id="autotoc_md881"></a>
&lt;tt&gt;real_coordinates[&lt;bool&gt;]&lt;/tt&gt;</h3>
<ul>
<li>INFORMATION: Enable it automatically using <code>formspec_version</code> version 2 or newer.</li>
<li>When set to true, all following formspec elements will use the new coordinate system.</li>
<li>If used immediately after <code>size</code>, <code>position</code>, <code>anchor</code>, and <code>no_prepend</code> elements (if present), the form size will use the new coordinate system.</li>
<li><b>Note</b>: Formspec prepends are not affected by the coordinates in the main form. They must enable it explicitly.</li>
<li>For information on converting forms to the new coordinate system, see <code>Migrating to Real Coordinates</code>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md882"></a>
&lt;tt&gt;container[&lt;X&gt;,&lt;Y&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Start of a container block, moves all physical elements in the container by (X, Y).</li>
<li>Must have matching <code>container_end</code></li>
<li>Containers can be nested, in which case the offsets are added (child containers are relative to parent containers)</li>
</ul>
<h3><a class="anchor" id="autotoc_md883"></a>
&lt;tt&gt;container_end[]&lt;/tt&gt;</h3>
<ul>
<li>End of a container, following elements are no longer relative to this container.</li>
</ul>
<h3><a class="anchor" id="autotoc_md884"></a>
&lt;tt&gt;scroll_container[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;scrollbar name&gt;;&lt;orientation&gt;;&lt;scroll factor&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Start of a scroll_container block. All contained elements will ...<ul>
<li>take the scroll_container coordinate as position origin,</li>
<li>be additionally moved by the current value of the scrollbar with the name <code>scrollbar name</code> times <code>scroll factor</code> along the orientation <code>orientation</code> and</li>
<li>be clipped to the rectangle defined by <code>X</code>, <code>Y</code>, <code>W</code> and <code>H</code>.</li>
</ul>
</li>
<li><code>orientation</code>: possible values are <code>vertical</code> and <code>horizontal</code>.</li>
<li><code>scroll factor</code>: optional, defaults to <code>0.1</code>.</li>
<li>Nesting is possible.</li>
<li>Some elements might work a little different if they are in a scroll_container.</li>
<li>Note: If you want the scroll_container to actually work, you also need to add a scrollbar element with the specified name. Furthermore, it is highly recommended to use a scrollbaroptions element on this scrollbar.</li>
</ul>
<h3><a class="anchor" id="autotoc_md885"></a>
&lt;tt&gt;scroll_container_end[]&lt;/tt&gt;</h3>
<ul>
<li>End of a scroll_container, following elements are no longer bound to this container.</li>
</ul>
<h3><a class="anchor" id="autotoc_md886"></a>
&lt;tt&gt;list[&lt;inventory location&gt;;&lt;list name&gt;;&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;starting item index&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show an inventory list if it has been sent to the client.</li>
<li>If the inventory list changes (eg. it didn't exist before, it's resized, or its items are moved) while the formspec is open, the formspec element may (but is not guaranteed to) adapt to the new inventory list.</li>
<li>Item slots are drawn in a grid from left to right, then up to down, ordered according to the slot index.</li>
<li><code>W</code> and <code>H</code> are in inventory slots, not in coordinates.</li>
<li><code>starting item index</code> (<a class="el" href="classOptional.html">Optional</a>): The index of the first (upper-left) item to draw. Indices start at <code>0</code>. Default is <code>0</code>.</li>
<li>The number of shown slots is the minimum of <code>W*H</code> and the inventory list's size minus <code>starting item index</code>.</li>
<li><b>Note</b>: With the new coordinate system, the spacing between inventory slots is one-fourth the size of an inventory slot by default. Also see [Styling Formspecs] for changing the size of slots and spacing.</li>
</ul>
<h3><a class="anchor" id="autotoc_md887"></a>
&lt;tt&gt;listring[&lt;inventory location&gt;;&lt;list name&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Appends to an internal ring of inventory lists.</li>
<li>Shift-clicking on items in one element of the ring will send them to the next inventory list inside the ring</li>
<li>The first occurrence of an element inside the ring will determine the inventory where items will be sent to</li>
</ul>
<h3><a class="anchor" id="autotoc_md888"></a>
&lt;tt&gt;listring[]&lt;/tt&gt;</h3>
<ul>
<li>Shorthand for doing <code>listring[&lt;inventory location&gt;;&lt;list name&gt;]</code> for the last two inventory lists added by list[...]</li>
</ul>
<h3><a class="anchor" id="autotoc_md889"></a>
&lt;tt&gt;listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Sets background color of slots as <code>ColorString</code></li>
<li>Sets background color of slots on mouse hovering</li>
</ul>
<h3><a class="anchor" id="autotoc_md890"></a>
&lt;tt&gt;listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Sets background color of slots as <code>ColorString</code></li>
<li>Sets background color of slots on mouse hovering</li>
<li>Sets color of slots border</li>
</ul>
<h3><a class="anchor" id="autotoc_md891"></a>
&lt;tt&gt;listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;;&lt;tooltip_bgcolor&gt;;&lt;tooltip_fontcolor&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Sets background color of slots as <code>ColorString</code></li>
<li>Sets background color of slots on mouse hovering</li>
<li>Sets color of slots border</li>
<li>Sets default background color of tooltips</li>
<li>Sets default font color of tooltips</li>
</ul>
<h3><a class="anchor" id="autotoc_md892"></a>
&lt;tt&gt;tooltip[&lt;gui_element_name&gt;;&lt;tooltip_text&gt;;&lt;bgcolor&gt;;&lt;fontcolor&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Adds tooltip for an element</li>
<li><code>bgcolor</code> tooltip background color as <code>ColorString</code> (optional)</li>
<li><code>fontcolor</code> tooltip font color as <code>ColorString</code> (optional)</li>
</ul>
<h3><a class="anchor" id="autotoc_md893"></a>
&lt;tt&gt;tooltip[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;tooltip_text&gt;;&lt;bgcolor&gt;;&lt;fontcolor&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Adds tooltip for an area. Other tooltips will take priority when present.</li>
<li><code>bgcolor</code> tooltip background color as <code>ColorString</code> (optional)</li>
<li><code>fontcolor</code> tooltip font color as <code>ColorString</code> (optional)</li>
</ul>
<h3><a class="anchor" id="autotoc_md894"></a>
&lt;tt&gt;image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;middle&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show an image.</li>
<li><code>middle</code> (optional): Makes the image render in 9-sliced mode and defines the middle rect.<ul>
<li>Requires formspec version &gt;= 6.</li>
<li>See <code>background9[]</code> documentation for more information.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md895"></a>
&lt;tt&gt;animated_image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;texture name&gt;;&lt;frame count&gt;;&lt;frame duration&gt;;&lt;frame start&gt;;&lt;middle&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show an animated image. The image is drawn like a "vertical_frames" tile animation (See [Tile animation definition]), but uses a frame count/duration for simplicity</li>
<li><code>name</code>: Element name to send when an event occurs. The event value is the index of the current frame.</li>
<li><code>texture name</code>: The image to use.</li>
<li><code>frame count</code>: The number of frames animating the image.</li>
<li><code>frame duration</code>: Milliseconds between each frame. <code>0</code> means the frames don't advance.</li>
<li><code>frame start</code> (optional): The index of the frame to start on. Default <code>1</code>.</li>
<li><code>middle</code> (optional): Makes the image render in 9-sliced mode and defines the middle rect.<ul>
<li>Requires formspec version &gt;= 6.</li>
<li>See <code>background9[]</code> documentation for more information.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md896"></a>
&lt;tt&gt;model[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;mesh&gt;;&lt;textures&gt;;&lt;rotation X,Y&gt;;&lt;continuous&gt;;&lt;mouse control&gt;;&lt;frame loop range&gt;;&lt;animation speed&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a mesh model.</li>
<li><code>name</code>: Element name that can be used for styling</li>
<li><code>mesh</code>: The mesh model to use.</li>
<li><code>textures</code>: The mesh textures to use according to the mesh materials. Texture names must be separated by commas.</li>
<li><code>rotation {X,Y}</code> (<a class="el" href="classOptional.html">Optional</a>): Initial rotation of the camera. The axes are euler angles in degrees.</li>
<li><code>continuous</code> (<a class="el" href="classOptional.html">Optional</a>): Whether the rotation is continuous. Default <code>false</code>.</li>
<li><code>mouse control</code> (<a class="el" href="classOptional.html">Optional</a>): Whether the model can be controlled with the mouse. Default <code>true</code>.</li>
<li><code>frame loop range</code> (<a class="el" href="classOptional.html">Optional</a>): Range of the animation frames.<ul>
<li>Defaults to the full range of all available frames.</li>
<li>Syntax: <code>&lt;begin&gt;,&lt;end&gt;</code></li>
</ul>
</li>
<li><code>animation speed</code> (<a class="el" href="classOptional.html">Optional</a>): Sets the animation speed. Default 0 FPS.</li>
</ul>
<h3><a class="anchor" id="autotoc_md897"></a>
&lt;tt&gt;item_image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show an inventory image of registered item/node</li>
</ul>
<h3><a class="anchor" id="autotoc_md898"></a>
&lt;tt&gt;bgcolor[&lt;bgcolor&gt;;&lt;fullscreen&gt;;&lt;fbgcolor&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Sets background color of formspec.</li>
<li><code>bgcolor</code> and <code>fbgcolor</code> (optional) are <code>ColorString</code>s, they define the color of the non-fullscreen and the fullscreen background.</li>
<li><code>fullscreen</code> (optional) can be one of the following:<ul>
<li><code>false</code>: Only the non-fullscreen background color is drawn. (default)</li>
<li><code>true</code>: Only the fullscreen background color is drawn.</li>
<li><code>both</code>: The non-fullscreen and the fullscreen background color are drawn.</li>
<li><code>neither</code>: No background color is drawn.</li>
</ul>
</li>
<li>Note: Leave a parameter empty to not modify the value.</li>
<li>Note: <code>fbgcolor</code>, leaving parameters empty and values for <code>fullscreen</code> that are not bools are only available since formspec version 3.</li>
</ul>
<h3><a class="anchor" id="autotoc_md899"></a>
&lt;tt&gt;background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Example for formspec 8x4 in 16x resolution: image shall be sized 8 times 16px times 4 times 16px.</li>
</ul>
<h3><a class="anchor" id="autotoc_md900"></a>
&lt;tt&gt;background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;auto_clip&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Example for formspec 8x4 in 16x resolution: image shall be sized 8 times 16px times 4 times 16px</li>
<li>If <code>auto_clip</code> is <code>true</code>, the background is clipped to the formspec size (<code>x</code> and <code>y</code> are used as offset values, <code>w</code> and <code>h</code> are ignored)</li>
</ul>
<h3><a class="anchor" id="autotoc_md901"></a>
&lt;tt&gt;background9[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;auto_clip&gt;;&lt;middle&gt;]&lt;/tt&gt;</h3>
<ul>
<li>9-sliced background. See <a href="https://en.wikipedia.org/wiki/9-slice_scaling">https://en.wikipedia.org/wiki/9-slice_scaling</a></li>
<li>Middle is a rect which defines the middle of the 9-slice.<ul>
<li><code>x</code> - The middle will be x pixels from all sides.</li>
<li><code>x,y</code> - The middle will be x pixels from the horizontal and y from the vertical.</li>
<li><code>x,y,x2,y2</code> - The middle will start at x,y, and end at x2, y2. Negative x2 and y2 values will be added to the width and height of the texture, allowing it to be used as the distance from the far end.</li>
<li>All numbers in middle are integers.</li>
</ul>
</li>
<li>If <code>auto_clip</code> is <code>true</code>, the background is clipped to the formspec size (<code>x</code> and <code>y</code> are used as offset values, <code>w</code> and <code>h</code> are ignored)</li>
<li>Available since formspec version 2</li>
</ul>
<h3><a class="anchor" id="autotoc_md902"></a>
&lt;tt&gt;pwdfield[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Textual password style field; will be sent to server when a button is clicked</li>
<li>When enter is pressed in field, fields.key_enter_field will be sent with the name of this field.</li>
<li>With the old coordinate system, fields are a set height, but will be vertically centered on <code>H</code>. With the new coordinate system, <code>H</code> will modify the height.</li>
<li><code>name</code> is the name of the field as returned in fields to <code>on_receive_fields</code></li>
<li><code>label</code>, if not blank, will be text printed on the top left above the field</li>
<li>See <code>field_close_on_enter</code> to stop enter closing the formspec</li>
</ul>
<h3><a class="anchor" id="autotoc_md903"></a>
&lt;tt&gt;field[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Textual field; will be sent to server when a button is clicked</li>
<li>When enter is pressed in field, <code>fields.key_enter_field</code> will be sent with the name of this field.</li>
<li>With the old coordinate system, fields are a set height, but will be vertically centered on <code>H</code>. With the new coordinate system, <code>H</code> will modify the height.</li>
<li><code>name</code> is the name of the field as returned in fields to <code>on_receive_fields</code></li>
<li><code>label</code>, if not blank, will be text printed on the top left above the field</li>
<li><code>default</code> is the default value of the field<ul>
<li><code>default</code> may contain variable references such as <code>${text}</code> which will fill the value from the metadata value <code>text</code></li>
<li><b>Note</b>: no extra text or more than a single variable is supported ATM.</li>
</ul>
</li>
<li>See <code>field_close_on_enter</code> to stop enter closing the formspec</li>
</ul>
<h3><a class="anchor" id="autotoc_md904"></a>
&lt;tt&gt;field[&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]&lt;/tt&gt;</h3>
<ul>
<li>As above, but without position/size units</li>
<li>When enter is pressed in field, <code>fields.key_enter_field</code> will be sent with the name of this field.</li>
<li>Special field for creating simple forms, such as sign text input</li>
<li>Must be used without a <code>size[]</code> element</li>
<li>A "Proceed" button will be added automatically</li>
<li>See <code>field_close_on_enter</code> to stop enter closing the formspec</li>
</ul>
<h3><a class="anchor" id="autotoc_md905"></a>
&lt;tt&gt;field_close_on_enter[&lt;name&gt;;&lt;close_on_enter&gt;]&lt;/tt&gt;</h3>
<ul>
<li>&lt;name&gt; is the name of the field</li>
<li>if &lt;close_on_enter&gt; is false, pressing enter in the field will submit the form but not close it.</li>
<li>defaults to true when not specified (ie: no tag for a field)</li>
</ul>
<h3><a class="anchor" id="autotoc_md906"></a>
&lt;tt&gt;textarea[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Same as fields above, but with multi-line input</li>
<li>If the text overflows, a vertical scrollbar is added.</li>
<li>If the name is empty, the textarea is read-only and the background is not shown, which corresponds to a multi-line label.</li>
</ul>
<h3><a class="anchor" id="autotoc_md907"></a>
&lt;tt&gt;label[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>The label formspec element displays the text set in <code>label</code> at the specified position.</li>
<li><b>Note</b>: If the new coordinate system is enabled, labels are positioned from the center of the text, not the top.</li>
<li>The text is displayed directly without automatic line breaking, so label should not be used for big text chunks. Newlines can be used to make labels multiline.</li>
<li><b>Note</b>: With the new coordinate system, newlines are spaced with half a coordinate. With the old system, newlines are spaced 2/5 of an inventory slot.</li>
</ul>
<h3><a class="anchor" id="autotoc_md908"></a>
&lt;tt&gt;hypertext[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;text&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Displays a static formatted text with hyperlinks.</li>
<li><b>Note</b>: This element is currently unstable and subject to change.</li>
<li><code>x</code>, <code>y</code>, <code>w</code> and <code>h</code> work as per field</li>
<li><code>name</code> is the name of the field as returned in fields to <code>on_receive_fields</code> in case of action in text.</li>
<li><code>text</code> is the formatted text using <code>Markup Language</code> described below.</li>
</ul>
<h3><a class="anchor" id="autotoc_md909"></a>
&lt;tt&gt;vertlabel[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Textual label drawn vertically</li>
<li><code>label</code> is the text on the label</li>
<li><b>Note</b>: If the new coordinate system is enabled, vertlabels are positioned from the center of the text, not the left.</li>
</ul>
<h3><a class="anchor" id="autotoc_md910"></a>
&lt;tt&gt;button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Clickable button. When clicked, fields will be sent.</li>
<li>With the old coordinate system, buttons are a set height, but will be vertically centered on <code>H</code>. With the new coordinate system, <code>H</code> will modify the height.</li>
<li><code>label</code> is the text on the button</li>
</ul>
<h3><a class="anchor" id="autotoc_md911"></a>
&lt;tt&gt;image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li><code>texture name</code> is the filename of an image</li>
<li><b>Note</b>: Height is supported on both the old and new coordinate systems for image_buttons.</li>
</ul>
<h3><a class="anchor" id="autotoc_md912"></a>
&lt;tt&gt;image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;;&lt;noclip&gt;;&lt;drawborder&gt;;&lt;pressed texture name&gt;]&lt;/tt&gt;</h3>
<ul>
<li><code>texture name</code> is the filename of an image</li>
<li><code>noclip=true</code> means the image button doesn't need to be within specified formsize.</li>
<li><code>drawborder</code>: draw button border or not</li>
<li><code>pressed texture name</code> is the filename of an image on pressed state</li>
</ul>
<h3><a class="anchor" id="autotoc_md913"></a>
&lt;tt&gt;item_image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li><code>item name</code> is the registered name of an item/node</li>
<li><code>name</code> is non-optional and must be unique, or else tooltips are broken.</li>
<li>The item description will be used as the tooltip. This can be overridden with a tooltip element.</li>
</ul>
<h3><a class="anchor" id="autotoc_md914"></a>
&lt;tt&gt;button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>When clicked, fields will be sent and the form will quit.</li>
<li>Same as <code>button</code> in all other respects.</li>
</ul>
<h3><a class="anchor" id="autotoc_md915"></a>
&lt;tt&gt;image_button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]&lt;/tt&gt;</h3>
<ul>
<li>When clicked, fields will be sent and the form will quit.</li>
<li>Same as <code>image_button</code> in all other respects.</li>
</ul>
<h3><a class="anchor" id="autotoc_md916"></a>
&lt;tt&gt;textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Scrollable item list showing arbitrary text elements</li>
<li><code>name</code> fieldname sent to server on doubleclick value is current selected element.</li>
<li><code>listelements</code> can be prepended by #color in hexadecimal format RRGGBB (only).<ul>
<li>if you want a listelement to start with "#" write "##".</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md917"></a>
&lt;tt&gt;textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;;&lt;selected idx&gt;;&lt;transparent&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Scrollable itemlist showing arbitrary text elements</li>
<li><code>name</code> fieldname sent to server on doubleclick value is current selected element.</li>
<li><code>listelements</code> can be prepended by #RRGGBB (only) in hexadecimal format<ul>
<li>if you want a listelement to start with "#" write "##"</li>
</ul>
</li>
<li>Index to be selected within textlist</li>
<li><code>true</code>/<code>false</code>: draw transparent background</li>
<li>See also <code>minetest.explode_textlist_event</code> (main menu: <code>core.explode_textlist_event</code>).</li>
</ul>
<h3><a class="anchor" id="autotoc_md918"></a>
&lt;tt&gt;tabheader[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;caption 1&gt;,&lt;caption 2&gt;,...,&lt;caption n&gt;;&lt;current_tab&gt;;&lt;transparent&gt;;&lt;draw_border&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a tab**header** at specific position (ignores formsize)</li>
<li><code>X</code> and <code>Y</code>: position of the tabheader</li>
<li><em>Note</em>: Width and height are automatically chosen with this syntax</li>
<li><code>name</code> fieldname data is transferred to Lua</li>
<li><code>caption 1</code>...: name shown on top of tab</li>
<li><code>current_tab</code>: index of selected tab 1...</li>
<li><code>transparent</code> (optional): if true, tabs are semi-transparent</li>
<li><code>draw_border</code> (optional): if true, draw a thin line at tab base</li>
</ul>
<h3><a class="anchor" id="autotoc_md919"></a>
&lt;tt&gt;tabheader[&lt;X&gt;,&lt;Y&gt;;&lt;H&gt;;&lt;name&gt;;&lt;caption 1&gt;,&lt;caption 2&gt;,...,&lt;caption n&gt;;&lt;current_tab&gt;;&lt;transparent&gt;;&lt;draw_border&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a tab**header** at specific position (ignores formsize)</li>
<li><b>Important note</b>: This syntax for tabheaders can only be used with the new coordinate system.</li>
<li><code>X</code> and <code>Y</code>: position of the tabheader</li>
<li><code>H</code>: height of the tabheader. Width is automatically determined with this syntax.</li>
<li><code>name</code> fieldname data is transferred to Lua</li>
<li><code>caption 1</code>...: name shown on top of tab</li>
<li><code>current_tab</code>: index of selected tab 1...</li>
<li><code>transparent</code> (optional): show transparent</li>
<li><code>draw_border</code> (optional): draw border</li>
</ul>
<h3><a class="anchor" id="autotoc_md920"></a>
&lt;tt&gt;tabheader[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;caption 1&gt;,&lt;caption 2&gt;,...,&lt;caption n&gt;;&lt;current_tab&gt;;&lt;transparent&gt;;&lt;draw_border&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a tab**header** at specific position (ignores formsize)</li>
<li><b>Important note</b>: This syntax for tabheaders can only be used with the new coordinate system.</li>
<li><code>X</code> and <code>Y</code>: position of the tabheader</li>
<li><code>W</code> and <code>H</code>: width and height of the tabheader</li>
<li><code>name</code> fieldname data is transferred to Lua</li>
<li><code>caption 1</code>...: name shown on top of tab</li>
<li><code>current_tab</code>: index of selected tab 1...</li>
<li><code>transparent</code> (optional): show transparent</li>
<li><code>draw_border</code> (optional): draw border</li>
</ul>
<h3><a class="anchor" id="autotoc_md921"></a>
&lt;tt&gt;box[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;color&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Simple colored box</li>
<li><code>color</code> is color specified as a <code>ColorString</code>. If the alpha component is left blank, the box will be semitransparent. If the color is not specified, the box will use the options specified by its style. If the color is specified, all styling options will be ignored.</li>
</ul>
<h3><a class="anchor" id="autotoc_md922"></a>
&lt;tt&gt;dropdown[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;;&lt;name&gt;;&lt;item 1&gt;,&lt;item 2&gt;, ...,&lt;item n&gt;;&lt;selected idx&gt;;&lt;index event&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a dropdown field</li>
<li><b>Important note</b>: There are two different operation modes:<ol type="1">
<li>handle directly on change (only changed dropdown is submitted)</li>
<li>read the value on pressing a button (all dropdown values are available)</li>
</ol>
</li>
<li><code>X</code> and <code>Y</code>: position of the dropdown</li>
<li><code>W</code>: width of the dropdown. Height is automatically chosen with this syntax.</li>
<li>Fieldname data is transferred to Lua</li>
<li>Items to be shown in dropdown</li>
<li>Index of currently selected dropdown item</li>
<li><code>index event</code> (optional, allowed parameter since formspec version 4): Specifies the event field value for selected items.<ul>
<li><code>true</code>: Selected item index</li>
<li><code>false</code> (default): Selected item value</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md923"></a>
&lt;tt&gt;dropdown[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;item 1&gt;,&lt;item 2&gt;, ...,&lt;item n&gt;;&lt;selected idx&gt;;&lt;index event&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a dropdown field</li>
<li><b>Important note</b>: This syntax for dropdowns can only be used with the new coordinate system.</li>
<li><b>Important note</b>: There are two different operation modes:<ol type="1">
<li>handle directly on change (only changed dropdown is submitted)</li>
<li>read the value on pressing a button (all dropdown values are available)</li>
</ol>
</li>
<li><code>X</code> and <code>Y</code>: position of the dropdown</li>
<li><code>W</code> and <code>H</code>: width and height of the dropdown</li>
<li>Fieldname data is transferred to Lua</li>
<li>Items to be shown in dropdown</li>
<li>Index of currently selected dropdown item</li>
<li><code>index event</code> (optional, allowed parameter since formspec version 4): Specifies the event field value for selected items.<ul>
<li><code>true</code>: Selected item index</li>
<li><code>false</code> (default): Selected item value</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md924"></a>
&lt;tt&gt;checkbox[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;label&gt;;&lt;selected&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a checkbox</li>
<li><code>name</code> fieldname data is transferred to Lua</li>
<li><code>label</code> to be shown left of checkbox</li>
<li><code>selected</code> (optional): <code>true</code>/<code>false</code></li>
<li><b>Note</b>: If the new coordinate system is enabled, checkboxes are positioned from the center of the checkbox, not the top.</li>
</ul>
<h3><a class="anchor" id="autotoc_md925"></a>
&lt;tt&gt;scrollbar[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;orientation&gt;;&lt;name&gt;;&lt;value&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show a scrollbar using options defined by the previous <code>scrollbaroptions[]</code></li>
<li>There are two ways to use it:<ol type="1">
<li>handle the changed event (only changed scrollbar is available)</li>
<li>read the value on pressing a button (all scrollbars are available)</li>
</ol>
</li>
<li><code>orientation</code>: <code>vertical</code>/<code>horizontal</code>. Default horizontal.</li>
<li>Fieldname data is transferred to Lua</li>
<li><a class="el" href="unionValue.html">Value</a> of this trackbar is set to (<code>0</code>-<code>1000</code>) by default</li>
<li>See also <code>minetest.explode_scrollbar_event</code> (main menu: <code>core.explode_scrollbar_event</code>).</li>
</ul>
<h3><a class="anchor" id="autotoc_md926"></a>
&lt;tt&gt;scrollbaroptions[opt1;opt2;...]&lt;/tt&gt;</h3>
<ul>
<li>Sets options for all following <code>scrollbar[]</code> elements</li>
<li><code>min=&lt;int&gt;</code><ul>
<li>Sets scrollbar minimum value, defaults to <code>0</code>.</li>
</ul>
</li>
<li><code>max=&lt;int&gt;</code><ul>
<li>Sets scrollbar maximum value, defaults to <code>1000</code>. If the max is equal to the min, the scrollbar will be disabled.</li>
</ul>
</li>
<li><code>smallstep=&lt;int&gt;</code><ul>
<li>Sets scrollbar step value when the arrows are clicked or the mouse wheel is scrolled.</li>
<li>If this is set to a negative number, the value will be reset to <code>10</code>.</li>
</ul>
</li>
<li><code>largestep=&lt;int&gt;</code><ul>
<li>Sets scrollbar step value used by page up and page down.</li>
<li>If this is set to a negative number, the value will be reset to <code>100</code>.</li>
</ul>
</li>
<li><code>thumbsize=&lt;int&gt;</code><ul>
<li>Sets size of the thumb on the scrollbar. Size is calculated in the number of units the thumb spans out of the range of the scrollbar values.</li>
<li>Example: If a scrollbar has a <code>min</code> of 1 and a <code>max</code> of 100, a thumbsize of 10 would span a tenth of the scrollbar space.</li>
<li>If this is set to zero or less, the value will be reset to <code>1</code>.</li>
</ul>
</li>
<li><code>arrows=&lt;show/hide/default&gt;</code><ul>
<li>Whether to show the arrow buttons on the scrollbar. <code>default</code> hides the arrows when the scrollbar gets too small, but shows them otherwise.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md927"></a>
&lt;tt&gt;table[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;cell 1&gt;,&lt;cell 2&gt;,...,&lt;cell n&gt;;&lt;selected idx&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Show scrollable table using options defined by the previous <code>tableoptions[]</code></li>
<li>Displays cells as defined by the previous <code>tablecolumns[]</code></li>
<li><code>name</code>: fieldname sent to server on row select or doubleclick</li>
<li><code>cell 1</code>...<code>cell n</code>: cell contents given in row-major order</li>
<li><code>selected idx</code>: index of row to be selected within table (first row = <code>1</code>)</li>
<li>See also <code>minetest.explode_table_event</code> (main menu: <code>core.explode_table_event</code>).</li>
</ul>
<h3><a class="anchor" id="autotoc_md928"></a>
&lt;tt&gt;tableoptions[&lt;opt 1&gt;;&lt;opt 2&gt;;...]&lt;/tt&gt;</h3>
<ul>
<li>Sets options for <code>table[]</code></li>
<li><code>color=#RRGGBB</code><ul>
<li>default text color (<code>ColorString</code>), defaults to <code>#FFFFFF</code></li>
</ul>
</li>
<li><code>background=#RRGGBB</code><ul>
<li>table background color (<code>ColorString</code>), defaults to <code>#000000</code></li>
</ul>
</li>
<li><code>border=&lt;true/false&gt;</code><ul>
<li>should the table be drawn with a border? (default: <code>true</code>)</li>
</ul>
</li>
<li><code>highlight=#RRGGBB</code><ul>
<li>highlight background color (<code>ColorString</code>), defaults to <code>#466432</code></li>
</ul>
</li>
<li><code>highlight_text=#RRGGBB</code><ul>
<li>highlight text color (<code>ColorString</code>), defaults to <code>#FFFFFF</code></li>
</ul>
</li>
<li><code>opendepth=&lt;value&gt;</code><ul>
<li>all subtrees up to <code>depth &lt; value</code> are open (default value = <code>0</code>)</li>
<li>only useful when there is a column of type "tree"</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md929"></a>
&lt;tt&gt;tablecolumns[&lt;type 1&gt;,&lt;opt 1a&gt;,&lt;opt 1b&gt;,...;&lt;type 2&gt;,&lt;opt 2a&gt;,&lt;opt 2b&gt;;...]&lt;/tt&gt;</h3>
<ul>
<li>Sets columns for <code>table[]</code></li>
<li>Types: <code>text</code>, <code>image</code>, <code>color</code>, <code>indent</code>, <code>tree</code><ul>
<li><code>text</code>: show cell contents as text</li>
<li><code>image</code>: cell contents are an image index, use column options to define images.</li>
<li><code>color</code>: cell contents are a ColorString and define color of following cell.</li>
<li><code>indent</code>: cell contents are a number and define indentation of following cell.</li>
<li><code>tree</code>: same as indent, but user can open and close subtrees (treeview-like).</li>
</ul>
</li>
<li>Column options:<ul>
<li><code>align=&lt;value&gt;</code><ul>
<li>for <code>text</code> and <code>image</code>: content alignment within cells. Available values: <code>left</code> (default), <code>center</code>, <code>right</code>, <code>inline</code></li>
</ul>
</li>
<li><code>width=&lt;value&gt;</code><ul>
<li>for <code>text</code> and <code>image</code>: minimum width in em (default: <code>0</code>)</li>
<li>for <code>indent</code> and <code>tree</code>: indent width in em (default: <code>1.5</code>)</li>
</ul>
</li>
<li><code>padding=&lt;value&gt;</code>: padding left of the column, in em (default <code>0.5</code>). Exception: defaults to 0 for indent columns</li>
<li><code>tooltip=&lt;value&gt;</code>: tooltip text (default: empty)</li>
<li><code>image</code> column options:<ul>
<li><code>0=&lt;value&gt;</code> sets image for image index 0</li>
<li><code>1=&lt;value&gt;</code> sets image for image index 1</li>
<li><code>2=&lt;value&gt;</code> sets image for image index 2</li>
<li>and so on; defined indices need not be contiguous empty or non-numeric cells are treated as <code>0</code>.</li>
</ul>
</li>
<li><code>color</code> column options:<ul>
<li><code>span=&lt;value&gt;</code>: number of following columns to affect (default: infinite).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md930"></a>
&lt;tt&gt;style[&lt;selector 1&gt;,&lt;selector 2&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]&lt;/tt&gt;</h3>
<ul>
<li>Set the style for the element(s) matching <code>selector</code> by name.</li>
<li><code>selector</code> can be one of:<ul>
<li><code>&lt;name&gt;</code> - An element name. Includes <code>*</code>, which represents every element.</li>
<li><code>&lt;name&gt;:&lt;state&gt;</code> - An element name, a colon, and one or more states.</li>
</ul>
</li>
<li><code>state</code> is a list of states separated by the <code>+</code> character.<ul>
<li>If a state is provided, the style will only take effect when the element is in that state.</li>
<li>All provided states must be active for the style to apply.</li>
</ul>
</li>
<li>Note: this <b>must</b> be before the element is defined.</li>
<li>See [Styling Formspecs].</li>
</ul>
<h3><a class="anchor" id="autotoc_md931"></a>
&lt;tt&gt;style_type[&lt;selector 1&gt;,&lt;selector 2&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]&lt;/tt&gt;</h3>
<ul>
<li>Set the style for the element(s) matching <code>selector</code> by type.</li>
<li><code>selector</code> can be one of:<ul>
<li><code>&lt;type&gt;</code> - An element type. Includes <code>*</code>, which represents every element.</li>
<li><code>&lt;type&gt;:&lt;state&gt;</code> - An element type, a colon, and one or more states.</li>
</ul>
</li>
<li><code>state</code> is a list of states separated by the <code>+</code> character.<ul>
<li>If a state is provided, the style will only take effect when the element is in that state.</li>
<li>All provided states must be active for the style to apply.</li>
</ul>
</li>
<li>See [Styling Formspecs].</li>
</ul>
<h3><a class="anchor" id="autotoc_md932"></a>
&lt;tt&gt;set_focus[&lt;name&gt;;&lt;force&gt;]&lt;/tt&gt;</h3>
<ul>
<li>Sets the focus to the element with the same <code>name</code> parameter.</li>
<li><b>Note</b>: This element must be placed before the element it focuses.</li>
<li><code>force</code> (optional, default <code>false</code>): By default, focus is not applied for re-sent formspecs with the same name so that player-set focus is kept. <code>true</code> sets the focus to the specified element for every sent formspec.</li>
<li>The following elements have the ability to be focused:<ul>
<li>checkbox</li>
<li>button</li>
<li>button_exit</li>
<li>image_button</li>
<li>image_button_exit</li>
<li>item_image_button</li>
<li>table</li>
<li>textlist</li>
<li>dropdown</li>
<li>field</li>
<li>pwdfield</li>
<li>textarea</li>
<li>scrollbar</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md933"></a>
Migrating to Real Coordinates</h2>
<p>In the old system, positions included padding and spacing. Padding is a gap between the formspec window edges and content, and spacing is the gaps between items. For example, two <code>1x1</code> elements at <code>0,0</code> and <code>1,1</code> would have a spacing of <code>5/4</code> between them, and a padding of <code>3/8</code> from the formspec edge. It may be easiest to recreate old layouts in the new coordinate system from scratch.</p>
<p>To recreate an old layout with padding, you'll need to pass the positions and sizes through the following formula to re-introduce padding:</p>
<div class="fragment"><div class="line">pos = (oldpos + 1)*spacing + padding</div>
<div class="line">where</div>
<div class="line">    padding = 3/8</div>
<div class="line">    spacing = 5/4</div>
</div><!-- fragment --><p>You'll need to change the <code>size[]</code> tag like this:</p>
<div class="fragment"><div class="line">size = (oldsize-1)*spacing + padding*2 + 1</div>
</div><!-- fragment --><p>A few elements had random offsets in the old system. Here is a table which shows these offsets when migrating:</p>
<p>| Element | Position | Size | Notes |------&mdash;|---------&mdash;|------&mdash;|----&mdash; | box | +0.3, +0.1 | 0, -0.4 | | button | | | Buttons now support height, so set h = 2 * 15/13 * 0.35, and reposition if h ~= 15/13 * 0.35 before | list | | | Spacing is now 0.25 for both directions, meaning lists will be taller in height | label | 0, +0.3 | | The first line of text is now positioned centered exactly at the position specified</p>
<h2><a class="anchor" id="autotoc_md934"></a>
Styling Formspecs</h2>
<p>Formspec elements can be themed using the style elements: </p><pre class="fragment">style[&lt;name 1&gt;,&lt;name 2&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]
style[&lt;name 1&gt;:&lt;state&gt;,&lt;name 2&gt;:&lt;state&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]
style_type[&lt;type 1&gt;,&lt;type 2&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]
style_type[&lt;type 1&gt;:&lt;state&gt;,&lt;type 2&gt;:&lt;state&gt;,...;&lt;prop1&gt;;&lt;prop2&gt;;...]
</pre><p>Where a prop is: </p><pre class="fragment">property_name=property_value
</pre><p>For example: </p><pre class="fragment">style_type[button;bgcolor=#006699]
style[world_delete;bgcolor=red;textcolor=yellow]
button[4,3.95;2.6,1;world_delete;Delete]
</pre><p>A name/type can optionally be a comma separated list of names/types, like so: </p><pre class="fragment">world_delete,world_create,world_configure
button,image_button
</pre><p>A <code>*</code> type can be used to select every element in the formspec.</p>
<p>Any name/type in the list can also be accompanied by a <code>+</code>-separated list of states, like so: </p><pre class="fragment">world_delete:hovered+pressed
button:pressed
</pre><p>States allow you to apply styles in response to changes in the element, instead of applying at all times.</p>
<p>Setting a property to nothing will reset it to the default value. For example: </p><pre class="fragment">style_type[button;bgimg=button.png;bgimg_pressed=button_pressed.png;border=false]
style[btn_exit;bgimg=;bgimg_pressed=;border=;bgcolor=red]
</pre><h3><a class="anchor" id="autotoc_md935"></a>
Supported Element Types</h3>
<p>Some types may inherit styles from parent types.</p>
<ul>
<li>animated_image, inherits from image</li>
<li>box</li>
<li>button</li>
<li>button_exit, inherits from button</li>
<li>checkbox</li>
<li>dropdown</li>
<li>field</li>
<li>image</li>
<li>image_button</li>
<li>item_image_button</li>
<li>label</li>
<li>list</li>
<li>model</li>
<li>pwdfield, inherits from field</li>
<li>scrollbar</li>
<li>tabheader</li>
<li>table</li>
<li>textarea</li>
<li>textlist</li>
<li>vertlabel, inherits from label</li>
</ul>
<h3><a class="anchor" id="autotoc_md936"></a>
Valid Properties</h3>
<ul>
<li>animated_image<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
</ul>
</li>
<li>box<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.<ul>
<li>Defaults to false in formspec_version version 3 or higher</li>
</ul>
</li>
<li><b>Note</b>: <code>colors</code>, <code>bordercolors</code>, and <code>borderwidths</code> accept multiple input types:<ul>
<li>Single value (e.g. <code>#FF0</code>): All corners/borders.</li>
<li>Two values (e.g. <code>red,#FFAAFF</code>): top-left and bottom-right,top-right and bottom-left/ top and bottom,left and right.</li>
<li>Four values (e.g. <code>blue,#A0F,green,#FFFA</code>): top-left/top and rotates clockwise.</li>
<li>These work similarly to CSS borders.</li>
</ul>
</li>
<li>colors - <code>ColorString</code>. Sets the color(s) of the box corners. Default <code>black</code>.</li>
<li>bordercolors - <code>ColorString</code>. Sets the color(s) of the borders. Default <code>black</code>.</li>
<li>borderwidths - Integer. Sets the width(s) of the borders in pixels. If the width is negative, the border will extend inside the box, whereas positive extends outside the box. A width of zero results in no border; this is default.</li>
</ul>
</li>
<li>button, button_exit, image_button, item_image_button<ul>
<li>alpha - boolean, whether to draw alpha in bgimg. Default true.</li>
<li>bgcolor - color, sets button tint.</li>
<li>bgcolor_hovered - color when hovered. Defaults to a lighter bgcolor when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>bgcolor_pressed - color when pressed. Defaults to a darker bgcolor when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>bgimg - standard background image. Defaults to none.</li>
<li>bgimg_hovered - background image when hovered. Defaults to bgimg when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>bgimg_middle - Makes the bgimg textures render in 9-sliced mode and defines the middle rect. See background9[] documentation for more details. This property also pads the button's content when set.</li>
<li>bgimg_pressed - background image when pressed. Defaults to bgimg when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>font - Sets font type. This is a comma separated list of options. Valid options:<ul>
<li>Main font type options. These cannot be combined with each other:<ul>
<li><code>normal</code>: Default font</li>
<li><code>mono</code>: Monospaced font</li>
</ul>
</li>
<li>Font modification options. If used without a main font type, <code>normal</code> is used:<ul>
<li><code>bold</code>: Makes font bold.</li>
<li><code>italic</code>: Makes font italic. Default <code>normal</code>.</li>
</ul>
</li>
</ul>
</li>
<li>font_size - Sets font size. Default is user-set. Can have multiple values:<ul>
<li><code>&lt;number&gt;</code>: Sets absolute font size to <code>number</code>.</li>
<li><code>+&lt;number&gt;</code>/<code>-&lt;number&gt;</code>: Offsets default font size by <code>number</code> points.</li>
<li><code>*&lt;number&gt;</code>: Multiplies default font size by <code>number</code>, similar to CSS <code>em</code>.</li>
</ul>
</li>
<li>border - boolean, draw border. Set to false to hide the bevelled button pane. Default true.</li>
<li>content_offset - 2d vector, shifts the position of the button's content without resizing it.</li>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>padding - rect, adds space between the edges of the button and the content. This value is relative to bgimg_middle.</li>
<li>sound - a sound to be played when triggered.</li>
<li>textcolor - color, default white.</li>
</ul>
</li>
<li>checkbox<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>sound - a sound to be played when triggered.</li>
</ul>
</li>
<li>dropdown<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>sound - a sound to be played when the entry is changed.</li>
</ul>
</li>
<li>field, pwdfield, textarea<ul>
<li>border - set to false to hide the textbox background and border. Default true.</li>
<li>font - Sets font type. See button <code>font</code> property for more information.</li>
<li>font_size - Sets font size. See button <code>font_size</code> property for more information.</li>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>textcolor - color. Default white.</li>
</ul>
</li>
<li>model<ul>
<li>bgcolor - color, sets background color.</li>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.<ul>
<li>Default to false in formspec_version version 3 or higher</li>
</ul>
</li>
</ul>
</li>
<li>image<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.<ul>
<li>Default to false in formspec_version version 3 or higher</li>
</ul>
</li>
</ul>
</li>
<li>item_image<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds. Default to false.</li>
</ul>
</li>
<li>label, vertlabel<ul>
<li>font - Sets font type. See button <code>font</code> property for more information.</li>
<li>font_size - Sets font size. See button <code>font_size</code> property for more information.</li>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
</ul>
</li>
<li>list<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>size - 2d vector, sets the size of inventory slots in coordinates.</li>
<li>spacing - 2d vector, sets the space between inventory slots in coordinates.</li>
</ul>
</li>
<li>image_button (additional properties)<ul>
<li>fgimg - standard image. Defaults to none.</li>
<li>fgimg_hovered - image when hovered. Defaults to fgimg when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>fgimg_pressed - image when pressed. Defaults to fgimg when not provided.<ul>
<li>This is deprecated, use states instead.</li>
</ul>
</li>
<li>fgimg_middle - Makes the fgimg textures render in 9-sliced mode and defines the middle rect. See background9[] documentation for more details.</li>
<li>NOTE: The parameters of any given image_button will take precedence over fgimg/fgimg_pressed</li>
<li>sound - a sound to be played when triggered.</li>
</ul>
</li>
<li>scrollbar<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
</ul>
</li>
<li>tabheader<ul>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
<li>sound - a sound to be played when a different tab is selected.</li>
<li>textcolor - color. Default white.</li>
</ul>
</li>
<li>table, textlist<ul>
<li>font - Sets font type. See button <code>font</code> property for more information.</li>
<li>font_size - Sets font size. See button <code>font_size</code> property for more information.</li>
<li>noclip - boolean, set to true to allow the element to exceed formspec bounds.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md937"></a>
Valid States</h3>
<ul>
<li><em>all elements</em><ul>
<li>default - Equivalent to providing no states</li>
</ul>
</li>
<li>button, button_exit, image_button, item_image_button<ul>
<li>focused - Active when button has focus</li>
<li>hovered - Active when the mouse is hovering over the element</li>
<li>pressed - Active when the button is pressed</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md938"></a>
Markup Language</h2>
<p>Markup language used in <code>hypertext[]</code> elements uses tags that look like HTML tags. The markup language is currently unstable and subject to change. Use with caution. Some tags can enclose text, they open with <code>&lt;tagname&gt;</code> and close with <code>&lt;/tagname&gt;</code>. Tags can have attributes, in that case, attributes are in the opening tag in form of a key/value separated with equal signs. Attribute values should not be quoted.</p>
<p>If you want to insert a literal greater-than sign or a backslash into the text, you must escape it by preceding it with a backslash.</p>
<p>These are the technically basic tags but see below for usual tags. Base tags are:</p>
<p><code>&lt;style color=... font=... size=...&gt;...&lt;/style&gt;</code></p>
<p>Changes the style of the text.</p>
<ul>
<li><code>color</code>: Text color. Given color is a <code>colorspec</code>.</li>
<li><code>size</code>: Text size.</li>
<li><code>font</code>: Text font (<code>mono</code> or <code>normal</code>).</li>
</ul>
<p><code>&lt;global background=... margin=... valign=... color=... hovercolor=... size=... font=... halign=... &gt;</code></p>
<p>Sets global style.</p>
<p>Global only styles:</p><ul>
<li><code>background</code>: Text background, a <code>colorspec</code> or <code>none</code>.</li>
<li><code>margin</code>: Page margins in pixel.</li>
<li><code>valign</code>: Text vertical alignment (<code>top</code>, <code>middle</code>, <code>bottom</code>).</li>
</ul>
<p>Inheriting styles (affects child elements):</p><ul>
<li><code>color</code>: Default text color. Given color is a <code>colorspec</code>.</li>
<li><code>hovercolor</code>: Color of &lt;action&gt; tags when mouse is over.</li>
<li><code>size</code>: Default text size.</li>
<li><code>font</code>: Default text font (<code>mono</code> or <code>normal</code>).</li>
<li><code>halign</code>: Default text horizontal alignment (<code>left</code>, <code>right</code>, <code>center</code>, <code>justify</code>).</li>
</ul>
<p>This tag needs to be placed only once as it changes the global settings of the text. Anyway, if several tags are placed, each changed will be made in the order tags appear.</p>
<p><code>&lt;tag name=... color=... hovercolor=... font=... size=...&gt;</code></p>
<p>Defines or redefines tag style. This can be used to define new tags.</p><ul>
<li><code>name</code>: Name of the tag to define or change.</li>
<li><code>color</code>: Text color. Given color is a <code>colorspec</code>.</li>
<li><code>hovercolor</code>: Text color when element hovered (only for <code>action</code> tags). Given color is a <code>colorspec</code>.</li>
<li><code>size</code>: Text size.</li>
<li><code>font</code>: Text font (<code>mono</code> or <code>normal</code>).</li>
</ul>
<p>Following tags are the usual tags for text layout. They are defined by default. Other tags can be added using <code>&lt;tag ...&gt;</code> tag.</p>
<p><code>&lt;normal&gt;...&lt;/normal&gt;</code>: Normal size text</p>
<p><code>&lt;big&gt;...&lt;/big&gt;</code>: Big text</p>
<p><code>&lt;bigger&gt;...&lt;/bigger&gt;</code>: Bigger text</p>
<p><code>&lt;center&gt;...&lt;/center&gt;</code>: Centered text</p>
<p><code>&lt;left&gt;...&lt;/left&gt;</code>: Left-aligned text</p>
<p><code>&lt;right&gt;...&lt;/right&gt;</code>: Right-aligned text</p>
<p><code>&lt;justify&gt;...&lt;/justify&gt;</code>: Justified text</p>
<p><code>&lt;mono&gt;...&lt;/mono&gt;</code>: Monospaced font</p>
<p><code>&lt;b&gt;...&lt;/b&gt;</code>, <code>&lt;i&gt;...&lt;/i&gt;</code>, <code>&lt;u&gt;...&lt;/u&gt;</code>: Bold, italic, underline styles.</p>
<p><code>&lt;action name=...&gt;...&lt;/action&gt;</code></p>
<p>Make that text a clickable text triggering an action.</p>
<ul>
<li><code>name</code>: Name of the action (mandatory).</li>
</ul>
<p>When clicked, the formspec is send to the server. The value of the text field sent to <code>on_player_receive_fields</code> will be "action:" concatenated to the action name.</p>
<p><code>&lt;img name=... float=... width=... height=...&gt;</code></p>
<p>Draws an image which is present in the client media cache.</p>
<ul>
<li><code>name</code>: Name of the texture (mandatory).</li>
<li><code>float</code>: If present, makes the image floating (<code>left</code> or <code>right</code>).</li>
<li><code>width</code>: Force image width instead of taking texture width.</li>
<li><code>height</code>: Force image height instead of taking texture height.</li>
</ul>
<p>If only width or height given, texture aspect is kept.</p>
<p><code>&lt;item name=... float=... width=... height=... rotate=...&gt;</code></p>
<p>Draws an item image.</p>
<ul>
<li><code>name</code>: Item string of the item to draw (mandatory).</li>
<li><code>float</code>: If present, makes the image floating (<code>left</code> or <code>right</code>).</li>
<li><code>width</code>: Item image width.</li>
<li><code>height</code>: Item image height.</li>
<li><code>rotate</code>: Rotate item image if set to <code>yes</code> or <code>X,Y,Z</code>. X, Y and Z being rotation speeds in percent of standard speed (-1000 to 1000). Works only if <code>inventory_items_animations</code> is set to true.</li>
<li><code>angle</code>: Angle in which the item image is shown. <a class="el" href="unionValue.html">Value</a> has <code>X,Y,Z</code> form. X, Y and Z being angles around each three axes. Works only if <code>inventory_items_animations</code> is set to true.</li>
</ul>
<h1><a class="anchor" id="autotoc_md939"></a>
Inventory</h1>
<h2><a class="anchor" id="autotoc_md940"></a>
Inventory locations</h2>
<ul>
<li><code>"context"</code>: Selected node metadata (deprecated: <code>"current_name"</code>)</li>
<li><code>"current_player"</code>: <a class="el" href="classPlayer.html">Player</a> to whom the menu is shown</li>
<li><code>"player:&lt;name&gt;"</code>: Any player</li>
<li><code>"nodemeta:&lt;X&gt;,&lt;Y&gt;,&lt;Z&gt;"</code>: Any node metadata</li>
<li><code>"detached:&lt;name&gt;"</code>: A detached inventory</li>
</ul>
<h2><a class="anchor" id="autotoc_md941"></a>
Player Inventory lists</h2>
<ul>
<li><code>main</code>: list containing the default inventory</li>
<li><code>craft</code>: list containing the craft input</li>
<li><code>craftpreview</code>: list containing the craft prediction</li>
<li><code>craftresult</code>: list containing the crafted output</li>
<li><code>hand</code>: list containing an override for the empty hand<ul>
<li>Is not created automatically, use <code><a class="el" href="classInvRef.html">InvRef</a>:set_size</code></li>
<li>Is only used to enhance the empty hand's tool capabilities</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md942"></a>
Colors</h1>
<h2><a class="anchor" id="autotoc_md943"></a>
&lt;tt&gt;ColorString&lt;/tt&gt;</h2>
<p><code>#RGB</code> defines a color in hexadecimal format.</p>
<p><code>#RGBA</code> defines a color in hexadecimal format and alpha channel.</p>
<p><code>#RRGGBB</code> defines a color in hexadecimal format.</p>
<p><code>#RRGGBBAA</code> defines a color in hexadecimal format and alpha channel.</p>
<p>Named colors are also supported and are equivalent to <a href="https://www.w3.org/TR/css-color-4/#named-color">CSS Color Module Level 4</a>. To specify the value of the alpha channel, append <code>#A</code> or <code>#AA</code> to the end of the color name (e.g. <code>colorname#08</code>).</p>
<h2><a class="anchor" id="autotoc_md944"></a>
&lt;tt&gt;ColorSpec&lt;/tt&gt;</h2>
<p>A ColorSpec specifies a 32-bit color. It can be written in any of the following forms:</p>
<ul>
<li>table form: Each element ranging from 0..255 (a, if absent, defaults to 255):<ul>
<li><code>colorspec = {a=255, r=0, g=255, b=0}</code></li>
</ul>
</li>
<li>numerical form: The raw integer value of an ARGB8 quad:<ul>
<li><code>colorspec = 0xFF00FF00</code></li>
</ul>
</li>
<li>string form: A ColorString (defined above):<ul>
<li><code>colorspec = "green"</code></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md945"></a>
Escape sequences</h1>
<p>Most text can contain escape sequences, that can for example color the text. There are a few exceptions: tab headers, dropdowns and vertical labels can't. The following functions provide escape sequences:</p>
<ul>
<li><code>minetest.get_color_escape_sequence(color)</code>:<ul>
<li><code>color</code> is a ColorString</li>
<li>The escape sequence sets the text color to <code>color</code></li>
</ul>
</li>
<li><code>minetest.colorize(color, message)</code>:<ul>
<li>Equivalent to: `minetest.get_color_escape_sequence(color) .. message .. minetest.get_color_escape_sequence("#ffffff")<code> *</code>minetest.get_background_escape_sequence(color)<code> *</code>color` is a ColorString</li>
<li>The escape sequence sets the background of the whole text element to <code>color</code>. Only defined for item descriptions and tooltips.</li>
</ul>
</li>
<li><code>minetest.strip_foreground_colors(str)</code><ul>
<li>Removes foreground colors added by <code>get_color_escape_sequence</code>.</li>
</ul>
</li>
<li><code>minetest.strip_background_colors(str)</code><ul>
<li>Removes background colors added by <code>get_background_escape_sequence</code>.</li>
</ul>
</li>
<li><code>minetest.strip_colors(str)</code><ul>
<li>Removes all color escape sequences.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md946"></a>
Spatial Vectors</h1>
<p>Minetest stores 3-dimensional spatial vectors in Lua as tables of 3 coordinates, and has a class to represent them (<code>vector.*</code>), which this chapter is about. For details on what a spatial vectors is, please refer to Wikipedia: <a href="https://en.wikipedia.org/wiki/Euclidean_vector">https://en.wikipedia.org/wiki/Euclidean_vector</a>.</p>
<p>Spatial vectors are used for various things, including, but not limited to:</p>
<ul>
<li>any 3D spatial vector (x/y/z-directions)</li>
<li>Euler angles (pitch/yaw/roll in radians) (Spatial vectors have no real semantic meaning here. Therefore, most vector operations make no sense in this use case.)</li>
</ul>
<p>Note that they are <em>not</em> used for:</p>
<ul>
<li>n-dimensional vectors where n is not 3 (ie. n=2)</li>
<li>arrays of the form <code>{num, num, num}</code></li>
</ul>
<p>The API documentation may refer to spatial vectors, as produced by <code>vector.new</code>, by any of the following notations:</p>
<ul>
<li><code>(x, y, z)</code> (Used rarely, and only if it's clear that it's a vector.)</li>
<li><code>vector.new(x, y, z)</code></li>
<li><code>{x=num, y=num, z=num}</code> (Even here you are still supposed to use <code>vector.new</code>.)</li>
</ul>
<h2><a class="anchor" id="autotoc_md947"></a>
Compatibility notes</h2>
<p>Vectors used to be defined as tables of the form <code>{x = num, y = num, z = num}</code>. Since Minetest 5.5.0, vectors additionally have a metatable to enable easier use. Note: Those old-style vectors can still be found in old mod code. Hence, mod and engine APIs still need to be able to cope with them in many places.</p>
<p>Manually constructed tables are deprecated and highly discouraged. This interface should be used to ensure seamless compatibility between mods and the Minetest API. This is especially important to callback function parameters and functions overwritten by mods. Also, though not likely, the internal implementation of a vector might change in the future. In your own code, or if you define your own API, you can, of course, still use other representations of vectors.</p>
<p>Vectors provided by API functions will provide an instance of this class if not stated otherwise. Mods should adapt this for convenience reasons.</p>
<h2><a class="anchor" id="autotoc_md948"></a>
Special properties of the class</h2>
<p>Vectors can be indexed with numbers and allow method and operator syntax.</p>
<p>All these forms of addressing a vector <code>v</code> are valid: <code>v[1]</code>, <code>v[3]</code>, <code>v.x</code>, <code>v[1] = 42</code>, <code>v.y = 13</code> Note: Prefer letter over number indexing for performance and compatibility reasons.</p>
<p>Where <code>v</code> is a vector and <code>foo</code> stands for any function name, <code>v:foo(...)</code> does the same as <code>vector.foo(v, ...)</code>, apart from deprecated functionality.</p>
<p><code>tostring</code> is defined for vectors, see <code>vector.to_string</code>.</p>
<p>The metatable that is used for vectors can be accessed via <code>vector.metatable</code>. Do not modify it!</p>
<p>All <code>vector.*</code> functions allow vectors <code>{x = X, y = Y, z = Z}</code> without metatables. Returned vectors always have a metatable set.</p>
<h2><a class="anchor" id="autotoc_md949"></a>
Common functions and methods</h2>
<p>For the following functions (and subchapters), <code>v</code>, <code>v1</code>, <code>v2</code> are vectors, <code>p1</code>, <code>p2</code> are position vectors, <code>s</code> is a scalar (a number), vectors are written like this: <code>(x, y, z)</code>:</p>
<ul>
<li><code>vector.new([a[, b, c]])</code>:<ul>
<li>Returns a new vector <code>(a, b, c)</code>.</li>
<li>Deprecated: <code>vector.new()</code> does the same as <code>vector.zero()</code> and <code>vector.new(v)</code> does the same as <code>vector.copy(v)</code></li>
</ul>
</li>
<li><code>vector.zero()</code>:<ul>
<li>Returns a new vector <code>(0, 0, 0)</code>.</li>
</ul>
</li>
<li><code>vector.copy(v)</code>:<ul>
<li>Returns a copy of the vector <code>v</code>.</li>
</ul>
</li>
<li><code>vector.from_string(s[, init])</code>:<ul>
<li>Returns <code>v, np</code>, where <code>v</code> is a vector read from the given string <code>s</code> and <code>np</code> is the next position in the string after the vector.</li>
<li>Returns <code>nil</code> on failure.</li>
<li><code>s</code>: Has to begin with a substring of the form <code>"(x, y, z)"</code>. Additional spaces, leaving away commas and adding an additional comma to the end is allowed.</li>
<li><code>init</code>: If given starts looking for the vector at this string index.</li>
</ul>
</li>
<li><code>vector.to_string(v)</code>:<ul>
<li>Returns a string of the form <code>"(x, y, z)"</code>.</li>
<li><code>tostring(v)</code> does the same.</li>
</ul>
</li>
<li><code>vector.direction(p1, p2)</code>:<ul>
<li>Returns a vector of length 1 with direction <code>p1</code> to <code>p2</code>.</li>
<li>If <code>p1</code> and <code>p2</code> are identical, returns <code>(0, 0, 0)</code>.</li>
</ul>
</li>
<li><code>vector.distance(p1, p2)</code>:<ul>
<li>Returns zero or a positive number, the distance between <code>p1</code> and <code>p2</code>.</li>
</ul>
</li>
<li><code>vector.length(v)</code>:<ul>
<li>Returns zero or a positive number, the length of vector <code>v</code>.</li>
</ul>
</li>
<li><code>vector.normalize(v)</code>:<ul>
<li>Returns a vector of length 1 with direction of vector <code>v</code>.</li>
<li>If <code>v</code> has zero length, returns <code>(0, 0, 0)</code>.</li>
</ul>
</li>
<li><code>vector.floor(v)</code>:<ul>
<li>Returns a vector, each dimension rounded down.</li>
</ul>
</li>
<li><code>vector.round(v)</code>:<ul>
<li>Returns a vector, each dimension rounded to nearest integer.</li>
<li>At a multiple of 0.5, rounds away from zero.</li>
</ul>
</li>
<li><code>vector.apply(v, func)</code>:<ul>
<li>Returns a vector where the function <code>func</code> has been applied to each component.</li>
</ul>
</li>
<li><code>vector.combine(v, w, func)</code>:<ul>
<li>Returns a vector where the function <code>func</code> has combined both components of <code>v</code> and <code>w</code> for each component</li>
</ul>
</li>
<li><code>vector.equals(v1, v2)</code>:<ul>
<li>Returns a boolean, <code>true</code> if the vectors are identical.</li>
</ul>
</li>
<li><code>vector.sort(v1, v2)</code>:<ul>
<li>Returns in order minp, maxp vectors of the cuboid defined by <code>v1</code>, <code>v2</code>.</li>
</ul>
</li>
<li><code>vector.angle(v1, v2)</code>:<ul>
<li>Returns the angle between <code>v1</code> and <code>v2</code> in radians.</li>
</ul>
</li>
<li><code>vector.dot(v1, v2)</code>:<ul>
<li>Returns the dot product of <code>v1</code> and <code>v2</code>.</li>
</ul>
</li>
<li><code>vector.cross(v1, v2)</code>:<ul>
<li>Returns the cross product of <code>v1</code> and <code>v2</code>.</li>
</ul>
</li>
<li><code>vector.offset(v, x, y, z)</code>:<ul>
<li>Returns the sum of the vectors <code>v</code> and <code>(x, y, z)</code>.</li>
</ul>
</li>
<li><code>vector.check(v)</code>:<ul>
<li>Returns a boolean value indicating whether <code>v</code> is a real vector, eg. created by a <code>vector.*</code> function.</li>
<li>Returns <code>false</code> for anything else, including tables like <code>{x=3,y=1,z=4}</code>.</li>
</ul>
</li>
<li><code>vector.in_area(pos, min, max)</code>:<ul>
<li>Returns a boolean value indicating if <code>pos</code> is inside area formed by <code>min</code> and <code>max</code>.</li>
<li><code>min</code> and <code>max</code> are inclusive.</li>
<li>If <code>min</code> is bigger than <code>max</code> on some axis, function always returns false.</li>
<li>You can use <code>vector.sort</code> if you have two vectors and don't know which are the minimum and the maximum.</li>
</ul>
</li>
</ul>
<p>For the following functions <code>x</code> can be either a vector or a number:</p>
<ul>
<li><code>vector.add(v, x)</code>:<ul>
<li>Returns a vector.</li>
<li>If <code>x</code> is a vector: Returns the sum of <code>v</code> and <code>x</code>.</li>
<li>If <code>x</code> is a number: Adds <code>x</code> to each component of <code>v</code>.</li>
</ul>
</li>
<li><code>vector.subtract(v, x)</code>:<ul>
<li>Returns a vector.</li>
<li>If <code>x</code> is a vector: Returns the difference of <code>v</code> subtracted by <code>x</code>.</li>
<li>If <code>x</code> is a number: Subtracts <code>x</code> from each component of <code>v</code>.</li>
</ul>
</li>
<li><code>vector.multiply(v, s)</code>:<ul>
<li>Returns a scaled vector.</li>
<li>Deprecated: If <code>s</code> is a vector: Returns the Schur product.</li>
</ul>
</li>
<li><code>vector.divide(v, s)</code>:<ul>
<li>Returns a scaled vector.</li>
<li>Deprecated: If <code>s</code> is a vector: Returns the Schur quotient.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md950"></a>
Operators</h2>
<p>Operators can be used if all of the involved vectors have metatables:</p><ul>
<li><code>v1 == v2</code>:<ul>
<li>Returns whether <code>v1</code> and <code>v2</code> are identical.</li>
</ul>
</li>
<li><code>-v</code>:<ul>
<li>Returns the additive inverse of v.</li>
</ul>
</li>
<li><code>v1 + v2</code>:<ul>
<li>Returns the sum of both vectors.</li>
<li>Note: <code>+</code> cannot be used together with scalars.</li>
</ul>
</li>
<li><code>v1 - v2</code>:<ul>
<li>Returns the difference of <code>v1</code> subtracted by <code>v2</code>.</li>
<li>Note: <code>-</code> cannot be used together with scalars.</li>
</ul>
</li>
<li><code>v * s</code> or <code>s * v</code>:<ul>
<li>Returns <code>v</code> scaled by <code>s</code>.</li>
</ul>
</li>
<li><code>v / s</code>:<ul>
<li>Returns <code>v</code> scaled by <code>1 / s</code>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md951"></a>
Rotation-related functions</h2>
<p>For the following functions <code>a</code> is an angle in radians and <code>r</code> is a rotation vector (<code>{x = &lt;pitch&gt;, y = &lt;yaw&gt;, z = &lt;roll&gt;}</code>) where pitch, yaw and roll are angles in radians.</p>
<ul>
<li><code>vector.rotate(v, r)</code>:<ul>
<li>Applies the rotation <code>r</code> to <code>v</code> and returns the result.</li>
<li><code>vector.rotate(vector.new(0, 0, 1), r)</code> and <code>vector.rotate(vector.new(0, 1, 0), r)</code> return vectors pointing forward and up relative to an entity's rotation <code>r</code>.</li>
</ul>
</li>
<li><code>vector.rotate_around_axis(v1, v2, a)</code>:<ul>
<li>Returns <code>v1</code> rotated around axis <code>v2</code> by <code>a</code> radians according to the right hand rule.</li>
</ul>
</li>
<li><code>vector.dir_to_rotation(direction[, up])</code>:<ul>
<li>Returns a rotation vector for <code>direction</code> pointing forward using <code>up</code> as the up vector.</li>
<li>If <code>up</code> is omitted, the roll of the returned vector defaults to zero.</li>
<li>Otherwise <code>direction</code> and <code>up</code> need to be vectors in a 90 degree angle to each other.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md952"></a>
Further helpers</h2>
<p>There are more helper functions involving vectors, but they are listed elsewhere because they only work on specific sorts of vectors or involve things that are not vectors.</p>
<p>For example:</p>
<ul>
<li><code>minetest.hash_node_position</code> (Only works on node positions.)</li>
<li><code>minetest.dir_to_wallmounted</code> (Involves wallmounted param2 values.)</li>
</ul>
<h1><a class="anchor" id="autotoc_md953"></a>
Helper functions</h1>
<ul>
<li><code>dump2(obj, name, dumped)</code>: returns a string which makes <code>obj</code> human-readable, handles reference loops.<ul>
<li><code>obj</code>: arbitrary variable</li>
<li><code>name</code>: string, default: <code>"_"</code></li>
<li><code>dumped</code>: table, default: <code>{}</code></li>
</ul>
</li>
<li><code>dump(obj, dumped)</code>: returns a string which makes <code>obj</code> human-readable<ul>
<li><code>obj</code>: arbitrary variable</li>
<li><code>dumped</code>: table, default: <code>{}</code></li>
</ul>
</li>
<li><code>math.hypot(x, y)</code><ul>
<li>Get the hypotenuse of a triangle with legs x and y. Useful for distance calculation.</li>
</ul>
</li>
<li><code>math.sign(x, tolerance)</code>: returns <code>-1</code>, <code>0</code> or <code>1</code><ul>
<li>Get the sign of a number.</li>
<li>tolerance: number, default: <code>0.0</code></li>
<li>If the absolute value of <code>x</code> is within the <code>tolerance</code> or <code>x</code> is NaN, <code>0</code> is returned.</li>
</ul>
</li>
<li><code>math.factorial(x)</code>: returns the factorial of <code>x</code></li>
<li><code>math.round(x)</code>: Returns <code>x</code> rounded to the nearest integer.<ul>
<li>At a multiple of 0.5, rounds away from zero.</li>
</ul>
</li>
<li><code>string.split(str, separator, include_empty, max_splits, sep_is_pattern)</code><ul>
<li><code>separator</code>: string, cannot be empty, default: <code>","</code></li>
<li><code>include_empty</code>: boolean, default: <code>false</code></li>
<li><code>max_splits</code>: number, if it's negative, splits aren't limited, default: <code>-1</code></li>
<li><code>sep_is_pattern</code>: boolean, it specifies whether separator is a plain string or a pattern (regex), default: <code>false</code></li>
<li>e.g. <code>"a,b":split","</code> returns <code>{"a","b"}</code></li>
</ul>
</li>
<li><code>string:trim()</code>: returns the string without whitespace pre- and suffixes<ul>
<li>e.g. <code>"\n \t\tfoo bar\t ":trim()</code> returns <code>"foo bar"</code></li>
</ul>
</li>
<li><code>minetest.wrap_text(str, limit, as_table)</code>: returns a string or table<ul>
<li>Adds newlines to the string to keep it within the specified character limit</li>
<li>Note that the returned lines may be longer than the limit since it only splits at word borders.</li>
<li><code>limit</code>: number, maximal amount of characters in one line</li>
<li><code>as_table</code>: boolean, if set to true, a table of lines instead of a string is returned, default: <code>false</code></li>
</ul>
</li>
<li><code>minetest.pos_to_string(pos, decimal_places)</code>: returns string <code>"(X,Y,Z)"</code><ul>
<li><code>pos</code>: table {x=X, y=Y, z=Z}</li>
<li>Converts the position <code>pos</code> to a human-readable, printable string</li>
<li><code>decimal_places</code>: number, if specified, the x, y and z values of the position are rounded to the given decimal place.</li>
</ul>
</li>
<li><code>minetest.string_to_pos(string)</code>: returns a position or <code>nil</code><ul>
<li>Same but in reverse.</li>
<li>If the string can't be parsed to a position, nothing is returned.</li>
</ul>
</li>
<li><code>minetest.string_to_area("(X1, Y1, Z1) (X2, Y2, Z2)", relative_to)</code>:<ul>
<li>returns two positions</li>
<li>Converts a string representing an area box into two positions</li>
<li>X1, Y1, ... Z2 are coordinates</li>
<li><code>relative_to</code>: <a class="el" href="classOptional.html">Optional</a>. If set to a position, each coordinate can use the tilde notation for relative positions</li>
<li>Tilde notation: "~": Relative coordinate "~&lt;number&gt;": Relative coordinate plus &lt;number&gt;</li>
<li>Example: <code>minetest.string_to_area("(1,2,3) (~5,~-5,~)", {x=10,y=10,z=10})</code> returns <code>{x=1,y=2,z=3}, {x=15,y=5,z=10}</code></li>
</ul>
</li>
<li><code>minetest.formspec_escape(string)</code>: returns a string<ul>
<li>escapes the characters "[", "]", "\", "," and ";", which cannot be used in formspecs.</li>
</ul>
</li>
<li><code>minetest.is_yes(arg)</code><ul>
<li>returns true if passed 'y', 'yes', 'true' or a number that isn't zero.</li>
</ul>
</li>
<li><code>minetest.is_nan(arg)</code><ul>
<li>returns true when the passed number represents NaN.</li>
</ul>
</li>
<li><code>minetest.get_us_time()</code><ul>
<li>returns time with microsecond precision. May not return wall time.</li>
</ul>
</li>
<li><code>table.copy(table)</code>: returns a table<ul>
<li>returns a deep copy of <code>table</code></li>
</ul>
</li>
<li><code>table.indexof(list, val)</code>: returns the smallest numerical index containing the value <code>val</code> in the table <code>list</code>. Non-numerical indices are ignored. If <code>val</code> could not be found, <code>-1</code> is returned. <code>list</code> must not have negative indices.</li>
<li><code>table.insert_all(table, other_table)</code>:<ul>
<li>Appends all values in <code>other_table</code> to <code>table</code> - uses <code>#table + 1</code> to find new indices.</li>
</ul>
</li>
<li><code>table.key_value_swap(t)</code>: returns a table with keys and values swapped<ul>
<li>If multiple keys in <code>t</code> map to the same value, it is unspecified which value maps to that key.</li>
</ul>
</li>
<li><code>table.shuffle(table, [from], [to], [random_func])</code>:<ul>
<li>Shuffles elements <code>from</code> to <code>to</code> in <code>table</code> in place</li>
<li><code>from</code> defaults to <code>1</code></li>
<li><code>to</code> defaults to <code>#table</code></li>
<li><code>random_func</code> defaults to <code>math.random</code>. This function receives two integers as arguments and should return a random integer inclusively between them.</li>
</ul>
</li>
<li><code>minetest.pointed_thing_to_face_pos(placer, pointed_thing)</code>: returns a position.<ul>
<li>returns the exact position on the surface of a pointed node</li>
</ul>
</li>
<li><code>minetest.get_tool_wear_after_use(uses [, initial_wear])</code><ul>
<li>Simulates a tool being used once and returns the added wear, such that, if only this function is used to calculate wear, the tool will break exactly after <code>uses</code> times of uses</li>
<li><code>uses</code>: Number of times the tool can be used</li>
<li><code>initial_wear</code>: The initial wear the tool starts with (default: 0)</li>
</ul>
</li>
<li><code>minetest.get_dig_params(groups, tool_capabilities [, wear])</code>: Simulates an item that digs a node. Returns a table with the following fields:<ul>
<li><code>diggable</code>: <code>true</code> if node can be dug, <code>false</code> otherwise.</li>
<li><code>time</code>: Time it would take to dig the node.</li>
<li><code>wear</code>: How much wear would be added to the tool (ignored for non-tools). <code>time</code> and <code>wear</code> are meaningless if node's not diggable Parameters:</li>
<li><code>groups</code>: <a class="el" href="structTable.html">Table</a> of the node groups of the node that would be dug</li>
<li><code>tool_capabilities</code>: Tool capabilities table of the item</li>
<li><code>wear</code>: Amount of wear the tool starts with (default: 0)</li>
</ul>
</li>
<li><code>minetest.get_hit_params(groups, tool_capabilities [, time_from_last_punch [, wear]])</code>: Simulates an item that punches an object. Returns a table with the following fields:<ul>
<li><code>hp</code>: How much damage the punch would cause (between -65535 and 65535).</li>
<li><code>wear</code>: How much wear would be added to the tool (ignored for non-tools). Parameters:</li>
<li><code>groups</code>: Damage groups of the object</li>
<li><code>tool_capabilities</code>: Tool capabilities table of the item</li>
<li><code>time_from_last_punch</code>: time in seconds since last punch action</li>
<li><code>wear</code>: Amount of wear the item starts with (default: 0)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md954"></a>
Translations</h1>
<p>Texts can be translated client-side with the help of <code>minetest.translate</code> and translation files.</p>
<p>Consider using the tool <a href="https://github.com/minetest-tools/update_translations">update_translations</a> to generate and update translation files automatically from the Lua source.</p>
<h2><a class="anchor" id="autotoc_md955"></a>
Translating a string</h2>
<p>Two functions are provided to translate strings: <code>minetest.translate</code> and <code>minetest.get_translator</code>.</p>
<ul>
<li><code>minetest.get_translator(textdomain)</code> is a simple wrapper around <code>minetest.translate</code>, and <code>minetest.get_translator(textdomain)(str, ...)</code> is equivalent to <code>minetest.translate(textdomain, str, ...)</code>. It is intended to be used in the following way, so that it avoids verbose repetitions of <code>minetest.translate</code>:</li>
</ul>
<div class="fragment"><div class="line">local S = minetest.get_translator(textdomain)</div>
<div class="line">S(str, ...)</div>
</div><!-- fragment --><p>As an extra commodity, if <code>textdomain</code> is nil, it is assumed to be "" instead.</p>
<ul>
<li><p class="startli"><code>minetest.translate(textdomain, str, ...)</code> translates the string <code>str</code> with the given <code>textdomain</code> for disambiguation. The textdomain must match the textdomain specified in the translation file in order to get the string translated. This can be used so that a string is translated differently in different contexts. It is advised to use the name of the mod as textdomain whenever possible, to avoid clashes with other mods. This function must be given a number of arguments equal to the number of arguments the translated string expects. Arguments are literal strings &ndash; they will not be translated, so if you want them to be, they need to come as outputs of <code>minetest.translate</code> as well.</p>
<p class="startli">For instance, suppose we want to translate "@1 Wool" with "@1" being replaced by the translation of "Red". We can do the following:</p>
</li>
</ul>
<div class="fragment"><div class="line">local S = minetest.get_translator()</div>
<div class="line">S(&quot;@1 Wool&quot;, S(&quot;Red&quot;))</div>
</div><!-- fragment --><p>This will be displayed as "Red Wool" on old clients and on clients that do not have localization enabled. However, if we have for instance a translation file named <code>wool.fr.tr</code> containing the following: </p><pre class="fragment">@1 Wool=Laine @1
Red=Rouge
</pre><p>this will be displayed as "Laine Rouge" on clients with a French locale.</p>
<h2><a class="anchor" id="autotoc_md956"></a>
Operations on translated strings</h2>
<p>The output of <code>minetest.translate</code> is a string, with escape sequences adding additional information to that string so that it can be translated on the different clients. In particular, you can't expect operations like string.length to work on them like you would expect them to, or string.gsub to work in the expected manner. However, string concatenation will still work as expected (note that you should only use this for things like formspecs; do not translate sentences by breaking them into parts; arguments should be used instead), and operations such as <code>minetest.colorize</code> which are also concatenation.</p>
<h2><a class="anchor" id="autotoc_md957"></a>
Translation file format</h2>
<p>A translation file has the suffix <code>.[lang].tr</code>, where <code>[lang]</code> is the language it corresponds to. It must be put into the <code>locale</code> subdirectory of the mod. The file should be a text file, with the following format:</p>
<ul>
<li>Lines beginning with <code># textdomain:</code> (the space is significant) can be used to specify the text domain of all following translations in the file.</li>
<li>All other empty lines or lines beginning with <code>#</code> are ignored.</li>
<li>Other lines should be in the format <code>original=translated</code>. Both <code>original</code> and <code>translated</code> can contain escape sequences beginning with <code>@</code> to insert arguments, literal <code>@</code>, <code>=</code> or newline (See [Escapes] below). There must be no extraneous whitespace around the <code>=</code> or at the beginning or the end of the line.</li>
</ul>
<h2><a class="anchor" id="autotoc_md958"></a>
Escapes</h2>
<p>Strings that need to be translated can contain several escapes, preceded by <code>@</code>.</p>
<ul>
<li><code>@@</code> acts as a literal <code>@</code>.</li>
<li><code>@n</code>, where <code>n</code> is a digit between 1 and 9, is an argument for the translated string that will be inlined when translated. Due to how translations are implemented, the original translation string <b>must</b> have its arguments in increasing order, without gaps or repetitions, starting from 1.</li>
<li><code>@=</code> acts as a literal <code>=</code>. It is not required in strings given to <code>minetest.translate</code>, but is in translation files to avoid being confused with the <code>=</code> separating the original from the translation.</li>
<li><code>@\n</code> (where the <code>\n</code> is a literal newline) acts as a literal newline. As with <code>@=</code>, this escape is not required in strings given to <code>minetest.translate</code>, but is in translation files.</li>
<li><code>@n</code> acts as a literal newline as well.</li>
</ul>
<h2><a class="anchor" id="autotoc_md959"></a>
Server side translations</h2>
<p>On some specific cases, server translation could be useful. For example, filter a list on labels and send results to client. A method is supplied to achieve that:</p>
<p><code>minetest.get_translated_string(lang_code, string)</code>: Translates <code>string</code> using translations for <code>lang_code</code> language. It gives the same result as if the string was translated by the client.</p>
<p>The <code>lang_code</code> to use for a given player can be retrieved from the table returned by <code>minetest.get_player_information(name)</code>.</p>
<p>IMPORTANT: This functionality should only be used for sorting, filtering or similar purposes. You do not need to use this to get translated strings to show up on the client.</p>
<h1><a class="anchor" id="autotoc_md960"></a>
Perlin noise</h1>
<p>Perlin noise creates a continuously-varying value depending on the input values. Usually in Minetest the input values are either 2D or 3D co-ordinates in nodes. The result is used during map generation to create the terrain shape, vary heat and humidity to distribute biomes, vary the density of decorations or vary the structure of ores.</p>
<h2><a class="anchor" id="autotoc_md961"></a>
Structure of perlin noise</h2>
<p>An 'octave' is a simple noise generator that outputs a value between -1 and 1. The smooth wavy noise it generates has a single characteristic scale, almost like a 'wavelength', so on its own does not create fine detail. Due to this perlin noise combines several octaves to create variation on multiple scales. Each additional octave has a smaller 'wavelength' than the previous.</p>
<p>This combination results in noise varying very roughly between -2.0 and 2.0 and with an average value of 0.0, so <code>scale</code> and <code>offset</code> are then used to multiply and offset the noise variation.</p>
<p>The final perlin noise variation is created as follows:</p>
<p>noise = offset + scale * (octave1 + octave2 * persistence + octave3 * persistence ^ 2 + octave4 * persistence ^ 3 + ...)</p>
<h2><a class="anchor" id="autotoc_md962"></a>
Noise Parameters</h2>
<p><a class="el" href="classNoise.html">Noise</a> Parameters are commonly called <code><a class="el" href="structNoiseParams.html">NoiseParams</a></code>.</p>
<h3><a class="anchor" id="autotoc_md963"></a>
&lt;tt&gt;offset&lt;/tt&gt;</h3>
<p>After the multiplication by <code>scale</code> this is added to the result and is the final step in creating the noise value. Can be positive or negative.</p>
<h3><a class="anchor" id="autotoc_md964"></a>
&lt;tt&gt;scale&lt;/tt&gt;</h3>
<p>Once all octaves have been combined, the result is multiplied by this. Can be positive or negative.</p>
<h3><a class="anchor" id="autotoc_md965"></a>
&lt;tt&gt;spread&lt;/tt&gt;</h3>
<p>For octave1, this is roughly the change of input value needed for a very large variation in the noise value generated by octave1. It is almost like a 'wavelength' for the wavy noise variation. Each additional octave has a 'wavelength' that is smaller than the previous octave, to create finer detail. <code>spread</code> will therefore roughly be the typical size of the largest structures in the final noise variation.</p>
<p><code>spread</code> is a vector with values for x, y, z to allow the noise variation to be stretched or compressed in the desired axes. Values are positive numbers.</p>
<h3><a class="anchor" id="autotoc_md966"></a>
&lt;tt&gt;seed&lt;/tt&gt;</h3>
<p>This is a whole number that determines the entire pattern of the noise variation. Altering it enables different noise patterns to be created. With other parameters equal, different seeds produce different noise patterns and identical seeds produce identical noise patterns.</p>
<p>For this parameter you can randomly choose any whole number. Usually it is preferable for this to be different from other seeds, but sometimes it is useful to be able to create identical noise patterns.</p>
<p>In some noise APIs the world seed is added to the seed specified in noise parameters. This is done to make the resulting noise pattern vary in different worlds, and be 'world-specific'.</p>
<h3><a class="anchor" id="autotoc_md967"></a>
&lt;tt&gt;octaves&lt;/tt&gt;</h3>
<p>The number of simple noise generators that are combined. A whole number, 1 or more. Each additional octave adds finer detail to the noise but also increases the noise calculation load. 3 is a typical minimum for a high quality, complex and natural-looking noise variation. 1 octave has a slight 'gridlike' appearance.</p>
<p>Choose the number of octaves according to the <code>spread</code> and <code>lacunarity</code>, and the size of the finest detail you require. For example: if <code>spread</code> is 512 nodes, <code>lacunarity</code> is 2.0 and finest detail required is 16 nodes, octaves will be 6 because the 'wavelengths' of the octaves will be 512, 256, 128, 64, 32, 16 nodes. Warning: If the 'wavelength' of any octave falls below 1 an error will occur.</p>
<h3><a class="anchor" id="autotoc_md968"></a>
&lt;tt&gt;persistence&lt;/tt&gt;</h3>
<p>Each additional octave has an amplitude that is the amplitude of the previous octave multiplied by <code>persistence</code>, to reduce the amplitude of finer details, as is often helpful and natural to do so. Since this controls the balance of fine detail to large-scale detail <code>persistence</code> can be thought of as the 'roughness' of the noise.</p>
<p>A positive or negative non-zero number, often between 0.3 and 1.0. A common medium value is 0.5, such that each octave has half the amplitude of the previous octave. This may need to be tuned when altering <code>lacunarity</code>; when doing so consider that a common medium value is 1 / lacunarity.</p>
<h3><a class="anchor" id="autotoc_md969"></a>
&lt;tt&gt;lacunarity&lt;/tt&gt;</h3>
<p>Each additional octave has a 'wavelength' that is the 'wavelength' of the previous octave multiplied by 1 / lacunarity, to create finer detail. 'lacunarity' is often 2.0 so 'wavelength' often halves per octave.</p>
<p>A positive number no smaller than 1.0. Values below 2.0 create higher quality noise at the expense of requiring more octaves to cover a particular range of 'wavelengths'.</p>
<h3><a class="anchor" id="autotoc_md970"></a>
&lt;tt&gt;flags&lt;/tt&gt;</h3>
<p>Leave this field unset for no special handling. Currently supported are <code>defaults</code>, <code>eased</code> and <code>absvalue</code>:</p>
<h4><a class="anchor" id="autotoc_md971"></a>
&lt;tt&gt;defaults&lt;/tt&gt;</h4>
<p>Specify this if you would like to keep auto-selection of eased/not-eased while specifying some other flags.</p>
<h4><a class="anchor" id="autotoc_md972"></a>
&lt;tt&gt;eased&lt;/tt&gt;</h4>
<p>Maps noise gradient values onto a quintic S-curve before performing interpolation. This results in smooth, rolling noise. Disable this (<code>noeased</code>) for sharp-looking noise with a slightly gridded appearance. If no flags are specified (or defaults is), 2D noise is eased and 3D noise is not eased. Easing a 3D noise significantly increases the noise calculation load, so use with restraint.</p>
<h4><a class="anchor" id="autotoc_md973"></a>
&lt;tt&gt;absvalue&lt;/tt&gt;</h4>
<p>The absolute value of each octave's noise variation is used when combining the octaves. The final perlin noise variation is created as follows:</p>
<p>noise = offset + scale * (abs(octave1) + abs(octave2) * persistence + abs(octave3) * persistence ^ 2 + abs(octave4) * persistence ^ 3 + ...)</p>
<h3><a class="anchor" id="autotoc_md974"></a>
Format example</h3>
<p>For 2D or 3D perlin noise or perlin noise maps:</p>
<div class="fragment"><div class="line">np_terrain = {</div>
<div class="line">    offset = 0,</div>
<div class="line">    scale = 1,</div>
<div class="line">    spread = {x = 500, y = 500, z = 500},</div>
<div class="line">    seed = 571347,</div>
<div class="line">    octaves = 5,</div>
<div class="line">    persistence = 0.63,</div>
<div class="line">    lacunarity = 2.0,</div>
<div class="line">    flags = &quot;defaults, absvalue&quot;,</div>
<div class="line">}</div>
</div><!-- fragment --><p>For 2D noise the Z component of <code>spread</code> is still defined but is ignored. A single noise parameter table can be used for 2D or 3D noise.</p>
<h1><a class="anchor" id="autotoc_md975"></a>
Ores</h1>
<h2><a class="anchor" id="autotoc_md976"></a>
Ore types</h2>
<p>These tell in what manner the ore is generated.</p>
<p>All default ores are of the uniformly-distributed scatter type.</p>
<h3><a class="anchor" id="autotoc_md977"></a>
&lt;tt&gt;scatter&lt;/tt&gt;</h3>
<p>Randomly chooses a location and generates a cluster of ore.</p>
<p>If <code>noise_params</code> is specified, the ore will be placed if the 3D perlin noise at that point is greater than the <code>noise_threshold</code>, giving the ability to create a non-equal distribution of ore.</p>
<h3><a class="anchor" id="autotoc_md978"></a>
&lt;tt&gt;sheet&lt;/tt&gt;</h3>
<p>Creates a sheet of ore in a blob shape according to the 2D perlin noise described by <code>noise_params</code> and <code>noise_threshold</code>. This is essentially an improved version of the so-called "stratus" ore seen in some unofficial mods.</p>
<p>This sheet consists of vertical columns of uniform randomly distributed height, varying between the inclusive range <code>column_height_min</code> and <code>column_height_max</code>. If <code>column_height_min</code> is not specified, this parameter defaults to 1. If <code>column_height_max</code> is not specified, this parameter defaults to <code>clust_size</code> for reverse compatibility. New code should prefer <code>column_height_max</code>.</p>
<p>The <code>column_midpoint_factor</code> parameter controls the position of the column at which ore emanates from. If 1, columns grow upward. If 0, columns grow downward. If 0.5, columns grow equally starting from each direction. <code>column_midpoint_factor</code> is a decimal number ranging in value from 0 to 1. If this parameter is not specified, the default is 0.5.</p>
<p>The ore parameters <code>clust_scarcity</code> and <code>clust_num_ores</code> are ignored for this ore type.</p>
<h3><a class="anchor" id="autotoc_md979"></a>
&lt;tt&gt;puff&lt;/tt&gt;</h3>
<p>Creates a sheet of ore in a cloud-like puff shape.</p>
<p>As with the <code>sheet</code> ore type, the size and shape of puffs are described by <code>noise_params</code> and <code>noise_threshold</code> and are placed at random vertical positions within the currently generated chunk.</p>
<p>The vertical top and bottom displacement of each puff are determined by the noise parameters <code>np_puff_top</code> and <code>np_puff_bottom</code>, respectively.</p>
<h3><a class="anchor" id="autotoc_md980"></a>
&lt;tt&gt;blob&lt;/tt&gt;</h3>
<p>Creates a deformed sphere of ore according to 3d perlin noise described by <code>noise_params</code>. The maximum size of the blob is <code>clust_size</code>, and <code>clust_scarcity</code> has the same meaning as with the <code>scatter</code> type.</p>
<h3><a class="anchor" id="autotoc_md981"></a>
&lt;tt&gt;vein&lt;/tt&gt;</h3>
<p>Creates veins of ore varying in density by according to the intersection of two instances of 3d perlin noise with different seeds, both described by <code>noise_params</code>.</p>
<p><code>random_factor</code> varies the influence random chance has on placement of an ore inside the vein, which is <code>1</code> by default. Note that modifying this parameter may require adjusting <code>noise_threshold</code>.</p>
<p>The parameters <code>clust_scarcity</code>, <code>clust_num_ores</code>, and <code>clust_size</code> are ignored by this ore type.</p>
<p>This ore type is difficult to control since it is sensitive to small changes. The following is a decent set of parameters to work from:</p>
<div class="fragment"><div class="line">noise_params = {</div>
<div class="line">    offset  = 0,</div>
<div class="line">    scale   = 3,</div>
<div class="line">    spread  = {x=200, y=200, z=200},</div>
<div class="line">    seed    = 5390,</div>
<div class="line">    octaves = 4,</div>
<div class="line">    persistence = 0.5,</div>
<div class="line">    lacunarity = 2.0,</div>
<div class="line">    flags = &quot;eased&quot;,</div>
<div class="line">},</div>
<div class="line">noise_threshold = 1.6</div>
</div><!-- fragment --><p><b>WARNING</b>: Use this ore type <em>very</em> sparingly since it is ~200x more computationally expensive than any other ore.</p>
<h3><a class="anchor" id="autotoc_md982"></a>
&lt;tt&gt;stratum&lt;/tt&gt;</h3>
<p>Creates a single undulating ore stratum that is continuous across mapchunk borders and horizontally spans the world.</p>
<p>The 2D perlin noise described by <code>noise_params</code> defines the Y co-ordinate of the stratum midpoint. The 2D perlin noise described by <code>np_stratum_thickness</code> defines the stratum's vertical thickness (in units of nodes). Due to being continuous across mapchunk borders the stratum's vertical thickness is unlimited.</p>
<p>If the noise parameter <code>noise_params</code> is omitted the ore will occur from y_min to y_max in a simple horizontal stratum.</p>
<p>A parameter <code>stratum_thickness</code> can be provided instead of the noise parameter <code>np_stratum_thickness</code>, to create a constant thickness.</p>
<p>Leaving out one or both noise parameters makes the ore generation less intensive, useful when adding multiple strata.</p>
<p><code>y_min</code> and <code>y_max</code> define the limits of the ore generation and for performance reasons should be set as close together as possible but without clipping the stratum's Y variation.</p>
<p>Each node in the stratum has a 1-in-<code>clust_scarcity</code> chance of being ore, so a solid-ore stratum would require a <code>clust_scarcity</code> of 1.</p>
<p>The parameters <code>clust_num_ores</code>, <code>clust_size</code>, <code>noise_threshold</code> and <code>random_factor</code> are ignored by this ore type.</p>
<h2><a class="anchor" id="autotoc_md983"></a>
Ore attributes</h2>
<p>See section [Flag Specifier Format].</p>
<p>Currently supported flags: <code>puff_cliffs</code>, <code>puff_additive_composition</code>.</p>
<h3><a class="anchor" id="autotoc_md984"></a>
&lt;tt&gt;puff_cliffs&lt;/tt&gt;</h3>
<p>If set, puff ore generation will not taper down large differences in displacement when approaching the edge of a puff. This flag has no effect for ore types other than <code>puff</code>.</p>
<h3><a class="anchor" id="autotoc_md985"></a>
&lt;tt&gt;puff_additive_composition&lt;/tt&gt;</h3>
<p>By default, when noise described by <code>np_puff_top</code> or <code>np_puff_bottom</code> results in a negative displacement, the sub-column at that point is not generated. With this attribute set, puff ore generation will instead generate the absolute difference in noise displacement values. This flag has no effect for ore types other than <code>puff</code>.</p>
<h1><a class="anchor" id="autotoc_md986"></a>
Decoration types</h1>
<p>The varying types of decorations that can be placed.</p>
<h2><a class="anchor" id="autotoc_md987"></a>
&lt;tt&gt;simple&lt;/tt&gt;</h2>
<p>Creates a 1 times <code>H</code> times 1 column of a specified node (or a random node from a list, if a decoration list is specified). Can specify a certain node it must spawn next to, such as water or lava, for example. Can also generate a decoration of random height between a specified lower and upper bound. This type of decoration is intended for placement of grass, flowers, cacti, papyri, waterlilies and so on.</p>
<h2><a class="anchor" id="autotoc_md988"></a>
&lt;tt&gt;schematic&lt;/tt&gt;</h2>
<p>Copies a box of <code>MapNodes</code> from a specified schematic file (or raw description). Can specify a probability of a node randomly appearing when placed. This decoration type is intended to be used for multi-node sized discrete structures, such as trees, cave spikes, rocks, and so on.</p>
<h1><a class="anchor" id="autotoc_md989"></a>
Schematics</h1>
<h2><a class="anchor" id="autotoc_md990"></a>
Schematic specifier</h2>
<p>A schematic specifier identifies a schematic by either a filename to a Minetest <a class="el" href="classSchematic.html">Schematic</a> file (<code>.mts</code>) or through raw data supplied through Lua, in the form of a table. This table specifies the following fields:</p>
<ul>
<li>The <code>size</code> field is a 3D vector containing the dimensions of the provided schematic. (required field)</li>
<li>The <code>yslice_prob</code> field is a table of {ypos, prob} slice tables. A slice table sets the probability of a particular horizontal slice of the schematic being placed. (optional field) <code>ypos</code> = 0 for the lowest horizontal slice of a schematic. The default of <code>prob</code> is 255.</li>
<li>The <code>data</code> field is a flat table of <a class="el" href="structMapNode.html">MapNode</a> tables making up the schematic, in the order of <code>[z [y [x]]]</code>. (required field) Each <a class="el" href="structMapNode.html">MapNode</a> table contains:<ul>
<li><code>name</code>: the name of the map node to place (required)</li>
<li><code>prob</code> (alias <code>param1</code>): the probability of this node being placed (default: 255)</li>
<li><code>param2</code>: the raw param2 value of the node being placed onto the map (default: 0)</li>
<li><code>force_place</code>: boolean representing if the node should forcibly overwrite any previous contents (default: false)</li>
</ul>
</li>
</ul>
<p>About probability values:</p>
<ul>
<li>A probability value of <code>0</code> or <code>1</code> means that node will never appear (0% chance).</li>
<li>A probability value of <code>254</code> or <code>255</code> means the node will always appear (100% chance).</li>
<li>If the probability value <code>p</code> is greater than <code>1</code>, then there is a <code>(p / 256 * 100)</code> percent chance that node will appear when the schematic is placed on the map.</li>
</ul>
<h2><a class="anchor" id="autotoc_md991"></a>
Schematic attributes</h2>
<p>See section [Flag Specifier Format].</p>
<p>Currently supported flags: <code>place_center_x</code>, <code>place_center_y</code>, <code>place_center_z</code>, <code>force_placement</code>.</p>
<ul>
<li><code>place_center_x</code>: Placement of this decoration is centered along the X axis.</li>
<li><code>place_center_y</code>: Placement of this decoration is centered along the Y axis.</li>
<li><code>place_center_z</code>: Placement of this decoration is centered along the Z axis.</li>
<li><code>force_placement</code>: <a class="el" href="classSchematic.html">Schematic</a> nodes other than "ignore" will replace existing nodes.</li>
</ul>
<h1><a class="anchor" id="autotoc_md992"></a>
Lua Voxel Manipulator</h1>
<h2><a class="anchor" id="autotoc_md993"></a>
About VoxelManip</h2>
<p>VoxelManip is a scripting interface to the internal '<a class="el" href="classMap.html">Map</a> Voxel Manipulator' facility. The purpose of this object is for fast, low-level, bulk access to reading and writing <a class="el" href="classMap.html">Map</a> content. As such, setting map nodes through VoxelManip will lack many of the higher level features and concepts you may be used to with other methods of setting nodes. For example, nodes will not have their construction and destruction callbacks run, and no rollback information is logged.</p>
<p>It is important to note that VoxelManip is designed for speed, and <em>not</em> ease of use or flexibility. If your mod requires a map manipulation facility that will handle 100% of all edge cases, or the use of high level node placement features, perhaps <code>minetest.set_node()</code> is better suited for the job.</p>
<p>In addition, VoxelManip might not be faster, or could even be slower, for your specific use case. VoxelManip is most effective when setting large areas of map at once - for example, if only setting a 3x3x3 node area, a <code>minetest.set_node()</code> loop may be more optimal. Always profile code using both methods of map manipulation to determine which is most appropriate for your usage.</p>
<p>A recent simple test of setting cubic areas showed that <code>minetest.set_node()</code> is faster than a VoxelManip for a 3x3x3 node cube or smaller.</p>
<h2><a class="anchor" id="autotoc_md994"></a>
Using VoxelManip</h2>
<p>A VoxelManip object can be created any time using either: <code>VoxelManip([p1, p2])</code>, or <code>minetest.get_voxel_manip([p1, p2])</code>.</p>
<p>If the optional position parameters are present for either of these routines, the specified region will be pre-loaded into the VoxelManip object on creation. Otherwise, the area of map you wish to manipulate must first be loaded into the VoxelManip object using <code>VoxelManip:read_from_map()</code>.</p>
<p>Note that <code>VoxelManip:read_from_map()</code> returns two position vectors. The region formed by these positions indicate the minimum and maximum (respectively) positions of the area actually loaded in the VoxelManip, which may be larger than the area requested. For convenience, the loaded area coordinates can also be queried any time after loading map data with <code>VoxelManip:get_emerged_area()</code>.</p>
<p>Now that the VoxelManip object is populated with map data, your mod can fetch a copy of this data using either of two methods. <code>VoxelManip:get_node_at()</code>, which retrieves an individual node in a <a class="el" href="structMapNode.html">MapNode</a> formatted table at the position requested is the simplest method to use, but also the slowest.</p>
<p>Nodes in a VoxelManip object may also be read in bulk to a flat array table using:</p>
<ul>
<li><code>VoxelManip:get_data()</code> for node content (in Content ID form, see section [Content IDs]),</li>
<li><code>VoxelManip:get_light_data()</code> for node light levels, and</li>
<li><code>VoxelManip:get_param2_data()</code> for the node type-dependent "param2" values.</li>
</ul>
<p>See section [Flat array format] for more details.</p>
<p>It is very important to understand that the tables returned by any of the above three functions represent a snapshot of the VoxelManip's internal state at the time of the call. This copy of the data will not magically update itself if another function modifies the internal VoxelManip state. Any functions that modify a VoxelManip's contents work on the VoxelManip's internal state unless otherwise explicitly stated.</p>
<p>Once the bulk data has been edited to your liking, the internal VoxelManip state can be set using:</p>
<ul>
<li><code>VoxelManip:set_data()</code> for node content (in Content ID form, see section [Content IDs]),</li>
<li><code>VoxelManip:set_light_data()</code> for node light levels, and</li>
<li><code>VoxelManip:set_param2_data()</code> for the node type-dependent <code>param2</code> values.</li>
</ul>
<p>The parameter to each of the above three functions can use any table at all in the same flat array format as produced by <code>get_data()</code> etc. and is not required to be a table retrieved from <code>get_data()</code>.</p>
<p>Once the internal VoxelManip state has been modified to your liking, the changes can be committed back to the map by calling <code>VoxelManip:write_to_map()</code></p>
<h3><a class="anchor" id="autotoc_md995"></a>
Flat array format</h3>
<p>Let <code>Nx = p2.X - p1.X + 1</code>, <code>Ny = p2.Y - p1.Y + 1</code>, and <code>Nz = p2.Z - p1.Z + 1</code>.</p>
<p>Then, for a loaded region of p1..p2, this array ranges from <code>1</code> up to and including the value of the expression <code>Nx * Ny * Nz</code>.</p>
<p>Positions offset from p1 are present in the array with the format of: </p><pre class="fragment">[
    (0, 0, 0),   (1, 0, 0),   (2, 0, 0),   ... (Nx, 0, 0),
    (0, 1, 0),   (1, 1, 0),   (2, 1, 0),   ... (Nx, 1, 0),
    ...
    (0, Ny, 0),  (1, Ny, 0),  (2, Ny, 0),  ... (Nx, Ny, 0),
    (0, 0, 1),   (1, 0, 1),   (2, 0, 1),   ... (Nx, 0, 1),
    ...
    (0, Ny, 2),  (1, Ny, 2),  (2, Ny, 2),  ... (Nx, Ny, 2),
    ...
    (0, Ny, Nz), (1, Ny, Nz), (2, Ny, Nz), ... (Nx, Ny, Nz)
]
</pre><p>and the array index for a position p contained completely in p1..p2 is:</p>
<p><code>(p.Z - p1.Z) * Ny * Nx + (p.Y - p1.Y) * Nx + (p.X - p1.X) + 1</code></p>
<p>Note that this is the same "flat 3D array" format as <code>PerlinNoiseMap:get3dMap_flat()</code>. <a class="el" href="classVoxelArea.html">VoxelArea</a> objects (see section [<code><a class="el" href="classVoxelArea.html">VoxelArea</a></code>]) can be used to simplify calculation of the index for a single point in a flat VoxelManip array.</p>
<h3><a class="anchor" id="autotoc_md996"></a>
Content IDs</h3>
<p>A Content ID is a unique integer identifier for a specific node type. These IDs are used by VoxelManip in place of the node name string for <code>VoxelManip:get_data()</code> and <code>VoxelManip:set_data()</code>. You can use <code>minetest.get_content_id()</code> to look up the Content ID for the specified node name, and <code>minetest.get_name_from_content_id()</code> to look up the node name string for a given Content ID. After registration of a node, its Content ID will remain the same throughout execution of the mod. Note that the node being queried needs to have already been been registered.</p>
<p>The following builtin node types have their Content IDs defined as constants:</p>
<ul>
<li><code>minetest.CONTENT_UNKNOWN</code>: ID for "unknown" nodes</li>
<li><code>minetest.CONTENT_AIR</code>: ID for "air" nodes</li>
<li><code>minetest.CONTENT_IGNORE</code>: ID for "ignore" nodes</li>
</ul>
<h3><a class="anchor" id="autotoc_md997"></a>
Mapgen VoxelManip objects</h3>
<p>Inside of <code>on_generated()</code> callbacks, it is possible to retrieve the same VoxelManip object used by the core's <a class="el" href="classMap.html">Map</a> Generator (commonly abbreviated <a class="el" href="classMapgen.html">Mapgen</a>). Most of the rules previously described still apply but with a few differences:</p>
<ul>
<li>The <a class="el" href="classMapgen.html">Mapgen</a> VoxelManip object is retrieved using: <code>minetest.get_mapgen_object("voxelmanip")</code></li>
<li>This VoxelManip object already has the region of map just generated loaded into it; it's not necessary to call <code>VoxelManip:read_from_map()</code>. Note that the region of map it has loaded is NOT THE SAME as the <code>minp</code>, <code>maxp</code> parameters of <code>on_generated()</code>. Refer to <code>minetest.get_mapgen_object</code> docs.</li>
<li>The <code>on_generated()</code> callbacks of some mods may place individual nodes in the generated area using non-VoxelManip map modification methods. Because the same <a class="el" href="classMapgen.html">Mapgen</a> VoxelManip object is passed through each <code>on_generated()</code> callback, it becomes necessary for the <a class="el" href="classMapgen.html">Mapgen</a> VoxelManip object to maintain consistency with the current map state. For this reason, calling any of <code>minetest.add_node()</code>, <code>minetest.set_node()</code> or <code>minetest.swap_node()</code> will also update the <a class="el" href="classMapgen.html">Mapgen</a> VoxelManip object's internal state active on the current thread.</li>
<li>After modifying the <a class="el" href="classMapgen.html">Mapgen</a> VoxelManip object's internal buffer, it may be necessary to update lighting information using either: <code>VoxelManip:calc_lighting()</code> or <code>VoxelManip:set_lighting()</code>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md998"></a>
Other API functions operating on a VoxelManip</h3>
<p>If any VoxelManip contents were set to a liquid node (<code>liquidtype ~= "none"</code>), <code>VoxelManip:update_liquids()</code> must be called for these liquid nodes to begin flowing. It is recommended to call this function only after having written all buffered data back to the VoxelManip object, save for special situations where the modder desires to only have certain liquid nodes begin flowing.</p>
<p>The functions <code>minetest.generate_ores()</code> and <code>minetest.generate_decorations()</code> will generate all registered decorations and ores throughout the full area inside of the specified VoxelManip object.</p>
<p><code>minetest.place_schematic_on_vmanip()</code> is otherwise identical to <code>minetest.place_schematic()</code>, except instead of placing the specified schematic directly on the map at the specified position, it will place the schematic inside the VoxelManip.</p>
<h3><a class="anchor" id="autotoc_md999"></a>
Notes</h3>
<ul>
<li>Attempting to read data from a VoxelManip object before map is read will result in a zero-length array table for <code>VoxelManip:get_data()</code>, and an "ignore" node at any position for <code>VoxelManip:get_node_at()</code>.</li>
<li>If either a region of map has not yet been generated or is out-of-bounds of the map, that region is filled with "ignore" nodes.</li>
<li>Other mods, or the core itself, could possibly modify the area of map currently loaded into a VoxelManip object. With the exception of <a class="el" href="classMapgen.html">Mapgen</a> VoxelManips (see above section), the internal buffers are not updated. For this reason, it is strongly encouraged to complete the usage of a particular VoxelManip object in the same callback it had been created.</li>
<li>If a VoxelManip object will be used often, such as in an <code>on_generated()</code> callback, consider passing a file-scoped table as the optional parameter to <code>VoxelManip:get_data()</code>, which serves as a static buffer the function can use to write map data to instead of returning a new table each call. This greatly enhances performance by avoiding unnecessary memory allocations.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1000"></a>
Methods</h2>
<ul>
<li><code>read_from_map(p1, p2)</code>: Loads a chunk of map into the VoxelManip object containing the region formed by <code>p1</code> and <code>p2</code>.<ul>
<li>returns actual emerged <code>pmin</code>, actual emerged <code>pmax</code></li>
</ul>
</li>
<li><code>write_to_map([light])</code>: Writes the data loaded from the <code>VoxelManip</code> back to the map.<ul>
<li><b>important</b>: data must be set using <code>VoxelManip:set_data()</code> before calling this.</li>
<li>if <code>light</code> is true, then lighting is automatically recalculated. The default value is true. If <code>light</code> is false, no light calculations happen, and you should correct all modified blocks with <code>minetest.fix_light()</code> as soon as possible. Keep in mind that modifying the map where light is incorrect can cause more lighting bugs.</li>
</ul>
</li>
<li><code>get_node_at(pos)</code>: Returns a <code><a class="el" href="structMapNode.html">MapNode</a></code> table of the node currently loaded in the <code>VoxelManip</code> at that position</li>
<li><code>set_node_at(pos, node)</code>: Sets a specific <code><a class="el" href="structMapNode.html">MapNode</a></code> in the <code>VoxelManip</code> at that position.</li>
<li><code>get_data([buffer])</code>: Retrieves the node content data loaded into the <code>VoxelManip</code> object.<ul>
<li>returns raw node data in the form of an array of node content IDs</li>
<li>if the param <code>buffer</code> is present, this table will be used to store the result instead.</li>
</ul>
</li>
<li><code>set_data(data)</code>: Sets the data contents of the <code>VoxelManip</code> object</li>
<li><code>update_map()</code>: Does nothing, kept for compatibility.</li>
<li><code>set_lighting(light, [p1, p2])</code>: Set the lighting within the <code>VoxelManip</code> to a uniform value.<ul>
<li><code>light</code> is a table, <code>{day=&lt;0...15&gt;, night=&lt;0...15&gt;}</code></li>
<li>To be used only by a <code>VoxelManip</code> object from <code>minetest.get_mapgen_object</code>.</li>
<li>(<code>p1</code>, <code>p2</code>) is the area in which lighting is set, defaults to the whole area if left out.</li>
</ul>
</li>
<li><code>get_light_data([buffer])</code>: Gets the light data read into the <code>VoxelManip</code> object<ul>
<li>Returns an array (indices 1 to volume) of integers ranging from <code>0</code> to <code>255</code>.</li>
<li>Each value is the bitwise combination of day and night light values (<code>0</code> to <code>15</code> each).</li>
<li><code>light = day + (night * 16)</code></li>
<li>If the param <code>buffer</code> is present, this table will be used to store the result instead.</li>
</ul>
</li>
<li><code>set_light_data(light_data)</code>: Sets the <code>param1</code> (light) contents of each node in the <code>VoxelManip</code>.<ul>
<li>expects lighting data in the same format that <code>get_light_data()</code> returns</li>
</ul>
</li>
<li><code>get_param2_data([buffer])</code>: Gets the raw <code>param2</code> data read into the <code>VoxelManip</code> object.<ul>
<li>Returns an array (indices 1 to volume) of integers ranging from <code>0</code> to <code>255</code>.</li>
<li>If the param <code>buffer</code> is present, this table will be used to store the result instead.</li>
</ul>
</li>
<li><code>set_param2_data(param2_data)</code>: Sets the <code>param2</code> contents of each node in the <code>VoxelManip</code>.</li>
<li><code>calc_lighting([p1, p2], [propagate_shadow])</code>: Calculate lighting within the <code>VoxelManip</code>.<ul>
<li>To be used only by a <code>VoxelManip</code> object from <code>minetest.get_mapgen_object</code>.</li>
<li>(<code>p1</code>, <code>p2</code>) is the area in which lighting is set, defaults to the whole area if left out or nil. For almost all uses these should be left out or nil to use the default.</li>
<li><code>propagate_shadow</code> is an optional boolean deciding whether shadows in a generated mapchunk above are propagated down into the mapchunk, defaults to <code>true</code> if left out.</li>
</ul>
</li>
<li><code>update_liquids()</code>: Update liquid flow</li>
<li><code>was_modified()</code>: Returns <code>true</code> or <code>false</code> if the data in the voxel manipulator had been modified since the last read from map, due to a call to <code>minetest.set_data()</code> on the loaded area elsewhere.</li>
<li><code>get_emerged_area()</code>: Returns actual emerged minimum and maximum positions.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1001"></a>
&lt;tt&gt;VoxelArea&lt;/tt&gt;</h2>
<p>A helper class for voxel areas. It can be created via <code><a class="el" href="classVoxelArea.html">VoxelArea(pmin, pmax)</a></code> or <code><a class="el" href="classVoxelArea.html">VoxelArea</a>:new({MinEdge = pmin, MaxEdge = pmax})</code>. The coordinates are <em>inclusive</em>, like most other things in Minetest.</p>
<h3><a class="anchor" id="autotoc_md1002"></a>
Methods</h3>
<ul>
<li><code>getExtent()</code>: returns a 3D vector containing the size of the area formed by <code>MinEdge</code> and <code>MaxEdge</code>.</li>
<li><code>getVolume()</code>: returns the volume of the area formed by <code>MinEdge</code> and <code>MaxEdge</code>.</li>
<li><code>index(x, y, z)</code>: returns the index of an absolute position in a flat array starting at <code>1</code>.<ul>
<li><code>x</code>, <code>y</code> and <code>z</code> must be integers to avoid an incorrect index result.</li>
<li>The position (x, y, z) is not checked for being inside the area volume, being outside can cause an incorrect index result.</li>
<li>Useful for things like <code>VoxelManip</code>, raw <a class="el" href="classSchematic.html">Schematic</a> specifiers, <code>PerlinNoiseMap:get2d</code>/<code>3dMap</code>, and so on.</li>
</ul>
</li>
<li><code>indexp(p)</code>: same functionality as <code>index(x, y, z)</code> but takes a vector.<ul>
<li>As with <code>index(x, y, z)</code>, the components of <code>p</code> must be integers, and <code>p</code> is not checked for being inside the area volume.</li>
</ul>
</li>
<li><code>position(i)</code>: returns the absolute position vector corresponding to index <code>i</code>.</li>
<li><code>contains(x, y, z)</code>: check if (<code>x</code>,<code>y</code>,<code>z</code>) is inside area formed by <code>MinEdge</code> and <code>MaxEdge</code>.</li>
<li><code>containsp(p)</code>: same as above, except takes a vector</li>
<li><code>containsi(i)</code>: same as above, except takes an index <code>i</code></li>
<li><code>iter(minx, miny, minz, maxx, maxy, maxz)</code>: returns an iterator that returns indices.<ul>
<li>from (<code>minx</code>,<code>miny</code>,<code>minz</code>) to (<code>maxx</code>,<code>maxy</code>,<code>maxz</code>) in the order of <code>[z [y [x]]]</code>.</li>
</ul>
</li>
<li><code>iterp(minp, maxp)</code>: same as above, except takes a vector</li>
</ul>
<h3><a class="anchor" id="autotoc_md1003"></a>
Y stride and z stride of a flat array</h3>
<p>For a particular position in a voxel area, whose flat array index is known, it is often useful to know the index of a neighboring or nearby position. The table below shows the changes of index required for 1 node movements along the axes in a voxel area: </p><pre class="fragment">Movement    Change of index
+x          +1
-x          -1
+y          +ystride
-y          -ystride
+z          +zstride
-z          -zstride
</pre><p>If, for example: </p><pre class="fragment">local area = VoxelArea(emin, emax)
</pre><p>The values of <code>ystride</code> and <code>zstride</code> can be obtained using <code>area.ystride</code> and <code>area.zstride</code>.</p>
<h1><a class="anchor" id="autotoc_md1004"></a>
Mapgen objects</h1>
<p>A mapgen object is a construct used in map generation. <a class="el" href="classMapgen.html">Mapgen</a> objects can be used by an <code>on_generate</code> callback to speed up operations by avoiding unnecessary recalculations, these can be retrieved using the <code>minetest.get_mapgen_object()</code> function. If the requested <a class="el" href="classMapgen.html">Mapgen</a> object is unavailable, or <code>get_mapgen_object()</code> was called outside of an <code>on_generate()</code> callback, <code>nil</code> is returned.</p>
<p>The following <a class="el" href="classMapgen.html">Mapgen</a> objects are currently available:</p>
<h3><a class="anchor" id="autotoc_md1005"></a>
&lt;tt&gt;voxelmanip&lt;/tt&gt;</h3>
<p>This returns three values; the <code>VoxelManip</code> object to be used, minimum and maximum emerged position, in that order. All mapgens support this object.</p>
<h3><a class="anchor" id="autotoc_md1006"></a>
&lt;tt&gt;heightmap&lt;/tt&gt;</h3>
<p>Returns an array containing the y coordinates of the ground levels of nodes in the most recently generated chunk by the current mapgen.</p>
<h3><a class="anchor" id="autotoc_md1007"></a>
&lt;tt&gt;biomemap&lt;/tt&gt;</h3>
<p>Returns an array containing the biome IDs of nodes in the most recently generated chunk by the current mapgen.</p>
<h3><a class="anchor" id="autotoc_md1008"></a>
&lt;tt&gt;heatmap&lt;/tt&gt;</h3>
<p>Returns an array containing the temperature values of nodes in the most recently generated chunk by the current mapgen.</p>
<h3><a class="anchor" id="autotoc_md1009"></a>
&lt;tt&gt;humiditymap&lt;/tt&gt;</h3>
<p>Returns an array containing the humidity values of nodes in the most recently generated chunk by the current mapgen.</p>
<h3><a class="anchor" id="autotoc_md1010"></a>
&lt;tt&gt;gennotify&lt;/tt&gt;</h3>
<p>Returns a table mapping requested generation notification types to arrays of positions at which the corresponding generated structures are located within the current chunk. To enable the capture of positions of interest to be recorded call <code>minetest.set_gen_notify()</code> first.</p>
<p>Possible fields of the returned table are:</p>
<ul>
<li><code>dungeon</code>: bottom center position of dungeon rooms</li>
<li><code>temple</code>: as above but for desert temples (mgv6 only)</li>
<li><code>cave_begin</code></li>
<li><code>cave_end</code></li>
<li><code>large_cave_begin</code></li>
<li><code>large_cave_end</code></li>
<li><code>decoration#id</code> (see below)</li>
</ul>
<p>Decorations have a key in the format of <code>"decoration#id"</code>, where <code>id</code> is the numeric unique decoration ID as returned by <code>minetest.get_decoration_id()</code>. For example, <code>decoration#123</code>.</p>
<p>The returned positions are the ground surface 'place_on' nodes, not the decorations themselves. A 'simple' type decoration is often 1 node above the returned position and possibly displaced by 'place_offset_y'.</p>
<h1><a class="anchor" id="autotoc_md1011"></a>
Registered entities</h1>
<p>Functions receive a "luaentity" table as <code>self</code>:</p>
<ul>
<li>It has the member <code>name</code>, which is the registered name <code>("mod:thing")</code></li>
<li>It has the member <code>object</code>, which is an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> pointing to the object</li>
<li>The original prototype is visible directly via a metatable</li>
</ul>
<p>Callbacks:</p>
<ul>
<li><code>on_activate(self, staticdata, dtime_s)</code><ul>
<li>Called when the object is instantiated.</li>
<li><code>dtime_s</code> is the time passed since the object was unloaded, which can be used for updating the entity state.</li>
</ul>
</li>
<li><code>on_deactivate(self, removal)</code><ul>
<li>Called when the object is about to get removed or unloaded.</li>
<li><code>removal</code>: boolean indicating whether the object is about to get removed. Calling <code>object:remove()</code> on an active object will call this with <code>removal=true</code>. The mapblock the entity resides in being unloaded will call this with <code>removal=false</code>.</li>
<li>Note that this won't be called if the object hasn't been activated in the first place. In particular, <code>minetest.clear_objects({mode = "full"})</code> won't call this, whereas <code>minetest.clear_objects({mode = "quick"})</code> might call this.</li>
</ul>
</li>
<li><code>on_step(self, dtime, moveresult)</code><ul>
<li>Called on every server tick, after movement and collision processing.</li>
<li><code>dtime</code>: elapsed time since last call</li>
<li><code>moveresult</code>: table with collision info (only available if physical=true)</li>
</ul>
</li>
<li><code>on_punch(self, puncher, time_from_last_punch, tool_capabilities, dir, damage)</code><ul>
<li>Called when somebody punches the object.</li>
<li>Note that you probably want to handle most punches using the automatic armor group system.</li>
<li><code>puncher</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> (can be <code>nil</code>)</li>
<li><code>time_from_last_punch</code>: Meant for disallowing spamming of clicks (can be <code>nil</code>).</li>
<li><code>tool_capabilities</code>: capability table of used item (can be <code>nil</code>)</li>
<li><code>dir</code>: unit vector of direction of punch. Always defined. Points from the puncher to the punched.</li>
<li><code>damage</code>: damage that will be done to entity.</li>
<li>Can return <code>true</code> to prevent the default damage mechanism.</li>
</ul>
</li>
<li><code>on_death(self, killer)</code><ul>
<li>Called when the object dies.</li>
<li><code>killer</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> (can be <code>nil</code>)</li>
</ul>
</li>
<li><code>on_rightclick(self, clicker)</code><ul>
<li>Called when <code>clicker</code> pressed the 'place/use' key while pointing to the object (not necessarily an actual rightclick)</li>
<li><code>clicker</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> (may or may not be a player)</li>
</ul>
</li>
<li><code>on_attach_child(self, child)</code><ul>
<li><code>child</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> of the child that attaches</li>
</ul>
</li>
<li><code>on_detach_child(self, child)</code><ul>
<li><code>child</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> of the child that detaches</li>
</ul>
</li>
<li><code>on_detach(self, parent)</code><ul>
<li><code>parent</code>: an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> (can be <code>nil</code>) from where it got detached</li>
<li>This happens before the parent object is removed from the world</li>
</ul>
</li>
<li><code>get_staticdata(self)</code><ul>
<li>Should return a string that will be passed to <code>on_activate</code> when the object is instantiated the next time.</li>
</ul>
</li>
</ul>
<p>Collision info passed to <code>on_step</code> (<code>moveresult</code> argument):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    touching_ground = boolean,</div>
<div class="line">    -- Note that touching_ground is only true if the entity was moving and</div>
<div class="line">    -- collided with ground.</div>
<div class="line"> </div>
<div class="line">    collides = boolean,</div>
<div class="line">    standing_on_object = boolean,</div>
<div class="line"> </div>
<div class="line">    collisions = {</div>
<div class="line">        {</div>
<div class="line">            type = string, -- &quot;node&quot; or &quot;object&quot;,</div>
<div class="line">            axis = string, -- &quot;x&quot;, &quot;y&quot; or &quot;z&quot;</div>
<div class="line">            node_pos = vector, -- if type is &quot;node&quot;</div>
<div class="line">            object = ObjectRef, -- if type is &quot;object&quot;</div>
<div class="line">            old_velocity = vector,</div>
<div class="line">            new_velocity = vector,</div>
<div class="line">        },</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">    -- `collisions` does not contain data of unloaded mapblock collisions</div>
<div class="line">    -- or when the velocity changes are negligibly small</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1012"></a>
L-system trees</h1>
<h2><a class="anchor" id="autotoc_md1013"></a>
Tree definition</h2>
<div class="fragment"><div class="line">treedef={</div>
<div class="line">    axiom,         --string  initial tree axiom</div>
<div class="line">    rules_a,       --string  rules set A</div>
<div class="line">    rules_b,       --string  rules set B</div>
<div class="line">    rules_c,       --string  rules set C</div>
<div class="line">    rules_d,       --string  rules set D</div>
<div class="line">    trunk,         --string  trunk node name</div>
<div class="line">    leaves,        --string  leaves node name</div>
<div class="line">    leaves2,       --string  secondary leaves node name</div>
<div class="line">    leaves2_chance,--num     chance (0-100) to replace leaves with leaves2</div>
<div class="line">    angle,         --num     angle in deg</div>
<div class="line">    iterations,    --num     max # of iterations, usually 2 -5</div>
<div class="line">    random_level,  --num     factor to lower number of iterations, usually 0 - 3</div>
<div class="line">    trunk_type,    --string  single/double/crossed) type of trunk: 1 node,</div>
<div class="line">                    --        2x2 nodes or 3x3 in cross shape</div>
<div class="line">    thin_branches, --boolean true -&gt; use thin (1 node) branches</div>
<div class="line">    fruit,         --string  fruit node name</div>
<div class="line">    fruit_chance,  --num     chance (0-100) to replace leaves with fruit node</div>
<div class="line">    seed,          --num     random seed, if no seed is provided, the engine will create one.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1014"></a>
Key for special L-System symbols used in axioms</h2>
<ul>
<li><code>G</code>: move forward one unit with the pen up</li>
<li><code>F</code>: move forward one unit with the pen down drawing trunks and branches</li>
<li><code>f</code>: move forward one unit with the pen down drawing leaves (100% chance)</li>
<li><code>T</code>: move forward one unit with the pen down drawing trunks only</li>
<li><code>R</code>: move forward one unit with the pen down placing fruit</li>
<li><code>A</code>: replace with rules set A</li>
<li><code>B</code>: replace with rules set B</li>
<li><code>C</code>: replace with rules set C</li>
<li><code>D</code>: replace with rules set D</li>
<li><code>a</code>: replace with rules set A, chance 90%</li>
<li><code>b</code>: replace with rules set B, chance 80%</li>
<li><code>c</code>: replace with rules set C, chance 70%</li>
<li><code>d</code>: replace with rules set D, chance 60%</li>
<li><code>+</code>: yaw the turtle right by <code>angle</code> parameter</li>
<li><code>-</code>: yaw the turtle left by <code>angle</code> parameter</li>
<li><code>&amp;</code>: pitch the turtle down by <code>angle</code> parameter</li>
<li><code>^</code>: pitch the turtle up by <code>angle</code> parameter</li>
<li><code>/</code>: roll the turtle to the right by <code>angle</code> parameter</li>
<li><code>*</code>: roll the turtle to the left by <code>angle</code> parameter</li>
<li><code>[</code>: save in stack current state info</li>
<li><code>]</code>: recover from stack state info</li>
</ul>
<h2><a class="anchor" id="autotoc_md1015"></a>
Example</h2>
<p>Spawn a small apple tree:</p>
<div class="fragment"><div class="line">pos = {x=230,y=20,z=4}</div>
<div class="line">apple_tree={</div>
<div class="line">    axiom=&quot;FFFFFAFFBF&quot;,</div>
<div class="line">    rules_a=&quot;[&amp;&amp;&amp;FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;++++FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;----FFFFF&amp;&amp;FFFF]&quot;,</div>
<div class="line">    rules_b=&quot;[&amp;&amp;&amp;++FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;--FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;------FFFFF&amp;&amp;FFFF]&quot;,</div>
<div class="line">    trunk=&quot;default:tree&quot;,</div>
<div class="line">    leaves=&quot;default:leaves&quot;,</div>
<div class="line">    angle=30,</div>
<div class="line">    iterations=2,</div>
<div class="line">    random_level=0,</div>
<div class="line">    trunk_type=&quot;single&quot;,</div>
<div class="line">    thin_branches=true,</div>
<div class="line">    fruit_chance=10,</div>
<div class="line">    fruit=&quot;default:apple&quot;</div>
<div class="line">}</div>
<div class="line">minetest.spawn_tree(pos,apple_tree)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1016"></a>
Privileges</h1>
<p>Privileges provide a means for server administrators to give certain players access to special abilities in the engine, games or mods. For example, game moderators may need to travel instantly to any place in the world, this ability is implemented in <code>/teleport</code> command which requires <code>teleport</code> privilege.</p>
<h2><a class="anchor" id="autotoc_md1017"></a>
Registering privileges</h2>
<p>A mod can register a custom privilege using <code>minetest.register_privilege</code> function to give server administrators fine-grained access control over mod functionality.</p>
<p>For consistency and practical reasons, privileges should strictly increase the abilities of the user. Do not register custom privileges that e.g. restrict the player from certain in-game actions.</p>
<h2><a class="anchor" id="autotoc_md1018"></a>
Checking privileges</h2>
<p>A mod can call <code>minetest.check_player_privs</code> to test whether a player has privileges to perform an operation. Also, when registering a chat command with <code>minetest.register_chatcommand</code> a mod can declare privileges that the command requires using the <code>privs</code> field of the command definition.</p>
<h2><a class="anchor" id="autotoc_md1019"></a>
Managing player privileges</h2>
<p>A mod can update player privileges using <code>minetest.set_player_privs</code> function. Players holding the <code>privs</code> privilege can see and manage privileges for all players on the server.</p>
<p>A mod can subscribe to changes in player privileges using <code>minetest.register_on_priv_grant</code> and <code>minetest.register_on_priv_revoke</code> functions.</p>
<h2><a class="anchor" id="autotoc_md1020"></a>
Built-in privileges</h2>
<p>Minetest includes a set of built-in privileges that control capabilities provided by the Minetest engine and can be used by mods:</p>
<ul>
<li>Basic privileges are normally granted to all players:<ul>
<li><code>shout</code>: can communicate using the in-game chat.</li>
<li><code>interact</code>: can modify the world by digging, building and interacting with the nodes, entities and other players. Players without the <code>interact</code> privilege can only travel and observe the world.</li>
</ul>
</li>
<li>Advanced privileges allow bypassing certain aspects of the gameplay:<ul>
<li><code>fast</code>: can use "fast mode" to move with maximum speed.</li>
<li><code>fly</code>: can use "fly mode" to move freely above the ground without falling.</li>
<li><code>noclip</code>: can use "noclip mode" to fly through solid nodes (e.g. walls).</li>
<li><code>teleport</code>: can use <code>/teleport</code> command to move to any point in the world.</li>
<li><code>creative</code>: can access creative inventory.</li>
<li><code>bring</code>: can teleport other players to oneself.</li>
<li><code>give</code>: can use <code>/give</code> and <code>/giveme</code> commands to give any item in the game to oneself or others.</li>
<li><code>settime</code>: can use <code>/time</code> command to change current in-game time.</li>
<li><code>debug</code>: can enable wireframe rendering mode.</li>
</ul>
</li>
<li>Security-related privileges:<ul>
<li><code>privs</code>: can modify privileges of the players using <code>/grant[me]</code> and <code>/revoke[me]</code> commands.</li>
<li><code>basic_privs</code>: can grant and revoke basic privileges as defined by the <code>basic_privs</code> setting.</li>
<li><code>kick</code>: can kick other players from the server using <code>/kick</code> command.</li>
<li><code>ban</code>: can ban other players using <code>/ban</code> command.</li>
<li><code>password</code>: can use <code>/setpassword</code> and <code>/clearpassword</code> commands to manage players' passwords.</li>
<li><code>protection_bypass</code>: can bypass node protection. Note that the engine does not act upon this privilege, it is only an implementation suggestion for games.</li>
</ul>
</li>
<li>Administrative privileges:<ul>
<li><code>server</code>: can use <code>/fixlight</code>, <code>/deleteblocks</code> and <code>/deleteobjects</code> commands. Can clear inventory of other players using <code>/clearinv</code> command.</li>
<li><code>rollback</code>: can use <code>/rollback_check</code> and <code>/rollback</code> commands.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1021"></a>
Related settings</h2>
<p>Minetest includes the following settings to control behavior of privileges:</p>
<ul>
<li><code>default_privs</code>: defines privileges granted to new players.</li>
<li><code>basic_privs</code>: defines privileges that can be granted/revoked by players having the <code>basic_privs</code> privilege. This can be used, for example, to give limited moderation powers to selected users.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1022"></a>
'minetest' namespace reference</h1>
<h2><a class="anchor" id="autotoc_md1023"></a>
Utilities</h2>
<ul>
<li><code>minetest.get_current_modname()</code>: returns the currently loading mod's name, when loading a mod.</li>
<li><code>minetest.get_modpath(modname)</code>: returns the directory path for a mod, e.g. <code>"/home/user/.minetest/usermods/modname"</code>.<ul>
<li>Returns nil if the mod is not enabled or does not exist (not installed).</li>
<li>Works regardless of whether the mod has been loaded yet.</li>
<li>Useful for loading additional <code>.lua</code> modules or static data from a mod, or checking if a mod is enabled.</li>
</ul>
</li>
<li><code>minetest.get_modnames()</code>: returns a list of enabled mods, sorted alphabetically.<ul>
<li>Does not include disabled mods, even if they are installed.</li>
</ul>
</li>
<li><code>minetest.get_game_info()</code>: returns a table containing information about the current game. Note that other meta information (e.g. version/release number) can be manually read from <code>game.conf</code> in the game's root directory.</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">    id = string,</div>
<div class="line">    title = string,</div>
<div class="line">    author = string,</div>
<div class="line">    -- The root directory of the game</div>
<div class="line">    path = string,</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>minetest.get_worldpath()</code>: returns e.g. <code>"/home/user/.minetest/world"</code><ul>
<li>Useful for storing custom data</li>
</ul>
</li>
<li><code>minetest.is_singleplayer()</code></li>
<li><code>minetest.features</code>: <a class="el" href="structTable.html">Table</a> containing API feature flags</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">    glasslike_framed = true,  -- 0.4.7</div>
<div class="line">    nodebox_as_selectionbox = true,  -- 0.4.7</div>
<div class="line">    get_all_craft_recipes_works = true,  -- 0.4.7</div>
<div class="line">    -- The transparency channel of textures can optionally be used on</div>
<div class="line">    -- nodes (0.4.7)</div>
<div class="line">    use_texture_alpha = true,</div>
<div class="line">    -- Tree and grass ABMs are no longer done from C++ (0.4.8)</div>
<div class="line">    no_legacy_abms = true,</div>
<div class="line">    -- Texture grouping is possible using parentheses (0.4.11)</div>
<div class="line">    texture_names_parens = true,</div>
<div class="line">    -- Unique Area ID for AreaStore:insert_area (0.4.14)</div>
<div class="line">    area_store_custom_ids = true,</div>
<div class="line">    -- add_entity supports passing initial staticdata to on_activate</div>
<div class="line">    -- (0.4.16)</div>
<div class="line">    add_entity_with_staticdata = true,</div>
<div class="line">    -- Chat messages are no longer predicted (0.4.16)</div>
<div class="line">    no_chat_message_prediction = true,</div>
<div class="line">    -- The transparency channel of textures can optionally be used on</div>
<div class="line">    -- objects (ie: players and lua entities) (5.0.0)</div>
<div class="line">    object_use_texture_alpha = true,</div>
<div class="line">    -- Object selectionbox is settable independently from collisionbox</div>
<div class="line">    -- (5.0.0)</div>
<div class="line">    object_independent_selectionbox = true,</div>
<div class="line">    -- Specifies whether binary data can be uploaded or downloaded using</div>
<div class="line">    -- the HTTP API (5.1.0)</div>
<div class="line">    httpfetch_binary_data = true,</div>
<div class="line">    -- Whether formspec_version[&lt;version&gt;] may be used (5.1.0)</div>
<div class="line">    formspec_version_element = true,</div>
<div class="line">    -- Whether AreaStore&#39;s IDs are kept on save/load (5.1.0)</div>
<div class="line">    area_store_persistent_ids = true,</div>
<div class="line">    -- Whether minetest.find_path is functional (5.2.0)</div>
<div class="line">    pathfinder_works = true,</div>
<div class="line">    -- Whether Collision info is available to an objects&#39; on_step (5.3.0)</div>
<div class="line">    object_step_has_moveresult = true,</div>
<div class="line">    -- Whether get_velocity() and add_velocity() can be used on players (5.4.0)</div>
<div class="line">    direct_velocity_on_players = true,</div>
<div class="line">    -- nodedef&#39;s use_texture_alpha accepts new string modes (5.4.0)</div>
<div class="line">    use_texture_alpha_string_modes = true,</div>
<div class="line">    -- degrotate param2 rotates in units of 1.5° instead of 2°</div>
<div class="line">    -- thus changing the range of values from 0-179 to 0-240 (5.5.0)</div>
<div class="line">    degrotate_240_steps = true,</div>
<div class="line">    -- ABM supports min_y and max_y fields in definition (5.5.0)</div>
<div class="line">    abm_min_max_y = true,</div>
<div class="line">    -- dynamic_add_media supports passing a table with options (5.5.0)</div>
<div class="line">    dynamic_add_media_table = true,</div>
<div class="line">    -- particlespawners support texpools and animation of properties,</div>
<div class="line">    -- particle textures support smooth fade and scale animations, and</div>
<div class="line">    -- sprite-sheet particle animations can by synced to the lifetime</div>
<div class="line">    -- of individual particles (5.6.0)</div>
<div class="line">    particlespawner_tweenable = true,</div>
<div class="line">    -- allows get_sky to return a table instead of separate values (5.6.0)</div>
<div class="line">    get_sky_as_table = true,</div>
<div class="line">    -- VoxelManip:get_light_data accepts an optional buffer argument (5.7.0)</div>
<div class="line">    get_light_data_buffer = true,</div>
<div class="line">    -- When using a mod storage backend that is not &quot;files&quot; or &quot;dummy&quot;,</div>
<div class="line">    -- the amount of data in mod storage is not constrained by</div>
<div class="line">    -- the amount of RAM available. (5.7.0)</div>
<div class="line">    mod_storage_on_disk = true,</div>
<div class="line">    -- &quot;zstd&quot; method for compress/decompress (5.7.0)</div>
<div class="line">    compress_zstd = true,</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>minetest.has_feature(arg)</code>: returns <code>boolean, missing_features</code><ul>
<li><code>arg</code>: string or table in format <code>{foo=true, bar=true}</code></li>
<li><code>missing_features</code>: <code>{foo=true, bar=true}</code></li>
</ul>
</li>
<li><code>minetest.get_player_information(player_name)</code>: <a class="el" href="structTable.html">Table</a> containing information about a player. Example return value:</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">    address = &quot;127.0.0.1&quot;,     -- IP address of client</div>
<div class="line">    ip_version = 4,            -- IPv4 / IPv6</div>
<div class="line">    connection_uptime = 200,   -- seconds since client connected</div>
<div class="line">    protocol_version = 32,     -- protocol version used by client</div>
<div class="line">    formspec_version = 2,      -- supported formspec version</div>
<div class="line">    lang_code = &quot;fr&quot;,          -- Language code used for translation</div>
<div class="line"> </div>
<div class="line">    -- the following keys can be missing if no stats have been collected yet</div>
<div class="line">    min_rtt = 0.01,            -- minimum round trip time</div>
<div class="line">    max_rtt = 0.2,             -- maximum round trip time</div>
<div class="line">    avg_rtt = 0.02,            -- average round trip time</div>
<div class="line">    min_jitter = 0.01,         -- minimum packet time jitter</div>
<div class="line">    max_jitter = 0.5,          -- maximum packet time jitter</div>
<div class="line">    avg_jitter = 0.03,         -- average packet time jitter</div>
<div class="line">    -- the following information is available in a debug build only!!!</div>
<div class="line">    -- DO NOT USE IN MODS</div>
<div class="line">    --ser_vers = 26,             -- serialization version used by client</div>
<div class="line">    --major = 0,                 -- major version number</div>
<div class="line">    --minor = 4,                 -- minor version number</div>
<div class="line">    --patch = 10,                -- patch version number</div>
<div class="line">    --vers_string = &quot;0.4.9-git&quot;, -- full version string</div>
<div class="line">    --state = &quot;Active&quot;           -- current client state</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><p class="startli"><code>minetest.get_player_window_information(player_name)</code>:</p>
<p class="startli">```lua </p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1024"></a>
– Will only be present if the client sent this information (requires v5.7+)</h2>
<p>&ndash; Note that none of these things are constant, they are likely to change during a client </p>
<h2><a class="anchor" id="autotoc_md1025"></a>
– connection as the player resizes the window and moves it between monitors</h2>
<p>&ndash; real_gui_scaling and real_hud_scaling can be used instead of DPI. &ndash; OSes don't necessarily give the physical DPI, as they may allow user configuration. &ndash; real_*_scaling is just OS DPI / 96 but with another level of user configuration. { </p>
<h2><a class="anchor" id="autotoc_md1026"></a>
– Current size of the in-game render target (pixels).</h2>
<p>&ndash; This is usually the window size, but may be smaller in certain situations, &ndash; such as side-by-side mode. size = { x = 1308, y = 577, },</p>
<p>&ndash; Estimated maximum formspec size before Minetest will start shrinking the &ndash; formspec to fit. For a fullscreen formspec, use a size 10-20% larger than &ndash; this and <code>padding[-0.01,-0.01]</code>. max_formspec_size = { x = 20, y = 11.25 },</p>
<p>&ndash; GUI Scaling multiplier &ndash; Equal to the setting <code>gui_scaling</code> multiplied by <code>dpi / 96</code> real_gui_scaling = 1,</p>
<p>&ndash; HUD Scaling multiplier &ndash; Equal to the setting <code>hud_scaling</code> multiplied by <code>dpi / 96</code> real_hud_scaling = 1, } ```</p>
<ul>
<li><code>minetest.mkdir(path)</code>: returns success.<ul>
<li>Creates a directory specified by <code>path</code>, creating parent directories if they don't exist.</li>
</ul>
</li>
<li><code>minetest.rmdir(path, recursive)</code>: returns success.<ul>
<li>Removes a directory specified by <code>path</code>.</li>
<li>If <code>recursive</code> is set to <code>true</code>, the directory is recursively removed. Otherwise, the directory will only be removed if it is empty.</li>
<li>Returns true on success, false on failure.</li>
</ul>
</li>
<li><code>minetest.cpdir(source, destination)</code>: returns success.<ul>
<li>Copies a directory specified by <code>path</code> to <code>destination</code></li>
<li>Any files in <code>destination</code> will be overwritten if they already exist.</li>
<li>Returns true on success, false on failure.</li>
</ul>
</li>
<li><code>minetest.mvdir(source, destination)</code>: returns success.<ul>
<li>Moves a directory specified by <code>path</code> to <code>destination</code>.</li>
<li>If the <code>destination</code> is a non-empty directory, then the move will fail.</li>
<li>Returns true on success, false on failure.</li>
</ul>
</li>
<li><code>minetest.get_dir_list(path, [is_dir])</code>: returns list of entry names<ul>
<li>is_dir is one of:<ul>
<li>nil: return all entries,</li>
<li>true: return only subdirectory names, or</li>
<li>false: return only file names.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.safe_file_write(path, content)</code>: returns boolean indicating success<ul>
<li>Replaces contents of file at path with new contents in a safe (atomic) way. Use this instead of below code when writing e.g. database files: <code>local f = io.open(path, "wb"); f:write(content); f:close()</code></li>
</ul>
</li>
<li><code>minetest.get_version()</code>: returns a table containing components of the engine version. Components:<ul>
<li><code>project</code>: Name of the project, eg, "Minetest"</li>
<li><code>string</code>: Simple version, eg, "1.2.3-dev"</li>
<li><code>proto_min</code>: The minimum supported protocol version</li>
<li><code>proto_max</code>: The maximum supported protocol version</li>
<li><code>hash</code>: Full git version (only set if available), eg, "1.2.3-dev-01234567-dirty".</li>
<li><code>is_dev</code>: Boolean value indicating whether it's a development build Use this for informational purposes only. The information in the returned table does not represent the capabilities of the engine, nor is it reliable or verifiable. Compatible forks will have a different name and version entirely. To check for the presence of engine features, test whether the functions exported by the wanted features exist. For example: <code>if minetest.check_for_falling then ... end</code>.</li>
</ul>
</li>
<li><code>minetest.sha1(data, [raw])</code>: returns the sha1 hash of data<ul>
<li><code>data</code>: string of data to hash</li>
<li><code>raw</code>: return raw bytes instead of hex digits, default: false</li>
</ul>
</li>
<li><code>minetest.colorspec_to_colorstring(colorspec)</code>: Converts a ColorSpec to a ColorString. If the ColorSpec is invalid, returns <code>nil</code>.<ul>
<li><code>colorspec</code>: The ColorSpec to convert</li>
</ul>
</li>
<li><code>minetest.colorspec_to_bytes(colorspec)</code>: Converts a ColorSpec to a raw string of four bytes in an RGBA layout, returned as a string.<ul>
<li><code>colorspec</code>: The ColorSpec to convert</li>
</ul>
</li>
<li><code>minetest.encode_png(width, height, data, [compression])</code>: Encode a PNG image and return it in string form.<ul>
<li><code>width</code>: Width of the image</li>
<li><code>height</code>: Height of the image</li>
<li><code>data</code>: Image data, one of:<ul>
<li>array table of ColorSpec, length must be width*height</li>
<li>string with raw RGBA pixels, length must be width*height*4</li>
</ul>
</li>
<li><code>compression</code>: <a class="el" href="classOptional.html">Optional</a> zlib compression level, number in range 0 to 9. The data is one-dimensional, starting in the upper left corner of the image and laid out in scanlines going from left to right, then top to bottom. Please note that it's not safe to use string.char to generate raw data, use <code>colorspec_to_bytes</code> to generate raw RGBA values in a predictable way. The resulting PNG image is always 32-bit. Palettes are not supported at the moment. You may use this to procedurally generate textures during server init.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1027"></a>
Logging</h2>
<ul>
<li><code>minetest.debug(...)</code><ul>
<li>Equivalent to <code>minetest.log(table.concat({...}, "\t"))</code></li>
</ul>
</li>
<li><code>minetest.log([level,] text)</code><ul>
<li><code>level</code> is one of <code>"none"</code>, <code>"error"</code>, <code>"warning"</code>, <code>"action"</code>, <code>"info"</code>, or <code>"verbose"</code>. Default is <code>"none"</code>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1028"></a>
Registration functions</h2>
<p>Call these functions only at load time!</p>
<h3><a class="anchor" id="autotoc_md1029"></a>
Environment</h3>
<ul>
<li><code>minetest.register_node(name, node definition)</code></li>
<li><code>minetest.register_craftitem(name, item definition)</code></li>
<li><code>minetest.register_tool(name, item definition)</code></li>
<li><code>minetest.override_item(name, redefinition)</code><ul>
<li>Overrides fields of an item registered with register_node/tool/craftitem.</li>
<li>Note: Item must already be defined, (opt)depend on the mod defining it.</li>
<li>Example: <code>minetest.override_item("default:mese", {light_source=minetest.LIGHT_MAX})</code></li>
</ul>
</li>
<li><code>minetest.unregister_item(name)</code><ul>
<li>Unregisters the item from the engine, and deletes the entry with key <code>name</code> from <code>minetest.registered_items</code> and from the associated item table according to its nature: <code>minetest.registered_nodes</code>, etc.</li>
</ul>
</li>
<li><code>minetest.register_entity(name, entity definition)</code></li>
<li><code>minetest.register_abm(abm definition)</code></li>
<li><code>minetest.register_lbm(lbm definition)</code></li>
<li><code>minetest.register_alias(alias, original_name)</code><ul>
<li>Also use this to set the 'mapgen aliases' needed in a game for the core mapgens. See [<a class="el" href="classMapgen.html">Mapgen</a> aliases] section above.</li>
</ul>
</li>
<li><code>minetest.register_alias_force(alias, original_name)</code></li>
<li><code>minetest.register_ore(ore definition)</code><ul>
<li>Returns an integer object handle uniquely identifying the registered ore on success.</li>
<li>The order of ore registrations determines the order of ore generation.</li>
</ul>
</li>
<li><code>minetest.register_biome(biome definition)</code><ul>
<li>Returns an integer object handle uniquely identifying the registered biome on success. To get the biome ID, use <code>minetest.get_biome_id</code>.</li>
</ul>
</li>
<li><code>minetest.unregister_biome(name)</code><ul>
<li>Unregisters the biome from the engine, and deletes the entry with key <code>name</code> from <code>minetest.registered_biomes</code>.</li>
<li>Warning: This alters the biome to biome ID correspondences, so any decorations or ores using the 'biomes' field must afterwards be cleared and re-registered.</li>
</ul>
</li>
<li><code>minetest.register_decoration(decoration definition)</code><ul>
<li>Returns an integer object handle uniquely identifying the registered decoration on success. To get the decoration ID, use <code>minetest.get_decoration_id</code>.</li>
<li>The order of decoration registrations determines the order of decoration generation.</li>
</ul>
</li>
<li><code>minetest.register_schematic(schematic definition)</code><ul>
<li>Returns an integer object handle uniquely identifying the registered schematic on success.</li>
<li>If the schematic is loaded from a file, the <code>name</code> field is set to the filename.</li>
<li>If the function is called when loading the mod, and <code>name</code> is a relative path, then the current mod path will be prepended to the schematic filename.</li>
</ul>
</li>
<li><code>minetest.clear_registered_biomes()</code><ul>
<li>Clears all biomes currently registered.</li>
<li>Warning: Clearing and re-registering biomes alters the biome to biome ID correspondences, so any decorations or ores using the 'biomes' field must afterwards be cleared and re-registered.</li>
</ul>
</li>
<li><code>minetest.clear_registered_decorations()</code><ul>
<li>Clears all decorations currently registered.</li>
</ul>
</li>
<li><code>minetest.clear_registered_ores()</code><ul>
<li>Clears all ores currently registered.</li>
</ul>
</li>
<li><code>minetest.clear_registered_schematics()</code><ul>
<li>Clears all schematics currently registered.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1030"></a>
Gameplay</h3>
<ul>
<li><code>minetest.register_craft(recipe)</code><ul>
<li>Check recipe table syntax for different types below.</li>
</ul>
</li>
<li><code>minetest.clear_craft(recipe)</code><ul>
<li>Will erase existing craft based either on output item or on input recipe.</li>
<li>Specify either output or input only. If you specify both, input will be ignored. For input use the same recipe table syntax as for <code>minetest.register_craft(recipe)</code>. For output specify only the item, without a quantity.</li>
<li>Returns false if no erase candidate could be found, otherwise returns true.</li>
<li><b>Warning</b>! The type field ("shaped", "cooking" or any other) will be ignored if the recipe contains output. Erasing is then done independently from the crafting method.</li>
</ul>
</li>
<li><code>minetest.register_chatcommand(cmd, chatcommand definition)</code></li>
<li><code>minetest.override_chatcommand(name, redefinition)</code><ul>
<li>Overrides fields of a chatcommand registered with <code>register_chatcommand</code>.</li>
</ul>
</li>
<li><code>minetest.unregister_chatcommand(name)</code><ul>
<li>Unregisters a chatcommands registered with <code>register_chatcommand</code>.</li>
</ul>
</li>
<li><code>minetest.register_privilege(name, definition)</code><ul>
<li><code>definition</code> can be a description or a definition table (see [Privilege definition]).</li>
<li>If it is a description, the priv will be granted to singleplayer and admin by default.</li>
<li>To allow players with <code>basic_privs</code> to grant, see the <code>basic_privs</code> minetest.conf setting.</li>
</ul>
</li>
<li><code>minetest.register_authentication_handler(authentication handler definition)</code><ul>
<li>Registers an auth handler that overrides the builtin one.</li>
<li>This function can be called by a single mod once only.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1031"></a>
Global callback registration functions</h2>
<p>Call these functions only at load time!</p>
<ul>
<li><code>minetest.register_globalstep(function(dtime))</code><ul>
<li>Called every server step, usually interval of 0.1s</li>
</ul>
</li>
<li><code>minetest.register_on_mods_loaded(function())</code><ul>
<li>Called after mods have finished loading and before the media is cached or the aliases handled.</li>
</ul>
</li>
<li><code>minetest.register_on_shutdown(function())</code><ul>
<li>Called before server shutdown</li>
<li><b>Warning</b>: If the server terminates abnormally (i.e. crashes), the registered callbacks <b>will likely not be run</b>. Data should be saved at semi-frequent intervals as well as on server shutdown.</li>
</ul>
</li>
<li><code>minetest.register_on_placenode(function(pos, newnode, placer, oldnode, itemstack, pointed_thing))</code><ul>
<li>Called when a node has been placed</li>
<li>If return <code>true</code> no item is taken from <code>itemstack</code></li>
<li><code>placer</code> may be any valid <a class="el" href="classObjectRef.html">ObjectRef</a> or nil.</li>
<li><b>Not recommended</b>; use <code>on_construct</code> or <code>after_place_node</code> in node definition whenever possible.</li>
</ul>
</li>
<li><code>minetest.register_on_dignode(function(pos, oldnode, digger))</code><ul>
<li>Called when a node has been dug.</li>
<li><b>Not recommended</b>; Use <code>on_destruct</code> or <code>after_dig_node</code> in node definition whenever possible.</li>
</ul>
</li>
<li><code>minetest.register_on_punchnode(function(pos, node, puncher, pointed_thing))</code><ul>
<li>Called when a node is punched</li>
</ul>
</li>
<li><code>minetest.register_on_generated(function(minp, maxp, blockseed))</code><ul>
<li>Called after generating a piece of world. Modifying nodes inside the area is a bit faster than usual.</li>
</ul>
</li>
<li><code>minetest.register_on_newplayer(function(ObjectRef))</code><ul>
<li>Called when a new player enters the world for the first time</li>
</ul>
</li>
<li><code>minetest.register_on_punchplayer(function(player, hitter, time_from_last_punch, tool_capabilities, dir, damage))</code><ul>
<li>Called when a player is punched</li>
<li>Note: This callback is invoked even if the punched player is dead.</li>
<li><code>player</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> - <a class="el" href="classPlayer.html">Player</a> that was punched</li>
<li><code>hitter</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> - <a class="el" href="classPlayer.html">Player</a> that hit</li>
<li><code>time_from_last_punch</code>: Meant for disallowing spamming of clicks (can be nil).</li>
<li><code>tool_capabilities</code>: Capability table of used item (can be nil)</li>
<li><code>dir</code>: Unit vector of direction of punch. Always defined. Points from the puncher to the punched.</li>
<li><code>damage</code>: Number that represents the damage calculated by the engine</li>
<li>should return <code>true</code> to prevent the default damage mechanism</li>
</ul>
</li>
<li><code>minetest.register_on_rightclickplayer(function(player, clicker))</code><ul>
<li>Called when the 'place/use' key was used while pointing a player (not necessarily an actual rightclick)</li>
<li><code>player</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> - <a class="el" href="classPlayer.html">Player</a> that is acted upon</li>
<li><code>clicker</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> - Object that acted upon <code>player</code>, may or may not be a player</li>
</ul>
</li>
<li><code>minetest.register_on_player_hpchange(function(player, hp_change, reason), modifier)</code><ul>
<li>Called when the player gets damaged or healed</li>
<li><code>player</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> of the player</li>
<li><code>hp_change</code>: the amount of change. Negative when it is damage.</li>
<li><code>reason</code>: a <a class="el" href="structPlayerHPChangeReason.html">PlayerHPChangeReason</a> table.<ul>
<li>The <code>type</code> field will have one of the following values:<ul>
<li><code>set_hp</code>: A mod or the engine called <code>set_hp</code> without giving a type - use this for custom damage types.</li>
<li><code>punch</code>: Was punched. <code>reason.object</code> will hold the puncher, or nil if none.</li>
<li><code>fall</code></li>
<li><code>node_damage</code>: <code>damage_per_second</code> from a neighboring node. <code>reason.node</code> will hold the node name or nil. <code>reason.node_pos</code> will hold the position of the node</li>
<li><code>drown</code></li>
<li><code>respawn</code></li>
</ul>
</li>
<li>Any of the above types may have additional fields from mods.</li>
<li><code>reason.from</code> will be <code>mod</code> or <code>engine</code>.</li>
</ul>
</li>
<li><code>modifier</code>: when true, the function should return the actual <code>hp_change</code>. Note: modifiers only get a temporary <code>hp_change</code> that can be modified by later modifiers. Modifiers can return true as a second argument to stop the execution of further functions. Non-modifiers receive the final HP change calculated by the modifiers.</li>
</ul>
</li>
<li><code>minetest.register_on_dieplayer(function(ObjectRef, reason))</code><ul>
<li>Called when a player dies</li>
<li><code>reason</code>: a <a class="el" href="structPlayerHPChangeReason.html">PlayerHPChangeReason</a> table, see register_on_player_hpchange</li>
</ul>
</li>
<li><code>minetest.register_on_respawnplayer(function(ObjectRef))</code><ul>
<li>Called when player is to be respawned</li>
<li>Called <em>before</em> repositioning of player occurs</li>
<li>return true in func to disable regular player placement</li>
</ul>
</li>
<li><code>minetest.register_on_prejoinplayer(function(name, ip))</code><ul>
<li>Called when a client connects to the server, prior to authentication</li>
<li>If it returns a string, the client is disconnected with that string as reason.</li>
</ul>
</li>
<li><code>minetest.register_on_joinplayer(function(ObjectRef, last_login))</code><ul>
<li>Called when a player joins the game</li>
<li><code>last_login</code>: The timestamp of the previous login, or nil if player is new</li>
</ul>
</li>
<li><code>minetest.register_on_leaveplayer(function(ObjectRef, timed_out))</code><ul>
<li>Called when a player leaves the game</li>
<li><code>timed_out</code>: True for timeout, false for other reasons.</li>
</ul>
</li>
<li><code>minetest.register_on_authplayer(function(name, ip, is_success))</code><ul>
<li>Called when a client attempts to log into an account.</li>
<li><code>name</code>: The name of the account being authenticated.</li>
<li><code>ip</code>: The IP address of the client</li>
<li><code>is_success</code>: Whether the client was successfully authenticated</li>
<li>For newly registered accounts, <code>is_success</code> will always be true</li>
</ul>
</li>
<li><code>minetest.register_on_auth_fail(function(name, ip))</code><ul>
<li>Deprecated: use <code>minetest.register_on_authplayer(name, ip, is_success)</code> instead.</li>
</ul>
</li>
<li><code>minetest.register_on_cheat(function(ObjectRef, cheat))</code><ul>
<li>Called when a player cheats</li>
<li><code>cheat</code>: <code>{type=&lt;cheat_type&gt;}</code>, where <code>&lt;cheat_type&gt;</code> is one of:<ul>
<li><code>moved_too_fast</code></li>
<li><code>interacted_too_far</code></li>
<li><code>interacted_with_self</code></li>
<li><code>interacted_while_dead</code></li>
<li><code>finished_unknown_dig</code></li>
<li><code>dug_unbreakable</code></li>
<li><code>dug_too_fast</code></li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.register_on_chat_message(function(name, message))</code><ul>
<li>Called always when a player says something</li>
<li>Return <code>true</code> to mark the message as handled, which means that it will not be sent to other players.</li>
</ul>
</li>
<li><code>minetest.register_on_chatcommand(function(name, command, params))</code><ul>
<li>Called always when a chatcommand is triggered, before <code>minetest.registered_chatcommands</code> is checked to see if the command exists, but after the input is parsed.</li>
<li>Return <code>true</code> to mark the command as handled, which means that the default handlers will be prevented.</li>
</ul>
</li>
<li><code>minetest.register_on_player_receive_fields(function(player, formname, fields))</code><ul>
<li>Called when the server received input from <code>player</code> in a formspec with the given <code>formname</code>. Specifically, this is called on any of the following events:<ul>
<li>a button was pressed,</li>
<li>Enter was pressed while the focus was on a text field</li>
<li>a checkbox was toggled,</li>
<li>something was selected in a dropdown list,</li>
<li>a different tab was selected,</li>
<li>selection was changed in a textlist or table,</li>
<li>an entry was double-clicked in a textlist or table,</li>
<li>a scrollbar was moved, or</li>
<li>the form was actively closed by the player.</li>
</ul>
</li>
<li>Fields are sent for formspec elements which define a field. <code>fields</code> is a table containing each formspecs element value (as string), with the <code>name</code> parameter as index for each. The value depends on the formspec element type:<ul>
<li><code>animated_image</code>: Returns the index of the current frame.</li>
<li><code>button</code> and variants: If pressed, contains the user-facing button text as value. If not pressed, is <code>nil</code></li>
<li><code>field</code>, <code>textarea</code> and variants: Text in the field</li>
<li><code>dropdown</code>: Either the index or value, depending on the <code>index event</code> dropdown argument.</li>
<li><code>tabheader</code>: Tab index, starting with <code>"1"</code> (only if tab changed)</li>
<li><code>checkbox</code>: <code>"true"</code> if checked, <code>"false"</code> if unchecked</li>
<li><code>textlist</code>: See <code>minetest.explode_textlist_event</code></li>
<li><code>table</code>: See <code>minetest.explode_table_event</code></li>
<li><code>scrollbar</code>: See <code>minetest.explode_scrollbar_event</code></li>
<li>Special case: <code>["quit"]="true"</code> is sent when the user actively closed the form by mouse click, keypress or through a button_exit[] element.</li>
<li>Special case: <code>["key_enter"]="true"</code> is sent when the user pressed the Enter key and the focus was either nowhere (causing the formspec to be closed) or on a button. If the focus was on a text field, additionally, the index <code>key_enter_field</code> contains the name of the text field. See also: <code>field_close_on_enter</code>.</li>
</ul>
</li>
<li>Newest functions are called first</li>
<li>If function returns <code>true</code>, remaining functions are not called</li>
</ul>
</li>
<li><code>minetest.register_on_craft(function(itemstack, player, old_craft_grid, craft_inv))</code><ul>
<li>Called when <code>player</code> crafts something</li>
<li><code>itemstack</code> is the output</li>
<li><code>old_craft_grid</code> contains the recipe (Note: the one in the inventory is cleared).</li>
<li><code>craft_inv</code> is the inventory with the crafting grid</li>
<li>Return either an <code><a class="el" href="structItemStack.html">ItemStack</a></code>, to replace the output, or <code>nil</code>, to not modify it.</li>
</ul>
</li>
<li><code>minetest.register_craft_predict(function(itemstack, player, old_craft_grid, craft_inv))</code><ul>
<li>The same as before, except that it is called before the player crafts, to make craft prediction, and it should not change anything.</li>
</ul>
</li>
<li><code>minetest.register_allow_player_inventory_action(function(player, action, inventory, inventory_info))</code><ul>
<li>Determines how much of a stack may be taken, put or moved to a player inventory.</li>
<li>Function arguments: see <code>minetest.register_on_player_inventory_action</code></li>
<li>Return a numeric value to limit the amount of items to be taken, put or moved. A value of <code>-1</code> for <code>take</code> will make the source stack infinite.</li>
</ul>
</li>
<li><code>minetest.register_on_player_inventory_action(function(player, action, inventory, inventory_info))</code><ul>
<li>Called after an item take, put or move event from/to/in a player inventory</li>
<li>These inventory actions are recognized:<ul>
<li>move: Item was moved within the player inventory</li>
<li>put: Item was put into player inventory from another inventory</li>
<li>take: Item was taken from player inventory and put into another inventory</li>
</ul>
</li>
<li><code>player</code> (type <code><a class="el" href="classObjectRef.html">ObjectRef</a></code>) is the player who modified the inventory <code>inventory</code> (type <code><a class="el" href="classInvRef.html">InvRef</a></code>).</li>
<li>List of possible <code>action</code> (string) values and their <code>inventory_info</code> (table) contents:<ul>
<li><code>move</code>: <code>{from_list=string, to_list=string, from_index=number, to_index=number, count=number}</code></li>
<li><code>put</code>: <code>{listname=string, index=number, stack=<a class="el" href="structItemStack.html">ItemStack</a>}</code></li>
<li><code>take</code>: Same as <code>put</code></li>
</ul>
</li>
<li>Does not accept or handle any return value.</li>
</ul>
</li>
<li><code>minetest.register_on_protection_violation(function(pos, name))</code><ul>
<li>Called by <code>builtin</code> and mods when a player violates protection at a position (eg, digs a node or punches a protected entity).</li>
<li>The registered functions can be called using <code>minetest.record_protection_violation</code>.</li>
<li>The provided function should check that the position is protected by the mod calling this function before it prints a message, if it does, to allow for multiple protection mods.</li>
</ul>
</li>
<li><code>minetest.register_on_item_eat(function(hp_change, replace_with_item, itemstack, user, pointed_thing))</code><ul>
<li>Called when an item is eaten, by <code>minetest.item_eat</code></li>
<li>Return <code>itemstack</code> to cancel the default item eat response (i.e.: hp increase).</li>
</ul>
</li>
<li><code>minetest.register_on_item_pickup(function(itemstack, picker, pointed_thing, time_from_last_punch,  ...))</code><ul>
<li>Called by <code>minetest.item_pickup</code> before an item is picked up.</li>
<li>Function is added to <code>minetest.registered_on_item_pickups</code>.</li>
<li>Oldest functions are called first.</li>
<li>Parameters are the same as in the <code>on_pickup</code> callback.</li>
<li>Return an itemstack to cancel the default item pick-up response (i.e.: adding the item into inventory).</li>
</ul>
</li>
<li><code>minetest.register_on_priv_grant(function(name, granter, priv))</code><ul>
<li>Called when <code>granter</code> grants the priv <code>priv</code> to <code>name</code>.</li>
<li>Note that the callback will be called twice if it's done by a player, once with granter being the player name, and again with granter being nil.</li>
</ul>
</li>
<li><code>minetest.register_on_priv_revoke(function(name, revoker, priv))</code><ul>
<li>Called when <code>revoker</code> revokes the priv <code>priv</code> from <code>name</code>.</li>
<li>Note that the callback will be called twice if it's done by a player, once with revoker being the player name, and again with revoker being nil.</li>
</ul>
</li>
<li><code>minetest.register_can_bypass_userlimit(function(name, ip))</code><ul>
<li>Called when <code>name</code> user connects with <code>ip</code>.</li>
<li>Return <code>true</code> to by pass the player limit</li>
</ul>
</li>
<li><code>minetest.register_on_modchannel_message(function(channel_name, sender, message))</code><ul>
<li>Called when an incoming mod channel message is received</li>
<li>You should have joined some channels to receive events.</li>
<li>If message comes from a server mod, <code>sender</code> field is an empty string.</li>
</ul>
</li>
<li><code>minetest.register_on_liquid_transformed(function(pos_list, node_list))</code><ul>
<li>Called after liquid nodes (<code>liquidtype ~= "none"</code>) are modified by the engine's liquid transformation process.</li>
<li><code>pos_list</code> is an array of all modified positions.</li>
<li><code>node_list</code> is an array of the old node that was previously at the position with the corresponding index in pos_list.</li>
</ul>
</li>
<li><code>minetest.register_on_mapblocks_changed(function(modified_blocks, modified_block_count))</code><ul>
<li>Called soon after any nodes or node metadata have been modified. No modifications will be missed, but there may be false positives.</li>
<li>Will never be called more than once per server step.</li>
<li><code>modified_blocks</code> is the set of modified mapblock position hashes. These are in the same format as those produced by <code>minetest.hash_node_position</code>, and can be converted to positions with <code>minetest.get_position_from_hash</code>. The set is a table where the keys are hashes and the values are <code>true</code>.</li>
<li><code>modified_block_count</code> is the number of entries in the set.</li>
<li>Note: callbacks must be registered at mod load time.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1032"></a>
Setting-related</h2>
<ul>
<li><code>minetest.settings</code>: <a class="el" href="classSettings.html">Settings</a> object containing all of the settings from the main config file (<code>minetest.conf</code>).</li>
<li><code>minetest.setting_get_pos(name)</code>: Loads a setting from the main settings and parses it as a position (in the format <code>(1,2,3)</code>). Returns a position or nil.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1033"></a>
Authentication</h2>
<ul>
<li><code>minetest.string_to_privs(str[, delim])</code>:<ul>
<li>Converts string representation of privs into table form</li>
<li><code>delim</code>: String separating the privs. Defaults to <code>","</code>.</li>
<li>Returns <code>{ priv1 = true, ... }</code></li>
</ul>
</li>
<li><code>minetest.privs_to_string(privs[, delim])</code>:<ul>
<li>Returns the string representation of <code>privs</code></li>
<li><code>delim</code>: String to delimit privs. Defaults to <code>","</code>.</li>
</ul>
</li>
<li><code>minetest.get_player_privs(name) -&gt; {priv1=true,...}</code></li>
<li><code>minetest.check_player_privs(player_or_name, ...)</code>: returns <code>bool, missing_privs</code><ul>
<li>A quickhand for checking privileges.</li>
<li><code>player_or_name</code>: Either a <a class="el" href="classPlayer.html">Player</a> object or the name of a player.</li>
<li><code>...</code> is either a list of strings, e.g. <code>"priva", "privb"</code> or a table, e.g. <code>{ priva = true, privb = true }</code>.</li>
</ul>
</li>
<li><code>minetest.check_password_entry(name, entry, password)</code><ul>
<li>Returns true if the "password entry" for a player with name matches given password, false otherwise.</li>
<li>The "password entry" is the password representation generated by the engine as returned as part of a <code>get_auth()</code> call on the auth handler.</li>
<li>Only use this function for making it possible to log in via password from external protocols such as IRC, other uses are frowned upon.</li>
</ul>
</li>
<li><code>minetest.get_password_hash(name, raw_password)</code><ul>
<li>Convert a name-password pair to a password hash that Minetest can use.</li>
<li>The returned value alone is not a good basis for password checks based on comparing the password hash in the database with the password hash from the function, with an externally provided password, as the hash in the db might use the new SRP verifier format.</li>
<li>For this purpose, use <code>minetest.check_password_entry</code> instead.</li>
</ul>
</li>
<li><code>minetest.get_player_ip(name)</code>: returns an IP address string for the player <code>name</code>.<ul>
<li>The player needs to be online for this to be successful.</li>
</ul>
</li>
<li><code>minetest.get_auth_handler()</code>: Return the currently active auth handler<ul>
<li>Must be called <em>after</em> load time, to ensure that any custom auth handler was already registered.</li>
<li>See the [Authentication handler definition]</li>
<li>Use this to e.g. get the authentication data for a player: <code>local auth_data = minetest.get_auth_handler().get_auth(playername)</code></li>
</ul>
</li>
<li><code>minetest.notify_authentication_modified(name)</code><ul>
<li>Must be called by the authentication handler for privilege changes.</li>
<li><code>name</code>: string; if omitted, all auth data should be considered modified</li>
</ul>
</li>
<li><code>minetest.set_player_password(name, password_hash)</code>: Set password hash of player <code>name</code>.</li>
<li><code>minetest.set_player_privs(name, {priv1=true,...})</code>: Set privileges of player <code>name</code>.</li>
<li><code>minetest.auth_reload()</code><ul>
<li>See <code>reload()</code> in authentication handler definition</li>
</ul>
</li>
</ul>
<p><code>minetest.set_player_password</code>, <code>minetest.set_player_privs</code>, <code>minetest.get_player_privs</code> and <code>minetest.auth_reload</code> call the authentication handler.</p>
<h2><a class="anchor" id="autotoc_md1034"></a>
Chat</h2>
<ul>
<li><code>minetest.chat_send_all(text)</code></li>
<li><code>minetest.chat_send_player(name, text)</code></li>
<li><code>minetest.format_chat_message(name, message)</code><ul>
<li>Used by the server to format a chat message, based on the setting <code>chat_message_format</code>. Refer to the documentation of the setting for a list of valid placeholders.</li>
<li>Takes player name and message, and returns the formatted string to be sent to players.</li>
<li>Can be redefined by mods if required, for things like colored names or messages.</li>
<li><b>Only</b> the first occurrence of each placeholder will be replaced.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1035"></a>
Environment access</h2>
<ul>
<li><code>minetest.set_node(pos, node)</code></li>
<li><code>minetest.add_node(pos, node)</code>: alias to <code>minetest.set_node</code><ul>
<li>Set node at position <code>pos</code></li>
<li><code>node</code>: table <code>{name=string, param1=number, param2=number}</code></li>
<li>If param1 or param2 is omitted, it's set to <code>0</code>.</li>
<li>e.g. <code>minetest.set_node({x=0, y=10, z=0}, {name="default:wood"})</code></li>
</ul>
</li>
<li><code>minetest.bulk_set_node({pos1, pos2, pos3, ...}, node)</code><ul>
<li>Set node on all positions set in the first argument.</li>
<li>e.g. <code>minetest.bulk_set_node({{x=0, y=1, z=1}, {x=1, y=2, z=2}}, {name="default:stone"})</code></li>
<li>For node specification or position syntax see <code>minetest.set_node</code> call</li>
<li>Faster than set_node due to single call, but still considerably slower than Lua Voxel Manipulators (LVM) for large numbers of nodes. Unlike LVMs, this will call node callbacks. It also allows setting nodes in spread out positions which would cause LVMs to waste memory. For setting a cube, this is 1.3x faster than set_node whereas LVM is 20 times faster.</li>
</ul>
</li>
<li><code>minetest.swap_node(pos, node)</code><ul>
<li>Set node at position, but don't remove metadata</li>
</ul>
</li>
<li><code>minetest.remove_node(pos)</code><ul>
<li>By default it does the same as <code>minetest.set_node(pos, {name="air"})</code></li>
</ul>
</li>
<li><code>minetest.get_node(pos)</code><ul>
<li>Returns the node at the given position as table in the format <code>{name="node_name", param1=0, param2=0}</code>, returns <code>{name="ignore", param1=0, param2=0}</code> for unloaded areas.</li>
</ul>
</li>
<li><code>minetest.get_node_or_nil(pos)</code><ul>
<li>Same as <code>get_node</code> but returns <code>nil</code> for unloaded areas.</li>
</ul>
</li>
<li><code>minetest.get_node_light(pos[, timeofday])</code><ul>
<li>Gets the light value at the given position. Note that the light value "inside" the node at the given position is returned, so you usually want to get the light value of a neighbor.</li>
<li><code>pos</code>: The position where to measure the light.</li>
<li><code>timeofday</code>: <code>nil</code> for current time, <code>0</code> for night, <code>0.5</code> for day</li>
<li>Returns a number between <code>0</code> and <code>15</code> or <code>nil</code></li>
<li><code>nil</code> is returned e.g. when the map isn't loaded at <code>pos</code></li>
</ul>
</li>
<li><code>minetest.get_natural_light(pos[, timeofday])</code><ul>
<li>Figures out the sunlight (or moonlight) value at pos at the given time of day.</li>
<li><code>pos</code>: The position of the node</li>
<li><code>timeofday</code>: <code>nil</code> for current time, <code>0</code> for night, <code>0.5</code> for day</li>
<li>Returns a number between <code>0</code> and <code>15</code> or <code>nil</code></li>
<li>This function tests 203 nodes in the worst case, which happens very unlikely</li>
</ul>
</li>
<li><code>minetest.get_artificial_light(param1)</code><ul>
<li>Calculates the artificial light (light from e.g. torches) value from the <code>param1</code> value.</li>
<li><code>param1</code>: The param1 value of a <code>paramtype = "light"</code> node.</li>
<li>Returns a number between <code>0</code> and <code>15</code></li>
<li>Currently it's the same as <code>math.floor(param1 / 16)</code>, except that it ensures compatibility.</li>
</ul>
</li>
<li><code>minetest.place_node(pos, node)</code><ul>
<li>Place node with the same effects that a player would cause</li>
</ul>
</li>
<li><code>minetest.dig_node(pos)</code><ul>
<li>Dig node with the same effects that a player would cause</li>
<li>Returns <code>true</code> if successful, <code>false</code> on failure (e.g. protected location)</li>
</ul>
</li>
<li><code>minetest.punch_node(pos)</code><ul>
<li>Punch node with the same effects that a player would cause</li>
</ul>
</li>
<li><code>minetest.spawn_falling_node(pos)</code><ul>
<li>Change node into falling node</li>
<li>Returns <code>true</code> and the <a class="el" href="classObjectRef.html">ObjectRef</a> of the spawned entity if successful, <code>false</code> on failure</li>
</ul>
</li>
<li><code>minetest.find_nodes_with_meta(pos1, pos2)</code><ul>
<li>Get a table of positions of nodes that have metadata within a region {pos1, pos2}.</li>
</ul>
</li>
<li><code>minetest.get_meta(pos)</code><ul>
<li>Get a <code><a class="el" href="classNodeMetaRef.html">NodeMetaRef</a></code> at that position</li>
</ul>
</li>
<li><code>minetest.get_node_timer(pos)</code><ul>
<li>Get <code><a class="el" href="classNodeTimerRef.html">NodeTimerRef</a></code></li>
</ul>
</li>
<li><code>minetest.add_entity(pos, name, [staticdata])</code>: Spawn Lua-defined entity at position.<ul>
<li>Returns <code><a class="el" href="classObjectRef.html">ObjectRef</a></code>, or <code>nil</code> if failed</li>
</ul>
</li>
<li><code>minetest.add_item(pos, item)</code>: Spawn item<ul>
<li>Returns <code><a class="el" href="classObjectRef.html">ObjectRef</a></code>, or <code>nil</code> if failed</li>
</ul>
</li>
<li><code>minetest.get_player_by_name(name)</code>: Get an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> to a player</li>
<li><code>minetest.get_objects_inside_radius(pos, radius)</code>: returns a list of ObjectRefs.<ul>
<li><code>radius</code>: using a Euclidean metric</li>
</ul>
</li>
<li><code>minetest.get_objects_in_area(pos1, pos2)</code>: returns a list of ObjectRefs.<ul>
<li><code>pos1</code> and <code>pos2</code> are the min and max positions of the area to search.</li>
</ul>
</li>
<li><code>minetest.set_timeofday(val)</code><ul>
<li><code>val</code> is between <code>0</code> and <code>1</code>; <code>0</code> for midnight, <code>0.5</code> for midday</li>
</ul>
</li>
<li><code>minetest.get_timeofday()</code></li>
<li><code>minetest.get_gametime()</code>: returns the time, in seconds, since the world was created.</li>
<li><code>minetest.get_day_count()</code>: returns number days elapsed since world was created.<ul>
<li>accounts for time changes.</li>
</ul>
</li>
<li><code>minetest.find_node_near(pos, radius, nodenames, [search_center])</code>: returns pos or <code>nil</code>.<ul>
<li><code>radius</code>: using a maximum metric</li>
<li><code>nodenames</code>: e.g. <code>{"ignore", "group:tree"}</code> or <code>"default:dirt"</code></li>
<li><code>search_center</code> is an optional boolean (default: <code>false</code>) If true <code>pos</code> is also checked for the nodes</li>
</ul>
</li>
<li><code>minetest.find_nodes_in_area(pos1, pos2, nodenames, [grouped])</code><ul>
<li><code>pos1</code> and <code>pos2</code> are the min and max positions of the area to search.</li>
<li><code>nodenames</code>: e.g. <code>{"ignore", "group:tree"}</code> or <code>"default:dirt"</code></li>
<li>If <code>grouped</code> is true the return value is a table indexed by node name which contains lists of positions.</li>
<li>If <code>grouped</code> is false or absent the return values are as follows: first value: <a class="el" href="structTable.html">Table</a> with all node positions second value: <a class="el" href="structTable.html">Table</a> with the count of each node with the node name as index</li>
<li><a class="el" href="structArea.html">Area</a> volume is limited to 4,096,000 nodes</li>
</ul>
</li>
<li><code>minetest.find_nodes_in_area_under_air(pos1, pos2, nodenames)</code>: returns a list of positions.<ul>
<li><code>nodenames</code>: e.g. <code>{"ignore", "group:tree"}</code> or <code>"default:dirt"</code></li>
<li>Return value: <a class="el" href="structTable.html">Table</a> with all node positions with a node air above</li>
<li><a class="el" href="structArea.html">Area</a> volume is limited to 4,096,000 nodes</li>
</ul>
</li>
<li><code>minetest.get_perlin(noiseparams)</code><ul>
<li>Return world-specific perlin noise.</li>
<li>The actual seed used is the noiseparams seed plus the world seed.</li>
</ul>
</li>
<li><code>minetest.get_perlin(seeddiff, octaves, persistence, spread)</code><ul>
<li>Deprecated: use <code>minetest.get_perlin(noiseparams)</code> instead.</li>
<li>Return world-specific perlin noise.</li>
</ul>
</li>
<li><code>minetest.get_voxel_manip([pos1, pos2])</code><ul>
<li>Return voxel manipulator object.</li>
<li>Loads the manipulator from the map if positions are passed.</li>
</ul>
</li>
<li><code>minetest.set_gen_notify(flags, {deco_ids})</code><ul>
<li>Set the types of on-generate notifications that should be collected.</li>
<li><code>flags</code> is a flag field with the available flags:<ul>
<li>dungeon</li>
<li>temple</li>
<li>cave_begin</li>
<li>cave_end</li>
<li>large_cave_begin</li>
<li>large_cave_end</li>
<li>decoration</li>
</ul>
</li>
<li>The second parameter is a list of IDs of decorations which notification is requested for.</li>
</ul>
</li>
<li><code>minetest.get_gen_notify()</code><ul>
<li>Returns a flagstring and a table with the <code>deco_id</code>s.</li>
</ul>
</li>
<li><code>minetest.get_decoration_id(decoration_name)</code><ul>
<li>Returns the decoration ID number for the provided decoration name string, or <code>nil</code> on failure.</li>
</ul>
</li>
<li><code>minetest.get_mapgen_object(objectname)</code><ul>
<li>Return requested mapgen object if available (see [<a class="el" href="classMapgen.html">Mapgen</a> objects])</li>
</ul>
</li>
<li><code>minetest.get_heat(pos)</code><ul>
<li>Returns the heat at the position, or <code>nil</code> on failure.</li>
</ul>
</li>
<li><code>minetest.get_humidity(pos)</code><ul>
<li>Returns the humidity at the position, or <code>nil</code> on failure.</li>
</ul>
</li>
<li><code>minetest.get_biome_data(pos)</code><ul>
<li>Returns a table containing:<ul>
<li><code>biome</code> the biome id of the biome at that position</li>
<li><code>heat</code> the heat at the position</li>
<li><code>humidity</code> the humidity at the position</li>
</ul>
</li>
<li>Or returns <code>nil</code> on failure.</li>
</ul>
</li>
<li><code>minetest.get_biome_id(biome_name)</code><ul>
<li>Returns the biome id, as used in the biomemap <a class="el" href="classMapgen.html">Mapgen</a> object and returned by <code>minetest.get_biome_data(pos)</code>, for a given biome_name string.</li>
</ul>
</li>
<li><code>minetest.get_biome_name(biome_id)</code><ul>
<li>Returns the biome name string for the provided biome id, or <code>nil</code> on failure.</li>
<li>If no biomes have been registered, such as in mgv6, returns <code>default</code>.</li>
</ul>
</li>
<li><code>minetest.get_mapgen_params()</code><ul>
<li>Deprecated: use <code>minetest.get_mapgen_setting(name)</code> instead.</li>
<li>Returns a table containing:<ul>
<li><code>mgname</code></li>
<li><code>seed</code></li>
<li><code>chunksize</code></li>
<li><code>water_level</code></li>
<li><code>flags</code></li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.set_mapgen_params(MapgenParams)</code><ul>
<li>Deprecated: use <code>minetest.set_mapgen_setting(name, value, override)</code> instead.</li>
<li>Set map generation parameters.</li>
<li>Function cannot be called after the registration period.</li>
<li>Takes a table as an argument with the fields:<ul>
<li><code>mgname</code></li>
<li><code>seed</code></li>
<li><code>chunksize</code></li>
<li><code>water_level</code></li>
<li><code>flags</code></li>
</ul>
</li>
<li>Leave field unset to leave that parameter unchanged.</li>
<li><code>flags</code> contains a comma-delimited string of flags to set, or if the prefix <code>"no"</code> is attached, clears instead.</li>
<li><code>flags</code> is in the same format and has the same options as <code>mg_flags</code> in <code>minetest.conf</code>.</li>
</ul>
</li>
<li><code>minetest.get_mapgen_edges([mapgen_limit[, chunksize]])</code><ul>
<li>Returns the minimum and maximum possible generated node positions in that order.</li>
<li><code>mapgen_limit</code> is an optional number. If it is absent, its value is that of the <em>active</em> mapgen setting <code>"mapgen_limit"</code>.</li>
<li><code>chunksize</code> is an optional number. If it is absent, its value is that of the <em>active</em> mapgen setting <code>"chunksize"</code>.</li>
</ul>
</li>
<li><code>minetest.get_mapgen_setting(name)</code><ul>
<li>Gets the <em>active</em> mapgen setting (or nil if none exists) in string format with the following order of precedence: 1) <a class="el" href="classSettings.html">Settings</a> loaded from map_meta.txt or overrides set during mod execution. 2) <a class="el" href="classSettings.html">Settings</a> set by mods without a metafile override 3) <a class="el" href="classSettings.html">Settings</a> explicitly set in the user config file, minetest.conf 4) <a class="el" href="classSettings.html">Settings</a> set as the user config default</li>
</ul>
</li>
<li><code>minetest.get_mapgen_setting_noiseparams(name)</code><ul>
<li>Same as above, but returns the value as a <a class="el" href="structNoiseParams.html">NoiseParams</a> table if the setting <code>name</code> exists and is a valid <a class="el" href="structNoiseParams.html">NoiseParams</a>.</li>
</ul>
</li>
<li><code>minetest.set_mapgen_setting(name, value, [override_meta])</code><ul>
<li>Sets a mapgen param to <code>value</code>, and will take effect if the corresponding mapgen setting is not already present in map_meta.txt.</li>
<li><code>override_meta</code> is an optional boolean (default: <code>false</code>). If this is set to true, the setting will become the active setting regardless of the map metafile contents.</li>
<li>Note: to set the seed, use <code>"seed"</code>, not <code>"fixed_map_seed"</code>.</li>
</ul>
</li>
<li><code>minetest.set_mapgen_setting_noiseparams(name, value, [override_meta])</code><ul>
<li>Same as above, except value is a <a class="el" href="structNoiseParams.html">NoiseParams</a> table.</li>
</ul>
</li>
<li><code>minetest.set_noiseparams(name, noiseparams, set_default)</code><ul>
<li>Sets the noiseparams setting of <code>name</code> to the noiseparams table specified in <code>noiseparams</code>.</li>
<li><code>set_default</code> is an optional boolean (default: <code>true</code>) that specifies whether the setting should be applied to the default config or current active config.</li>
</ul>
</li>
<li><code>minetest.get_noiseparams(name)</code><ul>
<li>Returns a table of the noiseparams for name.</li>
</ul>
</li>
<li><code>minetest.generate_ores(vm, pos1, pos2)</code><ul>
<li>Generate all registered ores within the VoxelManip <code>vm</code> and in the area from <code>pos1</code> to <code>pos2</code>.</li>
<li><code>pos1</code> and <code>pos2</code> are optional and default to mapchunk minp and maxp.</li>
</ul>
</li>
<li><code>minetest.generate_decorations(vm, pos1, pos2)</code><ul>
<li>Generate all registered decorations within the VoxelManip <code>vm</code> and in the area from <code>pos1</code> to <code>pos2</code>.</li>
<li><code>pos1</code> and <code>pos2</code> are optional and default to mapchunk minp and maxp.</li>
</ul>
</li>
<li><code>minetest.clear_objects([options])</code><ul>
<li>Clear all objects in the environment</li>
<li>Takes an optional table as an argument with the field <code>mode</code>.<ul>
<li>mode = <code>"full"</code>: Load and go through every mapblock, clearing objects (default).</li>
<li>mode = <code>"quick"</code>: Clear objects immediately in loaded mapblocks, clear objects in unloaded mapblocks only when the mapblocks are next activated.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.load_area(pos1[, pos2])</code><ul>
<li>Load the mapblocks containing the area from <code>pos1</code> to <code>pos2</code>. <code>pos2</code> defaults to <code>pos1</code> if not specified.</li>
<li>This function does not trigger map generation.</li>
</ul>
</li>
<li><code>minetest.emerge_area(pos1, pos2, [callback], [param])</code><ul>
<li>Queue all blocks in the area from <code>pos1</code> to <code>pos2</code>, inclusive, to be asynchronously fetched from memory, loaded from disk, or if inexistent, generates them.</li>
<li>If <code>callback</code> is a valid Lua function, this will be called for each block emerged.</li>
<li>The function signature of callback is: <code>function EmergeAreaCallback(blockpos, action, calls_remaining, param)</code><ul>
<li><code>blockpos</code> is the <em>block</em> coordinates of the block that had been emerged.</li>
<li><code>action</code> could be one of the following constant values:<ul>
<li><code>minetest.EMERGE_CANCELLED</code></li>
<li><code>minetest.EMERGE_ERRORED</code></li>
<li><code>minetest.EMERGE_FROM_MEMORY</code></li>
<li><code>minetest.EMERGE_FROM_DISK</code></li>
<li><code>minetest.EMERGE_GENERATED</code></li>
</ul>
</li>
<li><code>calls_remaining</code> is the number of callbacks to be expected after this one.</li>
<li><code>param</code> is the user-defined parameter passed to emerge_area (or nil if the parameter was absent).</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.delete_area(pos1, pos2)</code><ul>
<li>delete all mapblocks in the area from pos1 to pos2, inclusive</li>
</ul>
</li>
<li><code>minetest.line_of_sight(pos1, pos2)</code>: returns <code>boolean, pos</code><ul>
<li>Checks if there is anything other than air between pos1 and pos2.</li>
<li>Returns false if something is blocking the sight.</li>
<li>Returns the position of the blocking node when <code>false</code></li>
<li><code>pos1</code>: First position</li>
<li><code>pos2</code>: Second position</li>
</ul>
</li>
<li><code>minetest.raycast(pos1, pos2, objects, liquids)</code>: returns <code>Raycast</code><ul>
<li>Creates a <code>Raycast</code> object.</li>
<li><code>pos1</code>: start of the ray</li>
<li><code>pos2</code>: end of the ray</li>
<li><code>objects</code>: if false, only nodes will be returned. Default is <code>true</code>.</li>
<li><code>liquids</code>: if false, liquid nodes (<code>liquidtype ~= "none"</code>) won't be returned. Default is <code>false</code>.</li>
</ul>
</li>
<li><code>minetest.find_path(pos1,pos2,searchdistance,max_jump,max_drop,algorithm)</code><ul>
<li>returns table containing path that can be walked on</li>
<li>returns a table of 3D points representing a path from <code>pos1</code> to <code>pos2</code> or <code>nil</code> on failure.</li>
<li>Reasons for failure:<ul>
<li>No path exists at all</li>
<li>No path exists within <code>searchdistance</code> (see below)</li>
<li>Start or end pos is buried in land</li>
</ul>
</li>
<li><code>pos1</code>: start position</li>
<li><code>pos2</code>: end position</li>
<li><code>searchdistance</code>: maximum distance from the search positions to search in. In detail: Path must be completely inside a cuboid. The minimum <code>searchdistance</code> of 1 will confine search between <code>pos1</code> and <code>pos2</code>. Larger values will increase the size of this cuboid in all directions</li>
<li><code>max_jump</code>: maximum height difference to consider walkable</li>
<li><code>max_drop</code>: maximum height difference to consider droppable</li>
<li><code>algorithm</code>: One of <code>"A*_noprefetch"</code> (default), <code>"A*"</code>, <code>"Dijkstra"</code>. Difference between <code>"A*"</code> and <code>"A*_noprefetch"</code> is that <code>"A*"</code> will pre-calculate the cost-data, the other will calculate it on-the-fly</li>
</ul>
</li>
<li><code>minetest.spawn_tree (pos, {treedef})</code><ul>
<li>spawns L-system tree at given <code>pos</code> with definition in <code>treedef</code> table</li>
</ul>
</li>
<li><code>minetest.transforming_liquid_add(pos)</code><ul>
<li>add node to liquid flow update queue</li>
</ul>
</li>
<li><code>minetest.get_node_max_level(pos)</code><ul>
<li>get max available level for leveled node</li>
</ul>
</li>
<li><code>minetest.get_node_level(pos)</code><ul>
<li>get level of leveled node (water, snow)</li>
</ul>
</li>
<li><code>minetest.set_node_level(pos, level)</code><ul>
<li>set level of leveled node, default <code>level</code> equals <code>1</code></li>
<li>if <code>totallevel &gt; maxlevel</code>, returns rest (<code>total-max</code>).</li>
</ul>
</li>
<li><code>minetest.add_node_level(pos, level)</code><ul>
<li>increase level of leveled node by level, default <code>level</code> equals <code>1</code></li>
<li>if <code>totallevel &gt; maxlevel</code>, returns rest (<code>total-max</code>)</li>
<li><code>level</code> must be between -127 and 127</li>
</ul>
</li>
<li><code>minetest.fix_light(pos1, pos2)</code>: returns <code>true</code>/<code>false</code><ul>
<li>resets the light in a cuboid-shaped part of the map and removes lighting bugs.</li>
<li>Loads the area if it is not loaded.</li>
<li><code>pos1</code> is the corner of the cuboid with the least coordinates (in node coordinates), inclusive.</li>
<li><code>pos2</code> is the opposite corner of the cuboid, inclusive.</li>
<li>The actual updated cuboid might be larger than the specified one, because only whole map blocks can be updated. The actual updated area consists of those map blocks that intersect with the given cuboid.</li>
<li>However, the neighborhood of the updated area might change as well, as light can spread out of the cuboid, also light might be removed.</li>
<li>returns <code>false</code> if the area is not fully generated, <code>true</code> otherwise</li>
</ul>
</li>
<li><code>minetest.check_single_for_falling(pos)</code><ul>
<li>causes an unsupported <code>group:falling_node</code> node to fall and causes an unattached <code>group:attached_node</code> node to fall.</li>
<li>does not spread these updates to neighbors.</li>
</ul>
</li>
<li><code>minetest.check_for_falling(pos)</code><ul>
<li>causes an unsupported <code>group:falling_node</code> node to fall and causes an unattached <code>group:attached_node</code> node to fall.</li>
<li>spread these updates to neighbors and can cause a cascade of nodes to fall.</li>
</ul>
</li>
<li><code>minetest.get_spawn_level(x, z)</code><ul>
<li>Returns a player spawn y co-ordinate for the provided (x, z) co-ordinates, or <code>nil</code> for an unsuitable spawn point.</li>
<li>For most mapgens a 'suitable spawn point' is one with y between <code>water_level</code> and <code>water_level + 16</code>, and in mgv7 well away from rivers, so <code>nil</code> will be returned for many (x, z) co-ordinates.</li>
<li>The spawn level returned is for a player spawn in unmodified terrain.</li>
<li>The spawn level is intentionally above terrain level to cope with full-node biome 'dust' nodes.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1036"></a>
Mod channels</h2>
<p>You can find mod channels communication scheme in <code>doc/mod_channels.png</code>.</p>
<ul>
<li><code>minetest.mod_channel_join(channel_name)</code><ul>
<li><a class="el" href="classServer.html">Server</a> joins channel <code>channel_name</code>, and creates it if necessary. You should listen for incoming messages with <code>minetest.register_on_modchannel_message</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1037"></a>
Inventory</h2>
<p><code>minetest.get_inventory(location)</code>: returns an <code><a class="el" href="classInvRef.html">InvRef</a></code></p>
<ul>
<li><code>location</code> = e.g.<ul>
<li><code>{type="player", name="celeron55"}</code></li>
<li><code>{type="node", pos={x=, y=, z=}}</code></li>
<li><code>{type="detached", name="creative"}</code></li>
</ul>
</li>
<li><code>minetest.create_detached_inventory(name, callbacks, [player_name])</code>: returns an <code><a class="el" href="classInvRef.html">InvRef</a></code>.<ul>
<li><code>callbacks</code>: See [Detached inventory callbacks]</li>
<li><code>player_name</code>: Make detached inventory available to one player exclusively, by default they will be sent to every player (even if not used). Note that this parameter is mostly just a workaround and will be removed in future releases.</li>
<li>Creates a detached inventory. If it already exists, it is cleared.</li>
</ul>
</li>
<li><code>minetest.remove_detached_inventory(name)</code><ul>
<li>Returns a <code>boolean</code> indicating whether the removal succeeded.</li>
</ul>
</li>
<li><code>minetest.do_item_eat(hp_change, replace_with_item, itemstack, user, pointed_thing)</code>: returns leftover <a class="el" href="structItemStack.html">ItemStack</a> or nil to indicate no inventory change<ul>
<li>See <code>minetest.item_eat</code> and <code>minetest.register_on_item_eat</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1038"></a>
Formspec</h2>
<ul>
<li><code>minetest.show_formspec(playername, formname, formspec)</code><ul>
<li><code>playername</code>: name of player to show formspec</li>
<li><code>formname</code>: name passed to <code>on_player_receive_fields</code> callbacks. It should follow the <code>"modname:&lt;whatever&gt;"</code> naming convention</li>
<li><code>formspec</code>: formspec to display</li>
</ul>
</li>
<li><code>minetest.close_formspec(playername, formname)</code><ul>
<li><code>playername</code>: name of player to close formspec</li>
<li><code>formname</code>: has to exactly match the one given in <code>show_formspec</code>, or the formspec will not close.</li>
<li>calling <code>show_formspec(playername, formname, "")</code> is equal to this expression.</li>
<li>to close a formspec regardless of the formname, call <code>minetest.close_formspec(playername, "")</code>. <b>USE THIS ONLY WHEN ABSOLUTELY NECESSARY!</b></li>
</ul>
</li>
<li><code>minetest.formspec_escape(string)</code>: returns a string<ul>
<li>escapes the characters "[", "]", "\", "," and ";", which cannot be used in formspecs.</li>
</ul>
</li>
<li><code>minetest.explode_table_event(string)</code>: returns a table<ul>
<li>returns e.g. <code>{type="CHG", row=1, column=2}</code></li>
<li><code>type</code> is one of:<ul>
<li><code>"INV"</code>: no row selected</li>
<li><code>"CHG"</code>: selected</li>
<li><code>"DCL"</code>: double-click</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.explode_textlist_event(string)</code>: returns a table<ul>
<li>returns e.g. <code>{type="CHG", index=1}</code></li>
<li><code>type</code> is one of:<ul>
<li><code>"INV"</code>: no row selected</li>
<li><code>"CHG"</code>: selected</li>
<li><code>"DCL"</code>: double-click</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.explode_scrollbar_event(string)</code>: returns a table<ul>
<li>returns e.g. <code>{type="CHG", value=500}</code></li>
<li><code>type</code> is one of:<ul>
<li><code>"INV"</code>: something failed</li>
<li><code>"CHG"</code>: has been changed</li>
<li><code>"VAL"</code>: not changed</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1039"></a>
Item handling</h2>
<ul>
<li><code>minetest.inventorycube(img1, img2, img3)</code><ul>
<li>Returns a string for making an image of a cube (useful as an item image)</li>
</ul>
</li>
<li><code>minetest.get_pointed_thing_position(pointed_thing, above)</code><ul>
<li>Returns the position of a <code>pointed_thing</code> or <code>nil</code> if the <code>pointed_thing</code> does not refer to a node or entity.</li>
<li>If the optional <code>above</code> parameter is true and the <code>pointed_thing</code> refers to a node, then it will return the <code>above</code> position of the <code>pointed_thing</code>.</li>
</ul>
</li>
<li><code>minetest.dir_to_facedir(dir, is6d)</code><ul>
<li>Convert a vector to a facedir value, used in <code>param2</code> for <code>paramtype2="facedir"</code>.</li>
<li>passing something non-<code>nil</code>/<code>false</code> for the optional second parameter causes it to take the y component into account.</li>
</ul>
</li>
<li><code>minetest.facedir_to_dir(facedir)</code><ul>
<li>Convert a facedir back into a vector aimed directly out the "back" of a node.</li>
</ul>
</li>
<li><code>minetest.dir_to_fourdir(dir)</code><ul>
<li>Convert a vector to a 4dir value, used in <code>param2</code> for <code>paramtype2="4dir"</code>.</li>
</ul>
</li>
<li><code>minetest.fourdir_to_dir(fourdir)</code><ul>
<li>Convert a 4dir back into a vector aimed directly out the "back" of a node.</li>
</ul>
</li>
<li><code>minetest.dir_to_wallmounted(dir)</code><ul>
<li>Convert a vector to a wallmounted value, used for <code>paramtype2="wallmounted"</code>.</li>
</ul>
</li>
<li><code>minetest.wallmounted_to_dir(wallmounted)</code><ul>
<li>Convert a wallmounted value back into a vector aimed directly out the "back" of a node.</li>
</ul>
</li>
<li><code>minetest.dir_to_yaw(dir)</code><ul>
<li>Convert a vector into a yaw (angle)</li>
</ul>
</li>
<li><code>minetest.yaw_to_dir(yaw)</code><ul>
<li>Convert yaw (angle) to a vector</li>
</ul>
</li>
<li><code>minetest.is_colored_paramtype(ptype)</code><ul>
<li>Returns a boolean. Returns <code>true</code> if the given <code>paramtype2</code> contains color information (<code>color</code>, <code>colorwallmounted</code>, <code>colorfacedir</code>, etc.).</li>
</ul>
</li>
<li><code>minetest.strip_param2_color(param2, paramtype2)</code><ul>
<li>Removes everything but the color information from the given <code>param2</code> value.</li>
<li>Returns <code>nil</code> if the given <code>paramtype2</code> does not contain color information.</li>
</ul>
</li>
<li><code>minetest.get_node_drops(node, toolname)</code><ul>
<li>Returns list of itemstrings that are dropped by <code>node</code> when dug with the item <code>toolname</code> (not limited to tools).</li>
<li><code>node</code>: node as table or node name</li>
<li><code>toolname</code>: name of the item used to dig (can be <code>nil</code>)</li>
</ul>
</li>
<li><code>minetest.get_craft_result(input)</code>: returns <code>output, decremented_input</code><ul>
<li><code>input.method</code> = <code>"normal"</code> or <code>"cooking"</code> or <code>"fuel"</code></li>
<li><code>input.width</code> = for example <code>3</code></li>
<li><code>input.items</code> = for example <code>{stack1, stack2, stack3, stack4, stack 5, stack 6, stack 7, stack 8, stack 9}</code></li>
<li><code>output.item</code> = <code><a class="el" href="structItemStack.html">ItemStack</a></code>, if unsuccessful: empty <code><a class="el" href="structItemStack.html">ItemStack</a></code></li>
<li><code>output.time</code> = a number, if unsuccessful: <code>0</code></li>
<li><code>output.replacements</code> = List of replacement <code><a class="el" href="structItemStack.html">ItemStack</a></code>s that couldn't be placed in <code>decremented_input.items</code>. Replacements can be placed in <code>decremented_input</code> if the stack of the replaced item has a count of 1.</li>
<li><code>decremented_input</code> = like <code>input</code></li>
</ul>
</li>
<li><code>minetest.get_craft_recipe(output)</code>: returns input<ul>
<li>returns last registered recipe for output item (node)</li>
<li><code>output</code> is a node or item type such as <code>"default:torch"</code></li>
<li><code>input.method</code> = <code>"normal"</code> or <code>"cooking"</code> or <code>"fuel"</code></li>
<li><code>input.width</code> = for example <code>3</code></li>
<li><code>input.items</code> = for example <code>{stack1, stack2, stack3, stack4, stack 5, stack 6, stack 7, stack 8, stack 9}</code><ul>
<li><code>input.items</code> = <code>nil</code> if no recipe found</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.get_all_craft_recipes(query item)</code>: returns a table or <code>nil</code><ul>
<li>returns indexed table with all registered recipes for query item (node) or <code>nil</code> if no recipe was found.</li>
<li>recipe entry table:<ul>
<li><code>method</code>: 'normal' or 'cooking' or 'fuel'</li>
<li><code>width</code>: 0-3, 0 means shapeless recipe</li>
<li><code>items</code>: indexed [1-9] table with recipe items</li>
<li><code>output</code>: string with item name and quantity</li>
</ul>
</li>
<li>Example result for <code>"default:gold_ingot"</code> with two recipes: ```lua { { method = "cooking", width = 3, output = "default:gold_ingot", items = {"default:gold_lump"} }, { method = "normal", width = 1, output = "default:gold_ingot 9", items = {"default:goldblock"} } } ```</li>
</ul>
</li>
<li><code>minetest.handle_node_drops(pos, drops, digger)</code><ul>
<li><code>drops</code>: list of itemstrings</li>
<li>Handles drops from nodes after digging: Default action is to put them into digger's inventory.</li>
<li>Can be overridden to get different functionality (e.g. dropping items on ground)</li>
</ul>
</li>
<li><code>minetest.itemstring_with_palette(item, palette_index)</code>: returns an item string.<ul>
<li>Creates an item string which contains palette index information for hardware colorization. You can use the returned string as an output in a craft recipe.</li>
<li><code>item</code>: the item stack which becomes colored. Can be in string, table and native form.</li>
<li><code>palette_index</code>: this index is added to the item stack</li>
</ul>
</li>
<li><code>minetest.itemstring_with_color(item, colorstring)</code>: returns an item string<ul>
<li>Creates an item string which contains static color information for hardware colorization. Use this method if you wish to colorize an item that does not own a palette. You can use the returned string as an output in a craft recipe.</li>
<li><code>item</code>: the item stack which becomes colored. Can be in string, table and native form.</li>
<li><code>colorstring</code>: the new color of the item stack</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1040"></a>
Rollback</h2>
<ul>
<li><code>minetest.rollback_get_node_actions(pos, range, seconds, limit)</code>: returns <code>{{actor, pos, time, oldnode, newnode}, ...}</code><ul>
<li>Find who has done something to a node, or near a node</li>
<li><code>actor</code>: <code>"player:&lt;name&gt;"</code>, also <code>"liquid"</code>.</li>
</ul>
</li>
<li><code>minetest.rollback_revert_actions_by(actor, seconds)</code>: returns <code>boolean, log_messages</code>.<ul>
<li>Revert latest actions of someone</li>
<li><code>actor</code>: <code>"player:&lt;name&gt;"</code>, also <code>"liquid"</code>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1041"></a>
Defaults for the &lt;tt&gt;on_place&lt;/tt&gt; and &lt;tt&gt;on_drop&lt;/tt&gt; item definition functions</h2>
<ul>
<li><code>minetest.item_place_node(itemstack, placer, pointed_thing[, param2, prevent_after_place])</code><ul>
<li>Place item as a node</li>
<li><code>param2</code> overrides <code>facedir</code> and wallmounted <code>param2</code></li>
<li><code>prevent_after_place</code>: if set to <code>true</code>, <code>after_place_node</code> is not called for the newly placed node to prevent a callback and placement loop</li>
<li>returns <code>itemstack, position</code><ul>
<li><code>position</code>: the location the node was placed to. <code>nil</code> if nothing was placed.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.item_place_object(itemstack, placer, pointed_thing)</code><ul>
<li>Place item as-is</li>
<li>returns the leftover itemstack</li>
<li><b>Note</b>: This function is deprecated and will never be called.</li>
</ul>
</li>
<li><code>minetest.item_place(itemstack, placer, pointed_thing[, param2])</code><ul>
<li>Wrapper that calls <code>minetest.item_place_node</code> if appropriate</li>
<li>Calls <code>on_rightclick</code> of <code>pointed_thing.under</code> if defined instead</li>
<li><b>Note</b>: is not called when wielded item overrides <code>on_place</code></li>
<li><code>param2</code> overrides facedir and wallmounted <code>param2</code></li>
<li>returns <code>itemstack, position</code><ul>
<li><code>position</code>: the location the node was placed to. <code>nil</code> if nothing was placed.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.item_pickup(itemstack, picker, pointed_thing, time_from_last_punch, ...)</code><ul>
<li>Runs callbacks registered by <code>minetest.register_on_item_pickup</code> and adds the item to the picker's <code>"main"</code> inventory list.</li>
<li>Parameters are the same as in <code>on_pickup</code>.</li>
<li>Returns the leftover itemstack.</li>
</ul>
</li>
<li><code>minetest.item_drop(itemstack, dropper, pos)</code><ul>
<li>Drop the item</li>
<li>returns the leftover itemstack</li>
</ul>
</li>
<li><code>minetest.item_eat(hp_change[, replace_with_item])</code><ul>
<li>Returns <code>function(itemstack, user, pointed_thing)</code> as a function wrapper for <code>minetest.do_item_eat</code>.</li>
<li><code>replace_with_item</code> is the itemstring which is added to the inventory. If the player is eating a stack and <code>replace_with_item</code> doesn't fit onto the eaten stack, then the remainings go to a different spot, or are dropped.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1042"></a>
Defaults for the &lt;tt&gt;on_punch&lt;/tt&gt; and &lt;tt&gt;on_dig&lt;/tt&gt; node definition callbacks</h2>
<ul>
<li><code>minetest.node_punch(pos, node, puncher, pointed_thing)</code><ul>
<li>Calls functions registered by <code>minetest.register_on_punchnode()</code></li>
</ul>
</li>
<li><code>minetest.node_dig(pos, node, digger)</code><ul>
<li>Checks if node can be dug, puts item into inventory, removes node</li>
<li>Calls functions registered by <code>minetest.registered_on_dignodes()</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1043"></a>
Sounds</h2>
<ul>
<li><code>minetest.sound_play(spec, parameters, [ephemeral])</code>: returns a handle<ul>
<li><code>spec</code> is a <code><a class="el" href="structSimpleSoundSpec.html">SimpleSoundSpec</a></code></li>
<li><code>parameters</code> is a sound parameter table</li>
<li><code>ephemeral</code> is a boolean (default: false) Ephemeral sounds will not return a handle and can't be stopped or faded. It is recommend to use this for short sounds that happen in response to player actions (e.g. door closing).</li>
</ul>
</li>
<li><code>minetest.sound_stop(handle)</code><ul>
<li><code>handle</code> is a handle returned by <code>minetest.sound_play</code></li>
</ul>
</li>
<li><code>minetest.sound_fade(handle, step, gain)</code><ul>
<li><code>handle</code> is a handle returned by <code>minetest.sound_play</code></li>
<li><code>step</code> determines how fast a sound will fade. The gain will change by this much per second, until it reaches the target gain. Note: Older versions used a signed step. This is deprecated, but old code will still work. (the client uses abs(step) to correct it)</li>
<li><code>gain</code> the target gain for the fade. Fading to zero will delete the sound.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1044"></a>
Timing</h2>
<ul>
<li><code>minetest.after(time, func, ...)</code>: returns job table to use as below.<ul>
<li>Call the function <code>func</code> after <code>time</code> seconds, may be fractional</li>
<li><a class="el" href="classOptional.html">Optional</a>: Variable number of arguments that are passed to <code>func</code></li>
</ul>
</li>
<li><code>job:cancel()</code><ul>
<li>Cancels the job function from being called</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1045"></a>
Async environment</h2>
<p>The engine allows you to submit jobs to be ran in an isolated environment concurrently with normal server operation. A job consists of a function to be ran in the async environment, any amount of arguments (will be serialized) and a callback that will be called with the return value of the job function once it is finished.</p>
<p>The async environment does <em>not</em> have access to the map, entities, players or any globals defined in the 'usual' environment. Consequently, functions like <code>minetest.get_node()</code> or <code>minetest.get_player_by_name()</code> simply do not exist in it.</p>
<p>Arguments and return values passed through this can contain certain userdata objects that will be seamlessly copied (not shared) to the async environment. This allows you easy interoperability for delegating work to jobs.</p>
<ul>
<li><code>minetest.handle_async(func, callback, ...)</code>:<ul>
<li>Queue the function <code>func</code> to be ran in an async environment. Note that there are multiple persistent workers and any of them may end up running a given job. The engine will scale the amount of worker threads automatically.</li>
<li>When <code>func</code> returns the callback is called (in the normal environment) with all of the return values as arguments.</li>
<li><a class="el" href="classOptional.html">Optional</a>: Variable number of arguments that are passed to <code>func</code></li>
</ul>
</li>
<li><code>minetest.register_async_dofile(path)</code>:<ul>
<li>Register a path to a Lua file to be imported when an async environment is initialized. You can use this to preload code which you can then call later using <code>minetest.handle_async()</code>.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1046"></a>
List of APIs available in an async environment</h3>
<p>Classes:</p><ul>
<li><code><a class="el" href="structItemStack.html">ItemStack</a></code></li>
<li><code>PerlinNoise</code></li>
<li><code>PerlinNoiseMap</code></li>
<li><code><a class="el" href="classPseudoRandom.html">PseudoRandom</a></code></li>
<li><code><a class="el" href="classPcgRandom.html">PcgRandom</a></code></li>
<li><code>SecureRandom</code></li>
<li><code><a class="el" href="classVoxelArea.html">VoxelArea</a></code></li>
<li><code>VoxelManip</code><ul>
<li>only if transferred into environment; can't read/write to map</li>
</ul>
</li>
<li><code><a class="el" href="classSettings.html">Settings</a></code></li>
</ul>
<p>Class instances that can be transferred between environments:</p><ul>
<li><code><a class="el" href="structItemStack.html">ItemStack</a></code></li>
<li><code>PerlinNoise</code></li>
<li><code>PerlinNoiseMap</code></li>
<li><code>VoxelManip</code></li>
</ul>
<p>Functions:</p><ul>
<li>Standalone helpers such as logging, filesystem, encoding, hashing or compression APIs</li>
<li><code>minetest.request_insecure_environment</code> (same restrictions apply)</li>
</ul>
<p>Variables:</p><ul>
<li><code>minetest.settings</code></li>
<li><code>minetest.registered_items</code>, <code>registered_nodes</code>, <code>registered_tools</code>, <code>registered_craftitems</code> and <code>registered_aliases</code><ul>
<li>with all functions and userdata values replaced by <code>true</code>, calling any callbacks here is obviously not possible</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1047"></a>
Server</h2>
<ul>
<li><code>minetest.request_shutdown([message],[reconnect],[delay])</code>: request for server shutdown. Will display <code>message</code> to clients.<ul>
<li><code>reconnect</code> == true displays a reconnect button</li>
<li><code>delay</code> adds an optional delay (in seconds) before shutdown. Negative delay cancels the current active shutdown. Zero delay triggers an immediate shutdown.</li>
</ul>
</li>
<li><code>minetest.cancel_shutdown_requests()</code>: cancel current delayed shutdown</li>
<li><code>minetest.get_server_status(name, joined)</code><ul>
<li>Returns the server status string when a player joins or when the command <code>/status</code> is called. Returns <code>nil</code> or an empty string when the message is disabled.</li>
<li><code>joined</code>: Boolean value, indicates whether the function was called when a player joined.</li>
<li>This function may be overwritten by mods to customize the status message.</li>
</ul>
</li>
<li><code>minetest.get_server_uptime()</code>: returns the server uptime in seconds</li>
<li><code>minetest.get_server_max_lag()</code>: returns the current maximum lag of the server in seconds or nil if server is not fully loaded yet</li>
<li><code>minetest.remove_player(name)</code>: remove player from database (if they are not connected).<ul>
<li>As auth data is not removed, minetest.player_exists will continue to return true. Call the below method as well if you want to remove auth data too.</li>
<li>Returns a code (0: successful, 1: no such player, 2: player is connected)</li>
</ul>
</li>
<li><code>minetest.remove_player_auth(name)</code>: remove player authentication data<ul>
<li>Returns boolean indicating success (false if player nonexistent)</li>
</ul>
</li>
<li><code>minetest.dynamic_add_media(options, callback)</code><ul>
<li><code>options</code>: table containing the following parameters<ul>
<li><code>filepath</code>: path to a media file on the filesystem</li>
<li><code>to_player</code>: name of the player the media should be sent to instead of all players (optional)</li>
<li><code>ephemeral</code>: boolean that marks the media as ephemeral, it will not be cached on the client (optional, default false)</li>
</ul>
</li>
<li><code>callback</code>: function with arguments <code>name</code>, which is a player name</li>
<li>Pushes the specified media file to client(s). (details below) The file must be a supported image, sound or model format. Dynamically added media is not persisted between server restarts.</li>
<li>Returns false on error, true if the request was accepted</li>
<li>The given callback will be called for every player as soon as the media is available on the client.</li>
<li>Details/Notes:<ul>
<li>If <code>ephemeral</code>=false and <code>to_player</code> is unset the file is added to the media sent to clients on startup, this means the media will appear even on old clients if they rejoin the server.</li>
<li>If <code>ephemeral</code>=false the file must not be modified, deleted, moved or renamed after calling this function.</li>
<li>Regardless of any use of <code>ephemeral</code>, adding media files with the same name twice is not possible/guaranteed to work. An exception to this is the use of <code>to_player</code> to send the same, already existent file to multiple chosen players.</li>
</ul>
</li>
<li>Clients will attempt to fetch files added this way via remote media, this can make transfer of bigger files painless (if set up). Nevertheless it is advised not to use dynamic media for big media files.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1048"></a>
Bans</h2>
<ul>
<li><code>minetest.get_ban_list()</code>: returns a list of all bans formatted as string</li>
<li><code>minetest.get_ban_description(ip_or_name)</code>: returns list of bans matching IP address or name formatted as string</li>
<li><code>minetest.ban_player(name)</code>: ban the IP of a currently connected player<ul>
<li>Returns boolean indicating success</li>
</ul>
</li>
<li><code>minetest.unban_player_or_ip(ip_or_name)</code>: remove ban record matching IP address or name</li>
<li><code>minetest.kick_player(name, [reason])</code>: disconnect a player with an optional reason.<ul>
<li>Returns boolean indicating success (false if player nonexistent)</li>
</ul>
</li>
<li><code>minetest.disconnect_player(name, [reason])</code>: disconnect a player with an optional reason, this will not prefix with 'Kicked: ' like kick_player. If no reason is given, it will default to 'Disconnected.'<ul>
<li>Returns boolean indicating success (false if player nonexistent)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1049"></a>
Particles</h2>
<ul>
<li><code>minetest.add_particle(particle definition)</code><ul>
<li>Deprecated: <code>minetest.add_particle(pos, velocity, acceleration, expirationtime, size, collisiondetection, texture, playername)</code></li>
</ul>
</li>
<li><code>minetest.add_particlespawner(particlespawner definition)</code><ul>
<li>Add a <code><a class="el" href="classParticleSpawner.html">ParticleSpawner</a></code>, an object that spawns an amount of particles over <code>time</code> seconds.</li>
<li>Returns an <code>id</code>, and -1 if adding didn't succeed</li>
<li>Deprecated: `minetest.add_particlespawner(amount, time, minpos, maxpos, minvel, maxvel, minacc, maxacc, minexptime, maxexptime, minsize, maxsize, collisiondetection, texture, playername)`</li>
</ul>
</li>
<li><code>minetest.delete_particlespawner(id, player)</code><ul>
<li>Delete <code><a class="el" href="classParticleSpawner.html">ParticleSpawner</a></code> with <code>id</code> (return value from <code>minetest.add_particlespawner</code>).</li>
<li>If playername is specified, only deletes on the player's client, otherwise on all clients.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1050"></a>
Schematics</h2>
<ul>
<li><code>minetest.create_schematic(p1, p2, probability_list, filename, slice_prob_list)</code><ul>
<li>Create a schematic from the volume of map specified by the box formed by p1 and p2.</li>
<li>Apply the specified probability and per-node force-place to the specified nodes according to the <code>probability_list</code>.<ul>
<li><code>probability_list</code> is an array of tables containing two fields, <code>pos</code> and <code>prob</code>.<ul>
<li><code>pos</code> is the 3D vector specifying the absolute coordinates of the node being modified,</li>
<li><code>prob</code> is an integer value from <code>0</code> to <code>255</code> that encodes probability and per-node force-place. Probability has levels 0-127, then 128 may be added to encode per-node force-place. For probability stated as 0-255, divide by 2 and round down to get values 0-127, then add 128 to apply per-node force-place.</li>
<li>If there are two or more entries with the same pos value, the last entry is used.</li>
<li>If <code>pos</code> is not inside the box formed by <code>p1</code> and <code>p2</code>, it is ignored.</li>
<li>If <code>probability_list</code> equals <code>nil</code>, no probabilities are applied.</li>
</ul>
</li>
</ul>
</li>
<li>Apply the specified probability to the specified horizontal slices according to the <code>slice_prob_list</code>.<ul>
<li><code>slice_prob_list</code> is an array of tables containing two fields, <code>ypos</code> and <code>prob</code>.<ul>
<li><code>ypos</code> indicates the y position of the slice with a probability applied, the lowest slice being <code>ypos = 0</code>.</li>
<li>If slice probability list equals <code>nil</code>, no slice probabilities are applied.</li>
</ul>
</li>
</ul>
</li>
<li>Saves schematic in the Minetest <a class="el" href="classSchematic.html">Schematic</a> format to filename.</li>
</ul>
</li>
<li><code>minetest.place_schematic(pos, schematic, rotation, replacements, force_placement, flags)</code><ul>
<li>Place the schematic specified by schematic (see [<a class="el" href="classSchematic.html">Schematic</a> specifier]) at <code>pos</code>.</li>
<li><code>rotation</code> can equal <code>"0"</code>, <code>"90"</code>, <code>"180"</code>, <code>"270"</code>, or <code>"random"</code>.</li>
<li>If the <code>rotation</code> parameter is omitted, the schematic is not rotated.</li>
<li><code>replacements</code> = <code>{["old_name"] = "convert_to", ...}</code></li>
<li><code>force_placement</code> is a boolean indicating whether nodes other than <code>air</code> and <code>ignore</code> are replaced by the schematic.</li>
<li>Returns nil if the schematic could not be loaded.</li>
<li><b>Warning</b>: Once you have loaded a schematic from a file, it will be cached. Future calls will always use the cached version and the replacement list defined for it, regardless of whether the file or the replacement list parameter have changed. The only way to load the file anew is to restart the server.</li>
<li><code>flags</code> is a flag field with the available flags:<ul>
<li>place_center_x</li>
<li>place_center_y</li>
<li>place_center_z</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.place_schematic_on_vmanip(vmanip, pos, schematic, rotation, replacement, force_placement, flags)</code>:<ul>
<li>This function is analogous to minetest.place_schematic, but places a schematic onto the specified VoxelManip object <code>vmanip</code> instead of the map.</li>
<li>Returns false if any part of the schematic was cut-off due to the VoxelManip not containing the full area required, and true if the whole schematic was able to fit.</li>
<li>Returns nil if the schematic could not be loaded.</li>
<li>After execution, any external copies of the VoxelManip contents are invalidated.</li>
<li><code>flags</code> is a flag field with the available flags:<ul>
<li>place_center_x</li>
<li>place_center_y</li>
<li>place_center_z</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.serialize_schematic(schematic, format, options)</code><ul>
<li>Return the serialized schematic specified by schematic (see [<a class="el" href="classSchematic.html">Schematic</a> specifier])</li>
<li>in the <code>format</code> of either "mts" or "lua".</li>
<li>"mts" - a string containing the binary MTS data used in the MTS file format.</li>
<li>"lua" - a string containing Lua code representing the schematic in table format.</li>
<li><code>options</code> is a table containing the following optional parameters:<ul>
<li>If <code>lua_use_comments</code> is true and <code>format</code> is "lua", the Lua code generated will have (X, Z) position comments for every X row generated in the schematic data for easier reading.</li>
<li>If <code>lua_num_indent_spaces</code> is a nonzero number and <code>format</code> is "lua", the Lua code generated will use that number of spaces as indentation instead of a tab character.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.read_schematic(schematic, options)</code><ul>
<li>Returns a Lua table representing the schematic (see: [<a class="el" href="classSchematic.html">Schematic</a> specifier])</li>
<li><code>schematic</code> is the schematic to read (see: [<a class="el" href="classSchematic.html">Schematic</a> specifier])</li>
<li><code>options</code> is a table containing the following optional parameters:<ul>
<li><code>write_yslice_prob</code>: string value:<ul>
<li><code>none</code>: no <code>write_yslice_prob</code> table is inserted,</li>
<li><code>low</code>: only probabilities that are not 254 or 255 are written in the <code>write_ylisce_prob</code> table,</li>
<li><code>all</code>: write all probabilities to the <code>write_yslice_prob</code> table.</li>
<li>The default for this option is <code>all</code>.</li>
<li>Any invalid value will be interpreted as <code>all</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1051"></a>
HTTP Requests</h2>
<ul>
<li><code>minetest.request_http_api()</code>:<ul>
<li>returns <code>HTTPApiTable</code> containing http functions if the calling mod has been granted access by being listed in the <code>secure.http_mods</code> or <code>secure.trusted_mods</code> setting, otherwise returns <code>nil</code>.</li>
<li>The returned table contains the functions <code>fetch</code>, <code>fetch_async</code> and <code>fetch_async_get</code> described below.</li>
<li>Only works at init time and must be called from the mod's main scope (not from a function).</li>
<li>Function only exists if minetest server was built with cURL support.</li>
<li><b>DO NOT ALLOW ANY OTHER MODS TO ACCESS THE RETURNED TABLE, STORE IT IN A LOCAL VARIABLE!</b></li>
</ul>
</li>
<li><code>HTTPApiTable.fetch(HTTPRequest req, callback)</code><ul>
<li>Performs given request asynchronously and calls callback upon completion</li>
<li>callback: <code>function(HTTPRequestResult res)</code></li>
<li>Use this HTTP function if you are unsure, the others are for advanced use</li>
</ul>
</li>
<li><code>HTTPApiTable.fetch_async(HTTPRequest req)</code>: returns handle<ul>
<li>Performs given request asynchronously and returns handle for <code>HTTPApiTable.fetch_async_get</code></li>
</ul>
</li>
<li><code>HTTPApiTable.fetch_async_get(handle)</code>: returns HTTPRequestResult<ul>
<li>Return response data for given asynchronous HTTP request</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1052"></a>
Storage API</h2>
<ul>
<li><code>minetest.get_mod_storage()</code>:<ul>
<li>returns reference to mod private <code><a class="el" href="classStorageRef.html">StorageRef</a></code></li>
<li>must be called during mod load time</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1053"></a>
Misc.</h2>
<ul>
<li><code>minetest.get_connected_players()</code>: returns list of <code>ObjectRefs</code></li>
<li><code>minetest.is_player(obj)</code>: boolean, whether <code>obj</code> is a player</li>
<li><code>minetest.player_exists(name)</code>: boolean, whether player exists (regardless of online status)</li>
<li><code>minetest.hud_replace_builtin(name, hud_definition)</code><ul>
<li>Replaces definition of a builtin hud element</li>
<li><code>name</code>: <code>"breath"</code> or <code>"health"</code></li>
<li><code>hud_definition</code>: definition to replace builtin definition</li>
</ul>
</li>
<li><code>minetest.parse_relative_number(arg, relative_to)</code>: returns number or nil<ul>
<li>Helper function for chat commands.</li>
<li>For parsing an optionally relative number of a chat command parameter, using the chat command tilde notation.</li>
<li><code>arg</code>: String snippet containing the number; possible values:<ul>
<li><code>"&lt;number&gt;"</code>: return as number</li>
<li><code>"~&lt;number&gt;"</code>: return <code>relative_to + &lt;number&gt;</code></li>
<li><code>"~"</code>: return <code>relative_to</code></li>
<li>Anything else will return <code>nil</code></li>
</ul>
</li>
<li><code>relative_to</code>: Number to which the <code>arg</code> number might be relative to</li>
<li>Examples:<ul>
<li><code>minetest.parse_relative_number("5", 10)</code> returns 5</li>
<li><code>minetest.parse_relative_number("~5", 10)</code> returns 15</li>
<li><code>minetest.parse_relative_number("~", 10)</code> returns 10</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.send_join_message(player_name)</code><ul>
<li>This function can be overridden by mods to change the join message.</li>
</ul>
</li>
<li><code>minetest.send_leave_message(player_name, timed_out)</code><ul>
<li>This function can be overridden by mods to change the leave message.</li>
</ul>
</li>
<li><code>minetest.hash_node_position(pos)</code>: returns a 48-bit integer<ul>
<li><code>pos</code>: table {x=number, y=number, z=number},</li>
<li>Gives a unique hash number for a node position (16+16+16=48bit)</li>
</ul>
</li>
<li><code>minetest.get_position_from_hash(hash)</code>: returns a position<ul>
<li>Inverse transform of <code>minetest.hash_node_position</code></li>
</ul>
</li>
<li><code>minetest.get_item_group(name, group)</code>: returns a rating<ul>
<li>Get rating of a group of an item. (<code>0</code> means: not in group)</li>
</ul>
</li>
<li><code>minetest.get_node_group(name, group)</code>: returns a rating<ul>
<li>Deprecated: An alias for the former.</li>
</ul>
</li>
<li><code>minetest.raillike_group(name)</code>: returns a rating<ul>
<li>Returns rating of the connect_to_raillike group corresponding to name</li>
<li>If name is not yet the name of a connect_to_raillike group, a new group id is created, with that name.</li>
</ul>
</li>
<li><code>minetest.get_content_id(name)</code>: returns an integer<ul>
<li>Gets the internal content ID of <code>name</code></li>
</ul>
</li>
<li><code>minetest.get_name_from_content_id(content_id)</code>: returns a string<ul>
<li>Gets the name of the content with that content ID</li>
</ul>
</li>
<li><code>minetest.parse_json(string[, nullvalue])</code>: returns something<ul>
<li>Convert a string containing JSON data into the Lua equivalent</li>
<li><code>nullvalue</code>: returned in place of the JSON null; defaults to <code>nil</code></li>
<li>On success returns a table, a string, a number, a boolean or <code>nullvalue</code></li>
<li>On failure outputs an error message and returns <code>nil</code></li>
<li>Example: <code>parse_json("[10, {\"a":false}]")</code>, returns <code>{10, {a = false}}</code></li>
</ul>
</li>
<li><code>minetest.write_json(data[, styled])</code>: returns a string or <code>nil</code> and an error message.<ul>
<li>Convert a Lua table into a JSON string</li>
<li>styled: Outputs in a human-readable format if this is set, defaults to false.</li>
<li>Unserializable things like functions and userdata will cause an error.</li>
<li><b>Warning</b>: JSON is more strict than the Lua table format.<ol type="1">
<li>You can only use strings and positive integers of at least one as keys.</li>
<li>You cannot mix string and integer keys. This is due to the fact that JSON has two distinct array and object values.</li>
</ol>
</li>
<li>Example: <code>write_json({10, {a = false}})</code>, returns &lsquo;&rsquo;[10, {"a": false}]'<code> *</code>minetest.serialize(table)<code>: returns a string</code></li>
<li><code>Convert a table containing tables, strings, numbers, booleans and</code>nil<code>s into string form readable by</code>minetest.deserialize&lt;tt&gt;</li>
<li>Example:serialize({foo="bar"})<code>, returns</code>'return { ["foo"] = "bar" }'<code> *</code>minetest.deserialize(string[, safe])<code>: returns a table</code></li>
<li><code>Convert a string returned by</code>minetest.serialize&lt;tt&gt;into a table *string` is loaded in an empty sandbox environment.</li>
<li>Will load functions if safe is false or omitted. Although these functions cannot directly access the global environment, they could bypass this restriction with maliciously crafted Lua bytecode if mod security is disabled.</li>
<li>This function should not be used on untrusted data, regardless of the value of <code>safe</code>. It is fine to serialize then deserialize user-provided data, but directly providing user input to deserialize is always unsafe.</li>
<li>Example: &lsquo;deserialize('return { ["foo"] = "bar" }&rsquo;)<code>, returns</code>{foo="bar"}<code></code></li>
<li><code>Example:</code>deserialize('print("foo")')<code>, returns</code>nil` (function call fails), returns &lsquo;error:[string "print("foo")"]:1: attempt to call global 'print&rsquo; (a nil value)<code> *</code>minetest.compress(data, method, ...)<code>: returns</code>compressed_data`</li>
<li>Compress a string of data.</li>
<li><code>method</code> is a string identifying the compression method to be used.</li>
<li>Supported compression methods:<ul>
<li>Deflate (zlib): <code>"deflate"</code></li>
<li>Zstandard: <code>"zstd"</code></li>
</ul>
</li>
<li><code>...</code> indicates method-specific arguments. Currently defined arguments are:<ul>
<li>Deflate: <code>level</code> - Compression level, <code>0</code>-<code>9</code> or <code>nil</code>.</li>
<li>Zstandard: <code>level</code> - Compression level. Integer or <code>nil</code>. Default <code>3</code>. Note any supported Zstandard compression level could be used here, but these are subject to change between Zstandard versions.</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.decompress(compressed_data, method, ...)</code>: returns data<ul>
<li>Decompress a string of data using the algorithm specified by <code>method</code>.</li>
<li>See documentation on <code>minetest.compress()</code> for supported compression methods.</li>
<li><code>...</code> indicates method-specific arguments. Currently, no methods use this</li>
</ul>
</li>
<li><code>minetest.rgba(red, green, blue[, alpha])</code>: returns a string<ul>
<li>Each argument is an 8 Bit unsigned integer</li>
<li>Returns the ColorString from rgb or rgba values</li>
<li>Example: <code>minetest.rgba(10, 20, 30, 40)</code>, returns <code>"#0A141E28"</code></li>
</ul>
</li>
<li><code>minetest.encode_base64(string)</code>: returns string encoded in base64<ul>
<li>Encodes a string in base64.</li>
</ul>
</li>
<li><code>minetest.decode_base64(string)</code>: returns string or nil on failure<ul>
<li>Padding characters are only supported starting at version 5.4.0, where 5.5.0 and newer perform proper checks.</li>
<li>Decodes a string encoded in base64.</li>
</ul>
</li>
<li><code>minetest.is_protected(pos, name)</code>: returns boolean<ul>
<li>Returning <code>true</code> restricts the player <code>name</code> from modifying (i.e. digging, placing) the node at position <code>pos</code>.</li>
<li><code>name</code> will be <code>""</code> for non-players or unknown players.</li>
<li>This function should be overridden by protection mods. It is highly recommended to grant access to players with the <code>protection_bypass</code> privilege.</li>
<li>Cache and call the old version of this function if the position is not protected by the mod. This will allow using multiple protection mods.</li>
<li>Example: ```lua local old_is_protected = minetest.is_protected function minetest.is_protected(pos, name) if mymod:position_protected_from(pos, name) then return true end return old_is_protected(pos, name) end ``<code> *</code>minetest.record_protection_violation(pos, name)`</li>
<li>This function calls functions registered with <code>minetest.register_on_protection_violation</code>.</li>
</ul>
</li>
<li><code>minetest.is_creative_enabled(name)</code>: returns boolean<ul>
<li>Returning <code>true</code> means that Creative Mode is enabled for player <code>name</code>.</li>
<li><code>name</code> will be <code>""</code> for non-players or if the player is unknown.</li>
<li>This function should be overridden by Creative Mode-related mods to implement a per-player Creative Mode.</li>
<li>By default, this function returns <code>true</code> if the setting <code>creative_mode</code> is <code>true</code> and <code>false</code> otherwise.</li>
</ul>
</li>
<li><code>minetest.is_area_protected(pos1, pos2, player_name, interval)</code><ul>
<li>Returns the position of the first node that <code>player_name</code> may not modify in the specified cuboid between <code>pos1</code> and <code>pos2</code>.</li>
<li>Returns <code>false</code> if no protections were found.</li>
<li>Applies <code>is_protected()</code> to a 3D lattice of points in the defined volume. The points are spaced evenly throughout the volume and have a spacing similar to, but no larger than, <code>interval</code>.</li>
<li>All corners and edges of the defined volume are checked.</li>
<li><code>interval</code> defaults to 4.</li>
<li><code>interval</code> should be carefully chosen and maximized to avoid an excessive number of points being checked.</li>
<li>Like <code>minetest.is_protected</code>, this function may be extended or overwritten by mods to provide a faster implementation to check the cuboid for intersections.</li>
</ul>
</li>
<li><code>minetest.rotate_and_place(itemstack, placer, pointed_thing[, infinitestacks, orient_flags, prevent_after_place])</code><ul>
<li>Attempt to predict the desired orientation of the facedir-capable node defined by <code>itemstack</code>, and place it accordingly (on-wall, on the floor, or hanging from the ceiling).</li>
<li><code>infinitestacks</code>: if <code>true</code>, the itemstack is not changed. Otherwise the stacks are handled normally.</li>
<li><code>orient_flags</code>: <a class="el" href="classOptional.html">Optional</a> table containing extra tweaks to the placement code:<ul>
<li><code>invert_wall</code>: if <code>true</code>, place wall-orientation on the ground and ground-orientation on the wall.</li>
<li><code>force_wall</code>: if <code>true</code>, always place the node in wall orientation.</li>
<li><code>force_ceiling</code>: if <code>true</code>, always place on the ceiling.</li>
<li><code>force_floor</code>: if <code>true</code>, always place the node on the floor.</li>
<li><code>force_facedir</code>: if <code>true</code>, forcefully reset the facedir to north when placing on the floor or ceiling.</li>
<li>The first four options are mutually-exclusive; the last in the list takes precedence over the first.</li>
</ul>
</li>
<li><code>prevent_after_place</code> is directly passed to <code>minetest.item_place_node</code></li>
<li>Returns the new itemstack after placement</li>
</ul>
</li>
<li><code>minetest.rotate_node(itemstack, placer, pointed_thing)</code><ul>
<li>calls <code>rotate_and_place()</code> with <code>infinitestacks</code> set according to the state of the creative mode setting, checks for "sneak" to set the <code>invert_wall</code> parameter and <code>prevent_after_place</code> set to <code>true</code>.</li>
</ul>
</li>
<li><code>minetest.calculate_knockback(player, hitter, time_from_last_punch, tool_capabilities, dir, distance, damage)</code><ul>
<li>Returns the amount of knockback applied on the punched player.</li>
<li>Arguments are equivalent to <code>register_on_punchplayer</code>, except the following:<ul>
<li><code>distance</code>: distance between puncher and punched player</li>
</ul>
</li>
<li>This function can be overridden by mods that wish to modify this behavior.</li>
<li>You may want to cache and call the old function to allow multiple mods to change knockback behavior.</li>
</ul>
</li>
<li><code>minetest.forceload_block(pos[, transient[, limit]])</code><ul>
<li>forceloads the position <code>pos</code>.</li>
<li>returns <code>true</code> if area could be forceloaded</li>
<li>If <code>transient</code> is <code>false</code> or absent, the forceload will be persistent (saved between server runs). If <code>true</code>, the forceload will be transient (not saved between server runs).</li>
<li><code>limit</code> is an optional limit on the number of blocks that can be forceloaded at once. If <code>limit</code> is negative, there is no limit. If it is absent, the limit is the value of the setting <code>"max_forceloaded_blocks"</code>. If the call would put the number of blocks over the limit, the call fails.</li>
</ul>
</li>
<li><code>minetest.forceload_free_block(pos[, transient])</code><ul>
<li>stops forceloading the position <code>pos</code></li>
<li>If <code>transient</code> is <code>false</code> or absent, frees a persistent forceload. If <code>true</code>, frees a transient forceload.</li>
</ul>
</li>
<li><code>minetest.compare_block_status(pos, condition)</code><ul>
<li>Checks whether the mapblock at position <code>pos</code> is in the wanted condition.</li>
<li><code>condition</code> may be one of the following values:<ul>
<li><code>"unknown"</code>: not in memory</li>
<li><code>"emerging"</code>: in the queue for loading from disk or generating</li>
<li><code>"loaded"</code>: in memory but inactive (no ABMs are executed)</li>
<li><code>"active"</code>: in memory and active</li>
<li>Other values are reserved for future functionality extensions</li>
</ul>
</li>
<li>Return value, the comparison status:<ul>
<li><code>false</code>: Mapblock does not fulfill the wanted condition</li>
<li><code>true</code>: Mapblock meets the requirement</li>
<li><code>nil</code>: Unsupported <code>condition</code> value</li>
</ul>
</li>
</ul>
</li>
<li><code>minetest.request_insecure_environment()</code>: returns an environment containing insecure functions if the calling mod has been listed as trusted in the <code>secure.trusted_mods</code> setting or security is disabled, otherwise returns <code>nil</code>.<ul>
<li>Only works at init time and must be called from the mod's main scope (ie: the init.lua of the mod, not from another Lua file or within a function).</li>
<li><b>DO NOT ALLOW ANY OTHER MODS TO ACCESS THE RETURNED ENVIRONMENT, STORE IT IN A LOCAL VARIABLE!</b></li>
</ul>
</li>
<li><code>minetest.global_exists(name)</code><ul>
<li>Checks if a global variable has been set, without triggering a warning.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1054"></a>
Global objects</h2>
<ul>
<li><code>minetest.env</code>: <code>EnvRef</code> of the server environment and world.<ul>
<li>Any function in the minetest namespace can be called using the syntax <code>minetest.env:somefunction(somearguments)</code> instead of <code>minetest.somefunction(somearguments)</code></li>
<li>Deprecated, but support is not to be dropped soon</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1055"></a>
Global tables</h2>
<h3><a class="anchor" id="autotoc_md1056"></a>
Registered definition tables</h3>
<ul>
<li><code>minetest.registered_items</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered items, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_nodes</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered node definitions, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_craftitems</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered craft item definitions, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_tools</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered tool definitions, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_entities</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered entity prototypes, indexed by name</li>
<li>Values in this table may be modified directly. Note: changes to initial properties will only affect entities spawned afterwards, as they are only read when spawning.</li>
</ul>
</li>
<li><code>minetest.object_refs</code><ul>
<li><a class="el" href="classMap.html">Map</a> of object references, indexed by active object id</li>
</ul>
</li>
<li><code>minetest.luaentities</code><ul>
<li><a class="el" href="classMap.html">Map</a> of Lua entities, indexed by active object id</li>
</ul>
</li>
<li><code>minetest.registered_abms</code><ul>
<li>List of ABM definitions</li>
</ul>
</li>
<li><code>minetest.registered_lbms</code><ul>
<li>List of LBM definitions</li>
</ul>
</li>
<li><code>minetest.registered_aliases</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered aliases, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_ores</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered ore definitions, indexed by the <code>name</code> field.</li>
<li>If <code>name</code> is nil, the key is the object handle returned by <code>minetest.register_ore</code>.</li>
</ul>
</li>
<li><code>minetest.registered_biomes</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered biome definitions, indexed by the <code>name</code> field.</li>
<li>If <code>name</code> is nil, the key is the object handle returned by <code>minetest.register_biome</code>.</li>
</ul>
</li>
<li><code>minetest.registered_decorations</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered decoration definitions, indexed by the <code>name</code> field.</li>
<li>If <code>name</code> is nil, the key is the object handle returned by <code>minetest.register_decoration</code>.</li>
</ul>
</li>
<li><code>minetest.registered_schematics</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered schematic definitions, indexed by the <code>name</code> field.</li>
<li>If <code>name</code> is nil, the key is the object handle returned by <code>minetest.register_schematic</code>.</li>
</ul>
</li>
<li><code>minetest.registered_chatcommands</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered chat command definitions, indexed by name</li>
</ul>
</li>
<li><code>minetest.registered_privileges</code><ul>
<li><a class="el" href="classMap.html">Map</a> of registered privilege definitions, indexed by name</li>
<li>Registered privileges can be modified directly in this table.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1057"></a>
Registered callback tables</h3>
<p>All callbacks registered with [Global callback registration functions] are added to corresponding <code>minetest.registered_*</code> tables.</p>
<h1><a class="anchor" id="autotoc_md1058"></a>
Class reference</h1>
<p>Sorted alphabetically.</p>
<h2><a class="anchor" id="autotoc_md1059"></a>
&lt;tt&gt;AreaStore&lt;/tt&gt;</h2>
<p><a class="el" href="classAreaStore.html">AreaStore</a> is a data structure to calculate intersections of 3D cuboid volumes and points. The <code>data</code> field (string) may be used to store and retrieve any mod-relevant information to the specified area.</p>
<p>Despite its name, mods must take care of persisting <a class="el" href="classAreaStore.html">AreaStore</a> data. They may use the provided load and write functions for this.</p>
<h3><a class="anchor" id="autotoc_md1060"></a>
Methods</h3>
<ul>
<li><code><a class="el" href="classAreaStore.html">AreaStore(type_name)</a></code><ul>
<li>Returns a new <a class="el" href="classAreaStore.html">AreaStore</a> instance</li>
<li><code>type_name</code>: optional, forces the internally used API.<ul>
<li>Possible values: <code>"LibSpatial"</code> (default).</li>
<li>When other values are specified, or SpatialIndex is not available, the custom Minetest functions are used.</li>
</ul>
</li>
</ul>
</li>
<li><code>get_area(id, include_corners, include_data)</code><ul>
<li>Returns the area information about the specified ID.</li>
<li>Returned values are either of these: ```lua nil &ndash; <a class="el" href="structArea.html">Area</a> not found true &ndash; Without <code>include_corners</code> and <code>include_data</code> { min = pos, max = pos &ndash; <code>include_corners == true</code> data = string &ndash; <code>include_data == true</code> } ```</li>
</ul>
</li>
<li><code>get_areas_for_pos(pos, include_corners, include_data)</code><ul>
<li>Returns all areas as table, indexed by the area ID.</li>
<li><a class="el" href="structTable.html">Table</a> values: see <code>get_area</code>.</li>
</ul>
</li>
<li><code>get_areas_in_area(corner1, corner2, accept_overlap, include_corners, include_data)</code><ul>
<li>Returns all areas that contain all nodes inside the area specified by<code> </code>corner1 and <code>corner2</code> (inclusive).</li>
<li><code>accept_overlap</code>: if <code>true</code>, areas are returned that have nodes in common (intersect) with the specified area.</li>
<li>Returns the same values as <code>get_areas_for_pos</code>.</li>
</ul>
</li>
<li><code>insert_area(corner1, corner2, data, [id])</code>: inserts an area into the store.<ul>
<li>Returns the new area's ID, or nil if the insertion failed.</li>
<li>The (inclusive) positions <code>corner1</code> and <code>corner2</code> describe the area.</li>
<li><code>data</code> is a string stored with the area.</li>
<li><code>id</code> (optional): will be used as the internal area ID if it is a unique number between 0 and 2^32-2.</li>
</ul>
</li>
<li><code>reserve(count)</code><ul>
<li>Requires SpatialIndex, no-op function otherwise.</li>
<li>Reserves resources for <code>count</code> many contained areas to improve efficiency when working with many area entries. Additional areas can still be inserted afterwards at the usual complexity.</li>
</ul>
</li>
<li><code>remove_area(id)</code>: removes the area with the given id from the store, returns success.</li>
<li><code>set_cache_params(params)</code>: sets params for the included prefiltering cache. Calling invalidates the cache, so that its elements have to be newly generated.<ul>
<li><code>params</code> is a table with the following fields: ```lua { enabled = boolean, &ndash; Whether to enable, default true block_radius = int, &ndash; The radius (in nodes) of the areas the cache &ndash; generates prefiltered lists for, minimum 16, &ndash; default 64 limit = int, &ndash; The cache size, minimum 20, default 1000 } ``<code> *</code>to_string()`: Experimental. Returns area store serialized as a (binary) string.</li>
</ul>
</li>
<li><code>to_file(filename)</code>: Experimental. Like <code>to_string()</code>, but writes the data to a file.</li>
<li><code>from_string(str)</code>: Experimental. Deserializes string and loads it into the <a class="el" href="classAreaStore.html">AreaStore</a>. Returns success and, optionally, an error message.</li>
<li><code>from_file(filename)</code>: Experimental. Like <code>from_string()</code>, but reads the data from a file.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1061"></a>
&lt;tt&gt;InvRef&lt;/tt&gt;</h2>
<p>An <code><a class="el" href="classInvRef.html">InvRef</a></code> is a reference to an inventory.</p>
<h3><a class="anchor" id="autotoc_md1062"></a>
Methods</h3>
<ul>
<li><code>is_empty(listname)</code>: return <code>true</code> if list is empty</li>
<li><code>get_size(listname)</code>: get size of a list</li>
<li><code>set_size(listname, size)</code>: set size of a list<ul>
<li>returns <code>false</code> on error (e.g. invalid <code>listname</code> or <code>size</code>)</li>
</ul>
</li>
<li><code>get_width(listname)</code>: get width of a list</li>
<li><code>set_width(listname, width)</code>: set width of list; currently used for crafting</li>
<li><code>get_stack(listname, i)</code>: get a copy of stack index <code>i</code> in list</li>
<li><code>set_stack(listname, i, stack)</code>: copy <code>stack</code> to index <code>i</code> in list</li>
<li><code>get_list(listname)</code>: returns full list (list of <code><a class="el" href="structItemStack.html">ItemStack</a></code>s) or <code>nil</code> if list doesn't exist (size 0)</li>
<li><code>set_list(listname, list)</code>: set full list (size will not change)</li>
<li><code>get_lists()</code>: returns table that maps listnames to inventory lists</li>
<li><code>set_lists(lists)</code>: sets inventory lists (size will not change)</li>
<li><code>add_item(listname, stack)</code>: add item somewhere in list, returns leftover <code><a class="el" href="structItemStack.html">ItemStack</a></code>.</li>
<li><code>room_for_item(listname, stack):</code> returns <code>true</code> if the stack of items can be fully added to the list</li>
<li><code>contains_item(listname, stack, [match_meta])</code>: returns <code>true</code> if the stack of items can be fully taken from the list. If <code>match_meta</code> is false, only the items' names are compared (default: <code>false</code>).</li>
<li><code>remove_item(listname, stack)</code>: take as many items as specified from the list, returns the items that were actually removed (as an <code><a class="el" href="structItemStack.html">ItemStack</a></code>) &ndash; note that any item metadata is ignored, so attempting to remove a specific unique item this way will likely remove the wrong one &ndash; to do that use <code>set_stack</code> with an empty <code><a class="el" href="structItemStack.html">ItemStack</a></code>.</li>
<li><code>get_location()</code>: returns a location compatible to <code>minetest.get_inventory(location)</code>.<ul>
<li>returns <code>{type="undefined"}</code> in case location is not known</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1063"></a>
Callbacks</h3>
<p>Detached &amp; nodemeta inventories provide the following callbacks for move actions:</p>
<h4><a class="anchor" id="autotoc_md1064"></a>
Before</h4>
<p>The <code>allow_*</code> callbacks return how many items can be moved.</p>
<ul>
<li><code>allow_move</code>/<code>allow_metadata_inventory_move</code>: Moving items in the inventory</li>
<li><code>allow_take</code>/<code>allow_metadata_inventory_take</code>: Taking items from the inventory</li>
<li><code>allow_put</code>/<code>allow_metadata_inventory_put</code>: Putting items to the inventory</li>
</ul>
<h4><a class="anchor" id="autotoc_md1065"></a>
After</h4>
<p>The <code>on_*</code> callbacks are called after the items have been placed in the inventories.</p>
<ul>
<li><code>on_move</code>/<code>on_metadata_inventory_move</code>: Moving items in the inventory</li>
<li><code>on_take</code>/<code>on_metadata_inventory_take</code>: Taking items from the inventory</li>
<li><code>on_put</code>/<code>on_metadata_inventory_put</code>: Putting items to the inventory</li>
</ul>
<h4><a class="anchor" id="autotoc_md1066"></a>
Swapping</h4>
<p>When a player tries to put an item to a place where another item is, the items are <em>swapped</em>. This means that all callbacks will be called twice (once for each action).</p>
<h2><a class="anchor" id="autotoc_md1067"></a>
&lt;tt&gt;ItemStack&lt;/tt&gt;</h2>
<p>An <code><a class="el" href="structItemStack.html">ItemStack</a></code> is a stack of items.</p>
<p>It can be created via <code><a class="el" href="structItemStack.html">ItemStack(x)</a></code>, where x is an <code><a class="el" href="structItemStack.html">ItemStack</a></code>, an itemstring, a table or <code>nil</code>.</p>
<h3><a class="anchor" id="autotoc_md1068"></a>
Methods</h3>
<ul>
<li><code>is_empty()</code>: returns <code>true</code> if stack is empty.</li>
<li><code>get_name()</code>: returns item name (e.g. <code>"default:stone"</code>).</li>
<li><code>set_name(item_name)</code>: returns a boolean indicating whether the item was cleared.</li>
<li><code>get_count()</code>: Returns number of items on the stack.</li>
<li><code>set_count(count)</code>: returns a boolean indicating whether the item was cleared<ul>
<li><code>count</code>: number, unsigned 16 bit integer</li>
</ul>
</li>
<li><code>get_wear()</code>: returns tool wear (<code>0</code>-<code>65535</code>), <code>0</code> for non-tools.</li>
<li><code>set_wear(wear)</code>: returns boolean indicating whether item was cleared<ul>
<li><code>wear</code>: number, unsigned 16 bit integer</li>
</ul>
</li>
<li><code>get_meta()</code>: returns <a class="el" href="classItemStackMetaRef.html">ItemStackMetaRef</a>. See section for more details</li>
<li><code>get_metadata()</code>: (DEPRECATED) Returns metadata (a string attached to an item stack).</li>
<li><code>set_metadata(metadata)</code>: (DEPRECATED) Returns true.</li>
<li><code>get_description()</code>: returns the description shown in inventory list tooltips.<ul>
<li>The engine uses this when showing item descriptions in tooltips.</li>
<li>Fields for finding the description, in order:<ul>
<li><code>description</code> in item metadata (See [Item Metadata].)</li>
<li><code>description</code> in item definition</li>
<li>item name</li>
</ul>
</li>
</ul>
</li>
<li><code>get_short_description()</code>: returns the short description or nil.<ul>
<li>Unlike the description, this does not include new lines.</li>
<li>Fields for finding the short description, in order:<ul>
<li><code>short_description</code> in item metadata (See [Item Metadata].)</li>
<li><code>short_description</code> in item definition</li>
<li>first line of the description (From item meta or def, see <code>get_description()</code>.)</li>
<li>Returns nil if none of the above are set</li>
</ul>
</li>
</ul>
</li>
<li><code>clear()</code>: removes all items from the stack, making it empty.</li>
<li><code>replace(item)</code>: replace the contents of this stack.<ul>
<li><code>item</code> can also be an itemstring or table.</li>
</ul>
</li>
<li><code>to_string()</code>: returns the stack in itemstring form.</li>
<li><code>to_table()</code>: returns the stack in Lua table form.</li>
<li><code>get_stack_max()</code>: returns the maximum size of the stack (depends on the item).</li>
<li><code>get_free_space()</code>: returns <code>get_stack_max() - get_count()</code>.</li>
<li><code>is_known()</code>: returns <code>true</code> if the item name refers to a defined item type.</li>
<li><code>get_definition()</code>: returns the item definition table.</li>
<li><code>get_tool_capabilities()</code>: returns the digging properties of the item, or those of the hand if none are defined for this item type</li>
<li><code>add_wear(amount)</code><ul>
<li>Increases wear by <code>amount</code> if the item is a tool, otherwise does nothing</li>
<li>Valid <code>amount</code> range is [0,65536]</li>
<li><code>amount</code>: number, integer</li>
</ul>
</li>
<li><code>add_wear_by_uses(max_uses)</code><ul>
<li>Increases wear in such a way that, if only this function is called, the item breaks after <code>max_uses</code> times</li>
<li>Valid <code>max_uses</code> range is [0,65536]</li>
<li>Does nothing if item is not a tool or if <code>max_uses</code> is 0</li>
</ul>
</li>
<li><code>add_item(item)</code>: returns leftover <code><a class="el" href="structItemStack.html">ItemStack</a></code><ul>
<li>Put some item or stack onto this stack</li>
</ul>
</li>
<li><code>item_fits(item)</code>: returns <code>true</code> if item or stack can be fully added to this one.</li>
<li><code>take_item(n)</code>: returns taken <code><a class="el" href="structItemStack.html">ItemStack</a></code><ul>
<li>Take (and remove) up to <code>n</code> items from this stack</li>
<li><code>n</code>: number, default: <code>1</code></li>
</ul>
</li>
<li><code>peek_item(n)</code>: returns taken <code><a class="el" href="structItemStack.html">ItemStack</a></code><ul>
<li>Copy (don't remove) up to <code>n</code> items from this stack</li>
<li><code>n</code>: number, default: <code>1</code></li>
</ul>
</li>
<li><code>equals(other)</code>:<ul>
<li>returns <code>true</code> if this stack is identical to <code>other</code>.</li>
<li>Note: <code>stack1:to_string() == stack2:to_string()</code> is not reliable, as stack metadata can be serialized in arbitrary order.</li>
<li>Note: if <code>other</code> is an itemstring or table representation of an <a class="el" href="structItemStack.html">ItemStack</a>, this will always return false, even if it is "equivalent".</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1069"></a>
Operators</h3>
<ul>
<li><code>stack1 == stack2</code>:<ul>
<li>Returns whether <code>stack1</code> and <code>stack2</code> are identical.</li>
<li>Note: <code>stack1:to_string() == stack2:to_string()</code> is not reliable, as stack metadata can be serialized in arbitrary order.</li>
<li>Note: if <code>stack2</code> is an itemstring or table representation of an <a class="el" href="structItemStack.html">ItemStack</a>, this will always return false, even if it is "equivalent".</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1070"></a>
&lt;tt&gt;ItemStackMetaRef&lt;/tt&gt;</h2>
<p><a class="el" href="structItemStack.html">ItemStack</a> metadata: reference extra data and functionality stored in a stack. Can be obtained via <code>item:get_meta()</code>.</p>
<h3><a class="anchor" id="autotoc_md1071"></a>
Methods</h3>
<ul>
<li>All methods in <a class="el" href="classMetaDataRef.html">MetaDataRef</a></li>
<li><code>set_tool_capabilities([tool_capabilities])</code><ul>
<li>Overrides the item's tool capabilities</li>
<li>A nil value will clear the override data and restore the original behavior.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1072"></a>
&lt;tt&gt;MetaDataRef&lt;/tt&gt;</h2>
<p>Base class used by [<code><a class="el" href="classStorageRef.html">StorageRef</a></code>], [<code><a class="el" href="classNodeMetaRef.html">NodeMetaRef</a></code>], [<code><a class="el" href="classItemStackMetaRef.html">ItemStackMetaRef</a></code>], and [<code><a class="el" href="classPlayerMetaRef.html">PlayerMetaRef</a></code>].</p>
<p>Note: If a metadata value is in the format <code>${k}</code>, an attempt to get the value will return the value associated with key <code>k</code>. There is a low recursion limit. This behavior is <b>deprecated</b> and will be removed in a future version. Usage of the <code>${k}</code> syntax in formspecs is not deprecated.</p>
<h3><a class="anchor" id="autotoc_md1073"></a>
Methods</h3>
<ul>
<li><code>contains(key)</code>: Returns true if key present, otherwise false.<ul>
<li>Returns <code>nil</code> when the MetaData is inexistent.</li>
</ul>
</li>
<li><code>get(key)</code>: Returns <code>nil</code> if key not present, else the stored string.</li>
<li><code>set_string(key, value)</code>: <a class="el" href="unionValue.html">Value</a> of <code>""</code> will delete the key.</li>
<li><code>get_string(key)</code>: Returns <code>""</code> if key not present.</li>
<li><code>set_int(key, value)</code></li>
<li><code>get_int(key)</code>: Returns <code>0</code> if key not present.</li>
<li><code>set_float(key, value)</code></li>
<li><code>get_float(key)</code>: Returns <code>0</code> if key not present.</li>
<li><code>get_keys()</code>: returns a list of all keys in the metadata.</li>
<li><code>to_table()</code>:<ul>
<li>Returns a metadata table (see below) or <code>nil</code> on failure.</li>
</ul>
</li>
<li><code>from_table(data)</code><ul>
<li>Imports metadata from a metadata table</li>
<li>If <code>data</code> is a metadata table (see below), the metadata it represents will replace all metadata of this <a class="el" href="classMetaDataRef.html">MetaDataRef</a> object</li>
<li>Any non-table value for <code>data</code> will clear all metadata</li>
<li>Item table values the <code>inventory</code> field may also be itemstrings</li>
<li>Returns <code>true</code> on success</li>
</ul>
</li>
<li><code>equals(other)</code><ul>
<li>returns <code>true</code> if this metadata has the same key-value pairs as <code>other</code></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md1074"></a>
Metadata tables</h3>
<p>Metadata tables represent <a class="el" href="classMetaDataRef.html">MetaDataRef</a> in a Lua table form (see <code>from_table</code>/<code>to_table</code>).</p>
<p>A metadata table is a table that has the following keys:</p>
<ul>
<li><code>fields</code>: key-value storage of metadata fields<ul>
<li>all values are stored as strings</li>
<li>numbers must be converted to strings first</li>
</ul>
</li>
<li><code>inventory</code> (for <a class="el" href="classNodeMetaRef.html">NodeMetaRef</a> only): A node inventory in table form<ul>
<li>inventory table keys are inventory list names</li>
<li>inventory table values are item tables</li>
<li>item table keys are slot IDs (starting with 1)</li>
<li>item table values are ItemStacks</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line">metadata_table = {</div>
<div class="line">    -- metadata fields (key/value store)</div>
<div class="line">    fields = {</div>
<div class="line">        infotext = &quot;Container&quot;,</div>
<div class="line">        anoter_key = &quot;Another Value&quot;,</div>
<div class="line">    },</div>
<div class="line"> </div>
<div class="line">    -- inventory data (for nodes)</div>
<div class="line">    inventory = {</div>
<div class="line">        -- inventory list &quot;main&quot; with 4 slots</div>
<div class="line">        main = {</div>
<div class="line">            -- list of all item slots</div>
<div class="line">            [1] = &quot;example:dirt&quot;,</div>
<div class="line">            [2] = &quot;example:stone 25&quot;,</div>
<div class="line">            [3] = &quot;&quot;, -- empty slot</div>
<div class="line">            [4] = &quot;example:pickaxe&quot;,</div>
<div class="line">        },</div>
<div class="line">        -- inventory list &quot;hidden&quot; with 1 slot</div>
<div class="line">        hidden = {</div>
<div class="line">            [1] = &quot;example:diamond&quot;,</div>
<div class="line">        },</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1075"></a>
&lt;tt&gt;ModChannel&lt;/tt&gt;</h2>
<p>An interface to use mod channels on client and server</p>
<h3><a class="anchor" id="autotoc_md1076"></a>
Methods</h3>
<ul>
<li><code>leave()</code>: leave the mod channel.<ul>
<li><a class="el" href="classServer.html">Server</a> leaves channel <code>channel_name</code>.</li>
<li>No more incoming or outgoing messages can be sent to this channel from server mods.</li>
<li>This invalidate all future object usage.</li>
<li>Ensure you set mod_channel to nil after that to free Lua resources.</li>
</ul>
</li>
<li><code>is_writeable()</code>: returns true if channel is writeable and mod can send over it.</li>
<li><code>send_all(message)</code>: Send <code>message</code> though the mod channel.<ul>
<li>If mod channel is not writeable or invalid, message will be dropped.</li>
<li>Message size is limited to 65535 characters by protocol.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1077"></a>
&lt;tt&gt;NodeMetaRef&lt;/tt&gt;</h2>
<p><a class="el" href="structNode.html">Node</a> metadata: reference extra data and functionality stored in a node. Can be obtained via <code>minetest.get_meta(pos)</code>.</p>
<h3><a class="anchor" id="autotoc_md1078"></a>
Methods</h3>
<ul>
<li>All methods in <a class="el" href="classMetaDataRef.html">MetaDataRef</a></li>
<li><code>get_inventory()</code>: returns <code><a class="el" href="classInvRef.html">InvRef</a></code></li>
<li><code>mark_as_private(name or {name1, name2, ...})</code>: Mark specific vars as private This will prevent them from being sent to the client. Note that the "private" status will only be remembered if an associated key-value pair exists, meaning it's best to call this when initializing all other meta (e.g. <code>on_construct</code>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md1079"></a>
&lt;tt&gt;NodeTimerRef&lt;/tt&gt;</h2>
<p><a class="el" href="structNode.html">Node</a> Timers: a high resolution persistent per-node timer. Can be gotten via <code>minetest.get_node_timer(pos)</code>.</p>
<h3><a class="anchor" id="autotoc_md1080"></a>
Methods</h3>
<ul>
<li><code>set(timeout,elapsed)</code><ul>
<li>set a timer's state</li>
<li><code>timeout</code> is in seconds, and supports fractional values (0.1 etc)</li>
<li><code>elapsed</code> is in seconds, and supports fractional values (0.1 etc)</li>
<li>will trigger the node's <code>on_timer</code> function after <code>(timeout - elapsed)</code> seconds.</li>
</ul>
</li>
<li><code>start(timeout)</code><ul>
<li>start a timer</li>
<li>equivalent to <code>set(timeout,0)</code></li>
</ul>
</li>
<li><code>stop()</code><ul>
<li>stops the timer</li>
</ul>
</li>
<li><code>get_timeout()</code>: returns current timeout in seconds<ul>
<li>if <code>timeout</code> equals <code>0</code>, timer is inactive</li>
</ul>
</li>
<li><code>get_elapsed()</code>: returns current elapsed time in seconds<ul>
<li>the node's <code>on_timer</code> function will be called after <code>(timeout - elapsed)</code> seconds.</li>
</ul>
</li>
<li><code>is_started()</code>: returns boolean state of timer<ul>
<li>returns <code>true</code> if timer is started, otherwise <code>false</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1081"></a>
&lt;tt&gt;ObjectRef&lt;/tt&gt;</h2>
<p>Moving things in the game are generally these. This is basically a reference to a C++ <code><a class="el" href="classServerActiveObject.html">ServerActiveObject</a></code>.</p>
<h3><a class="anchor" id="autotoc_md1082"></a>
Advice on handling &lt;tt&gt;ObjectRefs&lt;/tt&gt;</h3>
<p>When you receive an <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> as a callback argument or from another API function, it is possible to store the reference somewhere and keep it around. It will keep functioning until the object is unloaded or removed.</p>
<p>However, doing this is <b>NOT</b> recommended as there is (intentionally) no method to test if a previously acquired <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> is still valid. Instead, <code>ObjectRefs</code> should be "let go" of as soon as control is returned from Lua back to the engine. Doing so is much less error-prone and you will never need to wonder if the object you are working with still exists.</p>
<h3><a class="anchor" id="autotoc_md1083"></a>
Attachments</h3>
<p>It is possible to attach objects to other objects (<code>set_attach</code> method).</p>
<p>When an object is attached, it is positioned relative to the parent's position and rotation. <code>get_pos</code> and <code>get_rotation</code> will always return the parent's values and changes via their setter counterparts are ignored.</p>
<p>To change position or rotation call <code>set_attach</code> again with the new values.</p>
<p><b>Note</b>: Just like model dimensions, the relative position in <code>set_attach</code> must be multiplied by 10 compared to world positions.</p>
<p>It is also possible to attach to a bone of the parent object. In that case the child will follow movement and rotation of that bone.</p>
<h3><a class="anchor" id="autotoc_md1084"></a>
Methods</h3>
<ul>
<li><code>get_pos()</code>: returns <code>{x=num, y=num, z=num}</code></li>
<li><code>set_pos(pos)</code>: <code>pos</code>=<code>{x=num, y=num, z=num}</code></li>
<li><code>get_velocity()</code>: returns the velocity, a vector.</li>
<li><code>add_velocity(vel)</code><ul>
<li><code>vel</code> is a vector, e.g. <code>{x=0.0, y=2.3, z=1.0}</code></li>
<li>In comparison to using get_velocity, adding the velocity and then using set_velocity, add_velocity is supposed to avoid synchronization problems. Additionally, players also do not support set_velocity.</li>
<li>If a player:<ul>
<li>Does not apply during free_move.</li>
<li>Note that since the player speed is normalized at each move step, increasing e.g. Y velocity beyond what would usually be achieved (see: physics overrides) will cause existing X/Z velocity to be reduced.</li>
<li>Example: <code>add_velocity({x=0, y=6.5, z=0})</code> is equivalent to pressing the jump key (assuming default settings)</li>
</ul>
</li>
</ul>
</li>
<li><code>move_to(pos, continuous=false)</code><ul>
<li>Does an interpolated move for Lua entities for visually smooth transitions.</li>
<li>If <code>continuous</code> is true, the Lua entity will not be moved to the current position before starting the interpolated move.</li>
<li>For players this does the same as <code>set_pos</code>,<code>continuous</code> is ignored.</li>
</ul>
</li>
<li><code>punch(puncher, time_from_last_punch, tool_capabilities, direction)</code><ul>
<li><code>puncher</code> = another <code><a class="el" href="classObjectRef.html">ObjectRef</a></code>,</li>
<li><code>time_from_last_punch</code> = time since last punch action of the puncher</li>
<li><code>direction</code>: can be <code>nil</code></li>
</ul>
</li>
<li><code>right_click(clicker)</code>; <code>clicker</code> is another <code><a class="el" href="classObjectRef.html">ObjectRef</a></code></li>
<li><code>get_hp()</code>: returns number of health points</li>
<li><code>set_hp(hp, reason)</code>: set number of health points<ul>
<li>See reason in register_on_player_hpchange</li>
<li>Is limited to the range of 0 ... 65535 (2^16 - 1)</li>
<li>For players: HP are also limited by <code>hp_max</code> specified in object properties</li>
</ul>
</li>
<li><code>get_inventory()</code>: returns an <code><a class="el" href="classInvRef.html">InvRef</a></code> for players, otherwise returns <code>nil</code></li>
<li><code>get_wield_list()</code>: returns the name of the inventory list the wielded item is in.</li>
<li><code>get_wield_index()</code>: returns the index of the wielded item</li>
<li><code>get_wielded_item()</code>: returns an <code><a class="el" href="structItemStack.html">ItemStack</a></code></li>
<li><code>set_wielded_item(item)</code>: replaces the wielded item, returns <code>true</code> if successful.</li>
<li><code>set_armor_groups({group1=rating, group2=rating, ...})</code></li>
<li><code>get_armor_groups()</code>: returns a table with the armor group ratings</li>
<li><code>set_animation(frame_range, frame_speed, frame_blend, frame_loop)</code><ul>
<li><code>frame_range</code>: table {x=num, y=num}, default: <code>{x=1, y=1}</code></li>
<li><code>frame_speed</code>: number, default: <code>15.0</code></li>
<li><code>frame_blend</code>: number, default: <code>0.0</code></li>
<li><code>frame_loop</code>: boolean, default: <code>true</code></li>
</ul>
</li>
<li><code>get_animation()</code>: returns <code>range</code>, <code>frame_speed</code>, <code>frame_blend</code> and <code>frame_loop</code>.</li>
<li><code>set_animation_frame_speed(frame_speed)</code><ul>
<li><code>frame_speed</code>: number, default: <code>15.0</code></li>
</ul>
</li>
<li><code>set_attach(parent[, bone, position, rotation, forced_visible])</code><ul>
<li><code>parent</code>: <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> to attach to</li>
<li><code>bone</code>: default <code>""</code> (the root bone)</li>
<li><code>position</code>: relative position, default <code>{x=0, y=0, z=0}</code></li>
<li><code>rotation</code>: relative rotation in degrees, default <code>{x=0, y=0, z=0}</code></li>
<li><code>forced_visible</code>: Boolean to control whether the attached entity should appear in first person, default <code>false</code>.</li>
<li>Please also read the [Attachments] section above.</li>
<li>This command may fail silently (do nothing) when it would result in circular attachments.</li>
</ul>
</li>
<li><code>get_attach()</code>: returns parent, bone, position, rotation, forced_visible, or nil if it isn't attached.</li>
<li><code>get_children()</code>: returns a list of ObjectRefs that are attached to the object.</li>
<li><code>set_detach()</code></li>
<li><code>set_bone_position([bone, position, rotation])</code><ul>
<li><code>bone</code>: string. Default is <code>""</code>, the root bone</li>
<li><code>position</code>: <code>{x=num, y=num, z=num}</code>, relative, <code>default {x=0, y=0, z=0}</code></li>
<li><code>rotation</code>: <code>{x=num, y=num, z=num}</code>, default <code>{x=0, y=0, z=0}</code></li>
</ul>
</li>
<li><code>get_bone_position(bone)</code>: returns position and rotation of the bone</li>
<li><code>set_properties(object property table)</code></li>
<li><code>get_properties()</code>: returns object property table</li>
<li><code>is_player()</code>: returns true for players, false otherwise</li>
<li><code>get_nametag_attributes()</code><ul>
<li>returns a table with the attributes of the nametag of an object</li>
<li>```lua { text = "", color = {a=0..255, r=0..255, g=0..255, b=0..255}, bgcolor = {a=0..255, r=0..255, g=0..255, b=0..255}, } ``<code> *</code>set_nametag_attributes(attributes)`</li>
<li>sets the attributes of the nametag of an object</li>
<li><code>attributes</code>: ```lua { text = "My Nametag", color = ColorSpec, &ndash; ^ Text color bgcolor = ColorSpec or false, &ndash; ^ Sets background color of nametag &ndash; <code>false</code> will cause the background to be set automatically based on user settings &ndash; Default: false } ```</li>
</ul>
</li>
</ul>
<h4><a class="anchor" id="autotoc_md1085"></a>
Lua entity only (no-op for other objects)</h4>
<ul>
<li><code>remove()</code>: remove object<ul>
<li>The object is removed after returning from Lua. However the <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> itself instantly becomes unusable with all further method calls having no effect and returning <code>nil</code>.</li>
</ul>
</li>
<li><code>set_velocity(vel)</code><ul>
<li><code>vel</code> is a vector, e.g. <code>{x=0.0, y=2.3, z=1.0}</code></li>
</ul>
</li>
<li><code>set_acceleration(acc)</code><ul>
<li><code>acc</code> is a vector</li>
</ul>
</li>
<li><code>get_acceleration()</code>: returns the acceleration, a vector</li>
<li><code>set_rotation(rot)</code><ul>
<li><code>rot</code> is a vector (radians). X is pitch (elevation), Y is yaw (heading) and Z is roll (bank).</li>
<li>Does not reset rotation incurred through <code>automatic_rotate</code>. Remove &amp; readd your objects to force a certain rotation.</li>
</ul>
</li>
<li><code>get_rotation()</code>: returns the rotation, a vector (radians)</li>
<li><code>set_yaw(yaw)</code>: sets the yaw in radians (heading).</li>
<li><code>get_yaw()</code>: returns number in radians</li>
<li><code>set_texture_mod(mod)</code><ul>
<li>Set a texture modifier to the base texture, for sprites and meshes.</li>
<li>When calling <code>set_texture_mod</code> again, the previous one is discarded.</li>
<li><code>mod</code> the texture modifier. See [Texture modifiers].</li>
</ul>
</li>
<li><code>get_texture_mod()</code> returns current texture modifier</li>
<li><code>set_sprite(start_frame, num_frames, framelength, select_x_by_camera)</code><ul>
<li>Specifies and starts a sprite animation</li>
<li>Animations iterate along the frame <code>y</code> position.</li>
<li><code>start_frame</code>: {x=column number, y=row number}, the coordinate of the first frame, default: <code>{x=0, y=0}</code></li>
<li><code>num_frames</code>: Total frames in the texture, default: <code>1</code></li>
<li><code>framelength</code>: Time per animated frame in seconds, default: <code>0.2</code></li>
<li><code>select_x_by_camera</code>: Only for visual = <code>sprite</code>. Changes the frame <code>x</code> position according to the view direction. default: <code>false</code>.<ul>
<li>First column: subject facing the camera</li>
<li>Second column: subject looking to the left</li>
<li>Third column: subject backing the camera</li>
<li>Fourth column: subject looking to the right</li>
<li>Fifth column: subject viewed from above</li>
<li>Sixth column: subject viewed from below</li>
</ul>
</li>
</ul>
</li>
<li><code>get_entity_name()</code> (<b>Deprecated</b>: Will be removed in a future version, use the field <code>self.name</code> instead)</li>
<li><code>get_luaentity()</code></li>
</ul>
<h4><a class="anchor" id="autotoc_md1086"></a>
Player only (no-op for other objects)</h4>
<ul>
<li><code>get_player_name()</code>: returns <code>""</code> if is not a player</li>
<li><code>get_player_velocity()</code>: <b>DEPRECATED</b>, use get_velocity() instead. table {x, y, z} representing the player's instantaneous velocity in nodes/s</li>
<li><code>add_player_velocity(vel)</code>: <b>DEPRECATED</b>, use add_velocity(vel) instead.</li>
<li><code>get_look_dir()</code>: get camera direction as a unit vector</li>
<li><code>get_look_vertical()</code>: pitch in radians<ul>
<li>Angle ranges between -pi/2 and pi/2, which are straight up and down respectively.</li>
</ul>
</li>
<li><code>get_look_horizontal()</code>: yaw in radians<ul>
<li>Angle is counter-clockwise from the +z direction.</li>
</ul>
</li>
<li><code>set_look_vertical(radians)</code>: sets look pitch<ul>
<li>radians: Angle from looking forward, where positive is downwards.</li>
</ul>
</li>
<li><code>set_look_horizontal(radians)</code>: sets look yaw<ul>
<li>radians: Angle from the +z direction, where positive is counter-clockwise.</li>
</ul>
</li>
<li><code>get_look_pitch()</code>: pitch in radians - Deprecated as broken. Use <code>get_look_vertical</code>.<ul>
<li>Angle ranges between -pi/2 and pi/2, which are straight down and up respectively.</li>
</ul>
</li>
<li><code>get_look_yaw()</code>: yaw in radians - Deprecated as broken. Use <code>get_look_horizontal</code>.<ul>
<li>Angle is counter-clockwise from the +x direction.</li>
</ul>
</li>
<li><code>set_look_pitch(radians)</code>: sets look pitch - Deprecated. Use <code>set_look_vertical</code>.</li>
<li><code>set_look_yaw(radians)</code>: sets look yaw - Deprecated. Use <code>set_look_horizontal</code>.</li>
<li><code>get_breath()</code>: returns player's breath</li>
<li><code>set_breath(value)</code>: sets player's breath<ul>
<li>values:<ul>
<li><code>0</code>: player is drowning</li>
<li>max: bubbles bar is not shown</li>
<li>See [Object properties] for more information</li>
</ul>
</li>
<li>Is limited to range 0 ... 65535 (2^16 - 1)</li>
</ul>
</li>
<li><code>set_fov(fov, is_multiplier, transition_time)</code>: Sets player's FOV<ul>
<li><code>fov</code>: FOV value.</li>
<li><code>is_multiplier</code>: Set to <code>true</code> if the FOV value is a multiplier. Defaults to <code>false</code>.</li>
<li><code>transition_time</code>: If defined, enables smooth FOV transition. Interpreted as the time (in seconds) to reach target FOV. If set to 0, FOV change is instantaneous. Defaults to 0.</li>
<li>Set <code>fov</code> to 0 to clear FOV override.</li>
</ul>
</li>
<li><code>get_fov()</code>: Returns the following:<ul>
<li>Server-sent FOV value. Returns 0 if an FOV override doesn't exist.</li>
<li>Boolean indicating whether the FOV value is a multiplier.</li>
<li>Time (in seconds) taken for the FOV transition. Set by <code>set_fov</code>.</li>
</ul>
</li>
<li><code>set_attribute(attribute, value)</code>: DEPRECATED, use get_meta() instead<ul>
<li>Sets an extra attribute with value on player.</li>
<li><code>value</code> must be a string, or a number which will be converted to a string.</li>
<li>If <code>value</code> is <code>nil</code>, remove attribute from player.</li>
</ul>
</li>
<li><code>get_attribute(attribute)</code>: DEPRECATED, use get_meta() instead<ul>
<li>Returns value (a string) for extra attribute.</li>
<li>Returns <code>nil</code> if no attribute found.</li>
</ul>
</li>
<li><code>get_meta()</code>: Returns a <a class="el" href="classPlayerMetaRef.html">PlayerMetaRef</a>.</li>
<li><code>set_inventory_formspec(formspec)</code><ul>
<li>Redefine player's inventory form</li>
<li>Should usually be called in <code>on_joinplayer</code></li>
<li>If <code>formspec</code> is <code>""</code>, the player's inventory is disabled.</li>
</ul>
</li>
<li><code>get_inventory_formspec()</code>: returns a formspec string</li>
<li><code>set_formspec_prepend(formspec)</code>:<ul>
<li>the formspec string will be added to every formspec shown to the user, except for those with a no_prepend[] tag.</li>
<li>This should be used to set style elements such as background[] and bgcolor[], any non-style elements (eg: label) may result in weird behavior.</li>
<li>Only affects formspecs shown after this is called.</li>
</ul>
</li>
<li><code>get_formspec_prepend()</code>: returns a formspec string.</li>
<li><code>get_player_control()</code>: returns table with player pressed keys<ul>
<li>The table consists of fields with the following boolean values representing the pressed keys: <code>up</code>, <code>down</code>, <code>left</code>, <code>right</code>, <code>jump</code>, <code>aux1</code>, <code>sneak</code>, <code>dig</code>, <code>place</code>, <code>LMB</code>, <code>RMB</code>, and <code>zoom</code>.</li>
<li>The fields <code>LMB</code> and <code>RMB</code> are equal to <code>dig</code> and <code>place</code> respectively, and exist only to preserve backwards compatibility.</li>
<li>Returns an empty table <code>{}</code> if the object is not a player.</li>
</ul>
</li>
<li><code>get_player_control_bits()</code>: returns integer with bit packed player pressed keys.<ul>
<li>Bits:<ul>
<li>0 - up</li>
<li>1 - down</li>
<li>2 - left</li>
<li>3 - right</li>
<li>4 - jump</li>
<li>5 - aux1</li>
<li>6 - sneak</li>
<li>7 - dig</li>
<li>8 - place</li>
<li>9 - zoom</li>
</ul>
</li>
<li>Returns <code>0</code> (no bits set) if the object is not a player.</li>
</ul>
</li>
<li><code>set_physics_override(override_table)</code><ul>
<li><code>override_table</code> is a table with the following fields:<ul>
<li><code>speed</code>: multiplier to default walking speed value (default: <code>1</code>)</li>
<li><code>jump</code>: multiplier to default jump value (default: <code>1</code>)</li>
<li><code>gravity</code>: multiplier to default gravity value (default: <code>1</code>)</li>
<li><code>sneak</code>: whether player can sneak (default: <code>true</code>)</li>
<li><code>sneak_glitch</code>: whether player can use the new move code replications of the old sneak side-effects: sneak ladders and 2 node sneak jump (default: <code>false</code>)</li>
<li><code>new_move</code>: use new move/sneak code. When <code>false</code> the exact old code is used for the specific old sneak behavior (default: <code>true</code>)</li>
</ul>
</li>
</ul>
</li>
<li><code>get_physics_override()</code>: returns the table given to <code>set_physics_override</code></li>
<li><code>hud_add(hud definition)</code>: add a HUD element described by HUD def, returns ID number on success</li>
<li><code>hud_remove(id)</code>: remove the HUD element of the specified id</li>
<li><code>hud_change(id, stat, value)</code>: change a value of a previously added HUD element.<ul>
<li><code>stat</code> supports the same keys as in the hud definition table except for <code>"hud_elem_type"</code>.</li>
</ul>
</li>
<li><code>hud_get(id)</code>: gets the HUD element definition structure of the specified ID</li>
<li><code>hud_set_flags(flags)</code>: sets specified HUD flags of player.<ul>
<li><code>flags</code>: A table with the following fields set to boolean values<ul>
<li><code>hotbar</code></li>
<li><code>healthbar</code></li>
<li><code>crosshair</code></li>
<li><code>wielditem</code></li>
<li><code>breathbar</code></li>
<li><code>minimap</code>: Modifies the client's permission to view the minimap. The client may locally elect to not view the minimap.</li>
<li><code>minimap_radar</code>: is only usable when <code>minimap</code> is true</li>
<li><code>basic_debug</code>: Allow showing basic debug info that might give a gameplay advantage. This includes map seed, player position, look direction, the pointed node and block bounds. Does not affect players with the <code>debug</code> privilege.</li>
<li><code>chat</code>: Modifies the client's permission to view chat on the HUD. The client may locally elect to not view chat. Does not affect the console.</li>
</ul>
</li>
<li>If a flag equals <code>nil</code>, the flag is not modified</li>
</ul>
</li>
<li><code>hud_get_flags()</code>: returns a table of player HUD flags with boolean values.<ul>
<li>See <code>hud_set_flags</code> for a list of flags that can be toggled.</li>
</ul>
</li>
<li><code>hud_set_hotbar_itemcount(count)</code>: sets number of items in builtin hotbar<ul>
<li><code>count</code>: number of items, must be between <code>1</code> and <code>32</code></li>
</ul>
</li>
<li><code>hud_get_hotbar_itemcount()</code>: returns number of visible items</li>
<li><code>hud_set_hotbar_image(texturename)</code><ul>
<li>sets background image for hotbar</li>
</ul>
</li>
<li><code>hud_get_hotbar_image()</code>: returns texturename</li>
<li><code>hud_set_hotbar_selected_image(texturename)</code><ul>
<li>sets image for selected item of hotbar</li>
</ul>
</li>
<li><code>hud_get_hotbar_selected_image()</code>: returns texturename</li>
<li><code>set_minimap_modes({mode, mode, ...}, selected_mode)</code><ul>
<li>Overrides the available minimap modes (and toggle order), and changes the selected mode.</li>
<li><code>mode</code> is a table consisting of up to four fields:<ul>
<li><code>type</code>: Available type:<ul>
<li><code>off</code>: <a class="el" href="classMinimap.html">Minimap</a> off</li>
<li><code>surface</code>: <a class="el" href="classMinimap.html">Minimap</a> in surface mode</li>
<li><code>radar</code>: <a class="el" href="classMinimap.html">Minimap</a> in radar mode</li>
<li><code>texture</code>: Texture to be displayed instead of terrain map (texture is centered around 0,0 and can be scaled). Texture size is limited to 512 x 512 pixel.</li>
</ul>
</li>
<li><code>label</code>: <a class="el" href="classOptional.html">Optional</a> label to display on minimap mode toggle The translation must be handled within the mod.</li>
<li><code>size</code>: Sidelength or diameter, in number of nodes, of the terrain displayed in minimap</li>
<li><code>texture</code>: Only for texture type, name of the texture to display</li>
<li><code>scale</code>: Only for texture type, scale of the texture map in nodes per pixel (for example a <code>scale</code> of 2 means each pixel represents a 2x2 nodes square)</li>
</ul>
</li>
<li><code>selected_mode</code> is the mode index to be selected after modes have been changed (0 is the first mode).</li>
</ul>
</li>
<li><code>set_sky(sky_parameters)</code><ul>
<li>The presence of the function <code>set_sun</code>, <code>set_moon</code> or <code>set_stars</code> indicates whether <code>set_sky</code> accepts this format. Check the legacy format otherwise.</li>
<li>Passing no arguments resets the sky to its default values.</li>
<li><code>sky_parameters</code> is a table with the following optional fields:<ul>
<li><code>base_color</code>: ColorSpec, changes fog in "skybox" and "plain". (default: <code>#ffffff</code>)</li>
<li><code>body_orbit_tilt</code>: Float, rotation angle of sun/moon orbit in degrees. By default, orbit is controlled by a client-side setting, and this field is not set. After a value is assigned, it can only be changed to another float value. Valid range [-60.0,60.0] (default: not set)</li>
<li><code>type</code>: Available types:<ul>
<li><code>"regular"</code>: Uses 0 textures, <code>base_color</code> ignored</li>
<li><code>"skybox"</code>: Uses 6 textures, <code>base_color</code> used as fog.</li>
<li><code>"plain"</code>: Uses 0 textures, <code>base_color</code> used as both fog and sky. (default: <code>"regular"</code>)</li>
</ul>
</li>
<li><code>textures</code>: A table containing up to six textures in the following order: Y+ (top), Y- (bottom), X- (west), X+ (east), Z+ (north), Z- (south).</li>
<li><code>clouds</code>: Boolean for whether clouds appear. (default: <code>true</code>)</li>
<li><code>sky_color</code>: A table used in <code>"regular"</code> type only, containing the following values (alpha is ignored):<ul>
<li><code>day_sky</code>: ColorSpec, for the top half of the sky during the day. (default: <code>#61b5f5</code>)</li>
<li><code>day_horizon</code>: ColorSpec, for the bottom half of the sky during the day. (default: <code>#90d3f6</code>)</li>
<li><code>dawn_sky</code>: ColorSpec, for the top half of the sky during dawn/sunset. (default: <code>#b4bafa</code>) The resulting sky color will be a darkened version of the ColorSpec. Warning: The darkening of the ColorSpec is subject to change.</li>
<li><code>dawn_horizon</code>: ColorSpec, for the bottom half of the sky during dawn/sunset. (default: <code>#bac1f0</code>) The resulting sky color will be a darkened version of the ColorSpec. Warning: The darkening of the ColorSpec is subject to change.</li>
<li><code>night_sky</code>: ColorSpec, for the top half of the sky during the night. (default: <code>#006bff</code>) The resulting sky color will be a dark version of the ColorSpec. Warning: The darkening of the ColorSpec is subject to change.</li>
<li><code>night_horizon</code>: ColorSpec, for the bottom half of the sky during the night. (default: <code>#4090ff</code>) The resulting sky color will be a dark version of the ColorSpec. Warning: The darkening of the ColorSpec is subject to change.</li>
<li><code>indoors</code>: ColorSpec, for when you're either indoors or underground. (default: <code>#646464</code>)</li>
<li><code>fog_sun_tint</code>: ColorSpec, changes the fog tinting for the sun at sunrise and sunset. (default: <code>#f47d1d</code>)</li>
<li><code>fog_moon_tint</code>: ColorSpec, changes the fog tinting for the moon at sunrise and sunset. (default: <code>#7f99cc</code>)</li>
<li><code>fog_tint_type</code>: string, changes which mode the directional fog abides by, <code>"custom"</code> uses <code>sun_tint</code> and <code>moon_tint</code>, while <code>"default"</code> uses the classic Minetest sun and moon tinting. Will use tonemaps, if set to <code>"default"</code>. (default: <code>"default"</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>set_sky(base_color, type, {texture names}, clouds)</code><ul>
<li>Deprecated. Use <code>set_sky(sky_parameters)</code></li>
<li><code>base_color</code>: ColorSpec, defaults to white</li>
<li><code>type</code>: Available types:<ul>
<li><code>"regular"</code>: Uses 0 textures, <code>bgcolor</code> ignored</li>
<li><code>"skybox"</code>: Uses 6 textures, <code>bgcolor</code> used</li>
<li><code>"plain"</code>: Uses 0 textures, <code>bgcolor</code> used</li>
</ul>
</li>
<li><code>clouds</code>: Boolean for whether clouds appear in front of <code>"skybox"</code> or <code>"plain"</code> custom skyboxes (default: <code>true</code>)</li>
</ul>
</li>
<li><code>get_sky(as_table)</code>:<ul>
<li><code>as_table</code>: boolean that determines whether the deprecated version of this function is being used.<ul>
<li><code>true</code> returns a table containing sky parameters as defined in <code>set_sky(sky_parameters)</code>.</li>
<li>Deprecated: <code>false</code> or <code>nil</code> returns base_color, type, table of textures, clouds.</li>
</ul>
</li>
</ul>
</li>
<li><code>get_sky_color()</code>:<ul>
<li>Deprecated: Use <code>get_sky(as_table)</code> instead.</li>
<li>returns a table with the <code>sky_color</code> parameters as in <code>set_sky</code>.</li>
</ul>
</li>
<li><code>set_sun(sun_parameters)</code>:<ul>
<li>Passing no arguments resets the sun to its default values.</li>
<li><code>sun_parameters</code> is a table with the following optional fields:<ul>
<li><code>visible</code>: Boolean for whether the sun is visible. (default: <code>true</code>)</li>
<li><code>texture</code>: A regular texture for the sun. Setting to <code>""</code> will re-enable the mesh sun. (default: "sun.png", if it exists) The texture appears non-rotated at sunrise and rotated 180 degrees (upside down) at sunset.</li>
<li><code>tonemap</code>: A 512x1 texture containing the tonemap for the sun (default: <code>"sun_tonemap.png"</code>)</li>
<li><code>sunrise</code>: A regular texture for the sunrise texture. (default: <code>"sunrisebg.png"</code>)</li>
<li><code>sunrise_visible</code>: Boolean for whether the sunrise texture is visible. (default: <code>true</code>)</li>
<li><code>scale</code>: Float controlling the overall size of the sun. (default: <code>1</code>) Note: For legacy reasons, the sun is bigger than the moon by a factor of about <code>1.57</code> for equal <code>scale</code> values.</li>
</ul>
</li>
</ul>
</li>
<li><code>get_sun()</code>: returns a table with the current sun parameters as in <code>set_sun</code>.</li>
<li><code>set_moon(moon_parameters)</code>:<ul>
<li>Passing no arguments resets the moon to its default values.</li>
<li><code>moon_parameters</code> is a table with the following optional fields:<ul>
<li><code>visible</code>: Boolean for whether the moon is visible. (default: <code>true</code>)</li>
<li><code>texture</code>: A regular texture for the moon. Setting to <code>""</code> will re-enable the mesh moon. (default: <code>"moon.png"</code>, if it exists) The texture appears non-rotated at sunrise / moonset and rotated 180 degrees (upside down) at sunset / moonrise. Note: Relative to the sun, the moon texture is hence rotated by 180°. You can use the <code>^[transformR180</code> texture modifier to achieve the same orientation.</li>
<li><code>tonemap</code>: A 512x1 texture containing the tonemap for the moon (default: <code>"moon_tonemap.png"</code>)</li>
<li><code>scale</code>: Float controlling the overall size of the moon (default: <code>1</code>) Note: For legacy reasons, the sun is bigger than the moon by a factor of about <code>1.57</code> for equal <code>scale</code> values.</li>
</ul>
</li>
</ul>
</li>
<li><code>get_moon()</code>: returns a table with the current moon parameters as in <code>set_moon</code>.</li>
<li><code>set_stars(star_parameters)</code>:<ul>
<li>Passing no arguments resets stars to their default values.</li>
<li><code>star_parameters</code> is a table with the following optional fields:<ul>
<li><code>visible</code>: Boolean for whether the stars are visible. (default: <code>true</code>)</li>
<li><code>day_opacity</code>: Float for maximum opacity of stars at day. No effect if <code>visible</code> is false. (default: 0.0; maximum: 1.0; minimum: 0.0)</li>
<li><code>count</code>: Integer number to set the number of stars in the skybox. Only applies to <code>"skybox"</code> and <code>"regular"</code> sky types. (default: <code>1000</code>)</li>
<li><code>star_color</code>: ColorSpec, sets the colors of the stars, alpha channel is used to set overall star brightness. (default: <code>#ebebff69</code>)</li>
<li><code>scale</code>: Float controlling the overall size of the stars (default: <code>1</code>)</li>
</ul>
</li>
</ul>
</li>
<li><code>get_stars()</code>: returns a table with the current stars parameters as in <code>set_stars</code>.</li>
<li><code>set_clouds(cloud_parameters)</code>: set cloud parameters<ul>
<li>Passing no arguments resets clouds to their default values.</li>
<li><code>cloud_parameters</code> is a table with the following optional fields:<ul>
<li><code>density</code>: from <code>0</code> (no clouds) to <code>1</code> (full clouds) (default <code>0.4</code>)</li>
<li><code>color</code>: basic cloud color with alpha channel, ColorSpec (default <code>#fff0f0e5</code>).</li>
<li><code>ambient</code>: cloud color lower bound, use for a "glow at night" effect. ColorSpec (alpha ignored, default <code>#000000</code>)</li>
<li><code>height</code>: cloud height, i.e. y of cloud base (default per conf, usually <code>120</code>)</li>
<li><code>thickness</code>: cloud thickness in nodes (default <code>16</code>)</li>
<li><code>speed</code>: 2D cloud speed + direction in nodes per second (default <code>{x=0, z=-2}</code>).</li>
</ul>
</li>
</ul>
</li>
<li><code>get_clouds()</code>: returns a table with the current cloud parameters as in <code>set_clouds</code>.</li>
<li><code>override_day_night_ratio(ratio or nil)</code><ul>
<li><code>0</code>...<code>1</code>: Overrides day-night ratio, controlling sunlight to a specific amount.</li>
<li>Passing no arguments disables override, defaulting to sunlight based on day-night cycle</li>
</ul>
</li>
<li><code>get_day_night_ratio()</code>: returns the ratio or nil if it isn't overridden</li>
<li><code>set_local_animation(idle, walk, dig, walk_while_dig, frame_speed)</code>: set animation for player model in third person view.<ul>
<li>Every animation equals to a <code>{x=starting frame, y=ending frame}</code> table.</li>
<li><code>frame_speed</code> sets the animations frame speed. Default is 30.</li>
</ul>
</li>
<li><code>get_local_animation()</code>: returns idle, walk, dig, walk_while_dig tables and <code>frame_speed</code>.</li>
<li><code>set_eye_offset([firstperson, thirdperson])</code>: defines offset vectors for camera per player. An argument defaults to <code>{x=0, y=0, z=0}</code> if unspecified.<ul>
<li>in first person view</li>
<li>in third person view (max. values <code>{x=-10/10,y=-10,15,z=-5/5}</code>)</li>
</ul>
</li>
<li><code>get_eye_offset()</code>: returns first and third person offsets.</li>
<li><code>send_mapblock(blockpos)</code>:<ul>
<li>Sends an already loaded mapblock to the player.</li>
<li>Returns <code>false</code> if nothing was sent (note that this can also mean that the client already has the block)</li>
<li>Resource intensive - use sparsely</li>
</ul>
</li>
<li><code>set_lighting(light_definition)</code>: sets lighting for the player<ul>
<li>Passing no arguments resets lighting to its default values.</li>
<li><code>light_definition</code> is a table with the following optional fields:<ul>
<li><code>saturation</code> sets the saturation (vividness; default: <code>1.0</code>). values &gt; 1 increase the saturation values in [0,1) decrease the saturation<ul>
<li>This value has no effect on clients who have the "Tone Mapping" shader disabled.</li>
</ul>
</li>
<li><code>shadows</code> is a table that controls ambient shadows<ul>
<li><code>intensity</code> sets the intensity of the shadows from 0 (no shadows, default) to 1 (blackness)<ul>
<li>This value has no effect on clients who have the "Dynamic Shadows" shader disabled.</li>
</ul>
</li>
</ul>
</li>
<li><code>exposure</code> is a table that controls automatic exposure. The basic exposure factor equation is <code>e = 2^exposure_correction / clamp(luminance, 2^luminance_min, 2^luminance_max)</code><ul>
<li><code>luminance_min</code> set the lower luminance boundary to use in the calculation (default: <code>-3.0</code>)</li>
<li><code>luminance_max</code> set the upper luminance boundary to use in the calculation (default: <code>-3.0</code>)</li>
<li><code>exposure_correction</code> correct observed exposure by the given EV value (default: <code>0.0</code>)</li>
<li><code>speed_dark_bright</code> set the speed of adapting to bright light (default: <code>1000.0</code>)</li>
<li><code>speed_bright_dark</code> set the speed of adapting to dark scene (default: <code>1000.0</code>)</li>
<li><code>center_weight_power</code> set the power factor for center-weighted luminance measurement (default: <code>1.0</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>get_lighting()</code>: returns the current state of lighting for the player.<ul>
<li>Result is a table with the same fields as <code>light_definition</code> in <code>set_lighting</code>.</li>
</ul>
</li>
<li><code>respawn()</code>: Respawns the player using the same mechanism as the death screen, including calling on_respawnplayer callbacks.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1087"></a>
&lt;tt&gt;PcgRandom&lt;/tt&gt;</h2>
<p>A 32-bit pseudorandom number generator. Uses PCG32, an algorithm of the permuted congruential generator family, offering very strong randomness.</p>
<p>It can be created via <code><a class="el" href="classPcgRandom.html">PcgRandom(seed)</a></code> or <code><a class="el" href="classPcgRandom.html">PcgRandom(seed, sequence)</a></code>.</p>
<h3><a class="anchor" id="autotoc_md1088"></a>
Methods</h3>
<ul>
<li><code>next()</code>: return next integer random number [<code>-2147483648</code>...<code>2147483647</code>]</li>
<li><code>next(min, max)</code>: return next integer random number [<code>min</code>...<code>max</code>]</li>
<li><code>rand_normal_dist(min, max, num_trials=6)</code>: return normally distributed random number [<code>min</code>...<code>max</code>].<ul>
<li>This is only a rough approximation of a normal distribution with:</li>
<li><code>mean = (max - min) / 2</code>, and</li>
<li><code>variance = (((max - min + 1) ^ 2) - 1) / (12 * num_trials)</code></li>
<li>Increasing <code>num_trials</code> improves accuracy of the approximation</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1089"></a>
&lt;tt&gt;PerlinNoise&lt;/tt&gt;</h2>
<p>A perlin noise generator. It can be created via <code>PerlinNoise()</code> or <code>minetest.get_perlin()</code>. For <code>minetest.get_perlin()</code>, the actual seed used is the noiseparams seed plus the world seed, to create world-specific noise.</p>
<p><code>PerlinNoise(noiseparams)</code> <code>PerlinNoise(seed, octaves, persistence, spread)</code> (Deprecated).</p>
<p><code>minetest.get_perlin(noiseparams)</code> <code>minetest.get_perlin(seeddiff, octaves, persistence, spread)</code> (Deprecated).</p>
<h3><a class="anchor" id="autotoc_md1090"></a>
Methods</h3>
<ul>
<li><code>get_2d(pos)</code>: returns 2D noise value at <code>pos={x=,y=}</code></li>
<li><code>get_3d(pos)</code>: returns 3D noise value at <code>pos={x=,y=,z=}</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md1091"></a>
&lt;tt&gt;PerlinNoiseMap&lt;/tt&gt;</h2>
<p>A fast, bulk perlin noise generator.</p>
<p>It can be created via <code>PerlinNoiseMap(noiseparams, size)</code> or <code>minetest.get_perlin_map(noiseparams, size)</code>. For <code>minetest.get_perlin_map()</code>, the actual seed used is the noiseparams seed plus the world seed, to create world-specific noise.</p>
<p>Format of <code>size</code> is <code>{x=dimx, y=dimy, z=dimz}</code>. The <code>z</code> component is omitted for 2D noise, and it must be must be larger than 1 for 3D noise (otherwise <code>nil</code> is returned).</p>
<p>For each of the functions with an optional <code>buffer</code> parameter: If <code>buffer</code> is not nil, this table will be used to store the result instead of creating a new table.</p>
<h3><a class="anchor" id="autotoc_md1092"></a>
Methods</h3>
<ul>
<li><code>get_2d_map(pos)</code>: returns a <code>&lt;size.x&gt;</code> times <code>&lt;size.y&gt;</code> 2D array of 2D noise with values starting at <code>pos={x=,y=}</code></li>
<li><code>get_3d_map(pos)</code>: returns a <code>&lt;size.x&gt;</code> times <code>&lt;size.y&gt;</code> times <code>&lt;size.z&gt;</code> 3D array of 3D noise with values starting at <code>pos={x=,y=,z=}</code>.</li>
<li><code>get_2d_map_flat(pos, buffer)</code>: returns a flat <code>&lt;size.x * size.y&gt;</code> element array of 2D noise with values starting at <code>pos={x=,y=}</code></li>
<li><code>get_3d_map_flat(pos, buffer)</code>: Same as <code>get2dMap_flat</code>, but 3D noise</li>
<li><code>calc_2d_map(pos)</code>: Calculates the 2d noise map starting at <code>pos</code>. The result is stored internally.</li>
<li><code>calc_3d_map(pos)</code>: Calculates the 3d noise map starting at <code>pos</code>. The result is stored internally.</li>
<li><code>get_map_slice(slice_offset, slice_size, buffer)</code>: In the form of an array, returns a slice of the most recently computed noise results. The result slice begins at coordinates <code>slice_offset</code> and takes a chunk of <code>slice_size</code>. E.g. to grab a 2-slice high horizontal 2d plane of noise starting at buffer offset y = 20: <code>noisevals = noise:get_map_slice({y=20}, {y=2})</code> It is important to note that <code>slice_offset</code> offset coordinates begin at 1, and are relative to the starting position of the most recently calculated noise. To grab a single vertical column of noise starting at map coordinates x = 1023, y=1000, z = 1000: <code>noise:calc_3d_map({x=1000, y=1000, z=1000})</code> <code>noisevals = noise:get_map_slice({x=24, z=1}, {x=1, z=1})</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md1093"></a>
&lt;tt&gt;PlayerMetaRef&lt;/tt&gt;</h2>
<p><a class="el" href="classPlayer.html">Player</a> metadata. Uses the same method of storage as the deprecated player attribute API, so data there will also be in player meta. Can be obtained using <code>player:get_meta()</code>.</p>
<h3><a class="anchor" id="autotoc_md1094"></a>
Methods</h3>
<ul>
<li>All methods in <a class="el" href="classMetaDataRef.html">MetaDataRef</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md1095"></a>
&lt;tt&gt;PseudoRandom&lt;/tt&gt;</h2>
<p>A 16-bit pseudorandom number generator. Uses a well-known LCG algorithm introduced by K&amp;R.</p>
<p>It can be created via <code><a class="el" href="classPseudoRandom.html">PseudoRandom(seed)</a></code>.</p>
<h3><a class="anchor" id="autotoc_md1096"></a>
Methods</h3>
<ul>
<li><code>next()</code>: return next integer random number [<code>0</code>...<code>32767</code>]</li>
<li><code>next(min, max)</code>: return next integer random number [<code>min</code>...<code>max</code>]<ul>
<li><code>((max - min) == 32767) or ((max-min) &lt;= 6553))</code> must be true due to the simple implementation making bad distribution otherwise.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1097"></a>
&lt;tt&gt;Raycast&lt;/tt&gt;</h2>
<p>A raycast on the map. It works with selection boxes. Can be used as an iterator in a for loop as:</p>
<div class="fragment"><div class="line">local ray = Raycast(...)</div>
<div class="line">for pointed_thing in ray do</div>
<div class="line">    ...</div>
<div class="line">end</div>
</div><!-- fragment --><p>The map is loaded as the ray advances. If the map is modified after the <code>Raycast</code> is created, the changes may or may not have an effect on the object.</p>
<p>It can be created via <code>Raycast(pos1, pos2, objects, liquids)</code> or <code>minetest.raycast(pos1, pos2, objects, liquids)</code> where:</p>
<ul>
<li><code>pos1</code>: start of the ray</li>
<li><code>pos2</code>: end of the ray</li>
<li><code>objects</code>: if false, only nodes will be returned. Default is true.</li>
<li><code>liquids</code>: if false, liquid nodes (<code>liquidtype ~= "none"</code>) won't be returned. Default is false.</li>
</ul>
<h3><a class="anchor" id="autotoc_md1098"></a>
Limitations</h3>
<p>Raycasts don't always work properly for attached objects as the server has no knowledge of models &amp; bones.</p>
<p><b>Rotated selectionboxes paired with <code>automatic_rotate</code> are not reliable</b> either since the server can't reliably know the total rotation of the objects on different clients (which may differ on a per-client basis). The server calculates the total rotation incurred through <code>automatic_rotate</code> as a "best guess" assuming the object was active &amp; rotating on the client all the time since its creation. This may be significantly out of sync with what clients see. Additionally, network latency and delayed property sending may create a mismatch of client- &amp; server rotations.</p>
<p>In singleplayer mode, raycasts on objects with rotated selectionboxes &amp; automatic rotate will usually only be slightly off; toggling automatic rotation may however cause errors to add up.</p>
<p>In multiplayer mode, the error may be arbitrarily large.</p>
<h3><a class="anchor" id="autotoc_md1099"></a>
Methods</h3>
<ul>
<li><code>next()</code>: returns a <code>pointed_thing</code> with exact pointing location<ul>
<li>Returns the next thing pointed by the ray or nil.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1100"></a>
&lt;tt&gt;SecureRandom&lt;/tt&gt;</h2>
<p>Interface for the operating system's crypto-secure PRNG.</p>
<p>It can be created via <code>SecureRandom()</code>. The constructor returns nil if a secure random device cannot be found on the system.</p>
<h3><a class="anchor" id="autotoc_md1101"></a>
Methods</h3>
<ul>
<li><code>next_bytes([count])</code>: return next <code>count</code> (default 1, capped at 2048) many random bytes, as a string.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1102"></a>
&lt;tt&gt;Settings&lt;/tt&gt;</h2>
<p>An interface to read config files in the format of <code>minetest.conf</code>.</p>
<p>It can be created via <code><a class="el" href="classSettings.html">Settings(filename)</a></code>.</p>
<h3><a class="anchor" id="autotoc_md1103"></a>
Methods</h3>
<ul>
<li><code>get(key)</code>: returns a value</li>
<li><code>get_bool(key, [default])</code>: returns a boolean<ul>
<li><code>default</code> is the value returned if <code>key</code> is not found.</li>
<li>Returns <code>nil</code> if <code>key</code> is not found and <code>default</code> not specified.</li>
</ul>
</li>
<li><code>get_np_group(key)</code>: returns a <a class="el" href="structNoiseParams.html">NoiseParams</a> table</li>
<li><code>get_flags(key)</code>:<ul>
<li>Returns <code>{flag = true/false, ...}</code> according to the set flags.</li>
<li>Is currently limited to mapgen flags <code>mg_flags</code> and mapgen-specific flags like <code>mgv5_spflags</code>.</li>
</ul>
</li>
<li><code>set(key, value)</code><ul>
<li>Setting names can't contain whitespace or any of <code>="{}#&lt;/tt&gt;.
    * Setting values can't contain the sequence &lt;tt&gt;\\n"""</code>.</li>
<li>Setting names starting with "secure." can't be set on the main settings object (<code>minetest.settings</code>).</li>
</ul>
</li>
<li><code>set_bool(key, value)</code><ul>
<li>See documentation for set() above.</li>
</ul>
</li>
<li><code>set_np_group(key, value)</code><ul>
<li><code>value</code> is a <a class="el" href="structNoiseParams.html">NoiseParams</a> table.</li>
<li>Also, see documentation for set() above.</li>
</ul>
</li>
<li><code>remove(key)</code>: returns a boolean (<code>true</code> for success)</li>
<li><code>get_names()</code>: returns <code>{key1,...}</code></li>
<li><code>has(key)</code>:<ul>
<li>Returns a boolean indicating whether <code>key</code> exists.</li>
<li>Note that for the main settings object (<code>minetest.settings</code>), <code>get(key)</code> might return a value even if <code>has(key)</code> returns <code>false</code>. That's because <code>get</code> can fall back to the so-called parent of the <code><a class="el" href="classSettings.html">Settings</a></code> object, i.e. the default values.</li>
</ul>
</li>
<li><code>write()</code>: returns a boolean (<code>true</code> for success)<ul>
<li>Writes changes to file.</li>
</ul>
</li>
<li><code>to_table()</code>: returns <code>{[key1]=value1,...}</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md1104"></a>
Format</h3>
<p>The settings have the format <code>key = value</code>. Example: </p><pre class="fragment">foo = example text
bar = """
Multiline
value
"""
</pre><h2><a class="anchor" id="autotoc_md1105"></a>
&lt;tt&gt;StorageRef&lt;/tt&gt;</h2>
<p>Mod metadata: per mod metadata, saved automatically. Can be obtained via <code>minetest.get_mod_storage()</code> during load time.</p>
<p>WARNING: This storage backend is incapable of saving raw binary data due to restrictions of JSON.</p>
<h3><a class="anchor" id="autotoc_md1106"></a>
Methods</h3>
<ul>
<li>All methods in <a class="el" href="classMetaDataRef.html">MetaDataRef</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md1107"></a>
Definition tables</h1>
<h2><a class="anchor" id="autotoc_md1108"></a>
Object properties</h2>
<p>Used by <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> methods. Part of an <a class="el" href="structEntity.html">Entity</a> definition. These properties are not persistent, but are applied automatically to the corresponding Lua entity using the given registration fields. <a class="el" href="classPlayer.html">Player</a> properties need to be saved manually.</p>
<p>```lua { hp_max = 10, &ndash; Defines the maximum and default HP of the entity &ndash; For Lua entities the maximum is not enforced. &ndash; For players this defaults to <code>minetest.PLAYER_MAX_HP_DEFAULT</code>.</p>
<p>breath_max = 0, &ndash; For players only. Defaults to <code>minetest.PLAYER_MAX_BREATH_DEFAULT</code>.</p>
<p>zoom_fov = 0.0, &ndash; For players only. Zoom FOV in degrees. &ndash; Note that zoom loads and/or generates world beyond the server's &ndash; maximum send and generate distances, so acts like a telescope. &ndash; Smaller zoom_fov values increase the distance loaded/generated. &ndash; Defaults to 15 in creative mode, 0 in survival mode. &ndash; zoom_fov = 0 disables zooming for the player.</p>
<p>eye_height = 1.625, &ndash; For players only. <a class="el" href="classCamera.html">Camera</a> height above feet position in nodes.</p>
<p>physical = false, &ndash; Collide with <code>walkable</code> nodes.</p>
<p>collide_with_objects = true, &ndash; Collide with other objects if physical = true</p>
<p>collisionbox = { -0.5, -0.5, -0.5, 0.5, 0.5, 0.5 }, &ndash; default selectionbox = { -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, rotate = false }, &ndash; { xmin, ymin, zmin, xmax, ymax, zmax } in nodes from object position. &ndash; Collision boxes cannot rotate, setting <code>rotate = true</code> on it has no effect. &ndash; If not set, the selection box copies the collision box, and will also not rotate. &ndash; If <code>rotate = false</code>, the selection box will not rotate with the object itself, remaining fixed to the axes. &ndash; If <code>rotate = true</code>, it will match the object's rotation and any attachment rotations. &ndash; Raycasts use the selection box and object's rotation, but do <em>not</em> obey attachment rotations.</p>
<pre class="fragment">pointable = true,
-- Whether the object can be pointed at

visual = "cube" / "sprite" / "upright_sprite" / "mesh" / "wielditem" / "item",
-- "cube" is a node-sized cube.
-- "sprite" is a flat texture always facing the player.
-- "upright_sprite" is a vertical flat texture.
-- "mesh" uses the defined mesh model.
-- "wielditem" is used for dropped items.
--   (see builtin/game/item_entity.lua).
--   For this use 'wield_item = itemname' (Deprecated: 'textures = {itemname}').
--   If the item has a 'wield_image' the object will be an extrusion of
--   that, otherwise:
--   If 'itemname' is a cubic node or nodebox the object will appear
--   identical to 'itemname'.
--   If 'itemname' is a plantlike node the object will be an extrusion
--   of its texture.
--   Otherwise for non-node items, the object will be an extrusion of
--   'inventory_image'.
--   If 'itemname' contains a ColorString or palette index (e.g. from
--   `minetest.itemstring_with_palette()`), the entity will inherit the color.
--   Wielditems are scaled a bit. If you want a wielditem to appear
--   to be as large as a node, use `0.667` in `visual_size`
-- "item" is similar to "wielditem" but ignores the 'wield_image' parameter.

visual_size = {x = 1, y = 1, z = 1},
-- Multipliers for the visual size. If `z` is not specified, `x` will be used
-- to scale the entity along both horizontal axes.

mesh = "model.obj",
-- File name of mesh when using "mesh" visual

textures = {},
-- Number of required textures depends on visual.
-- "cube" uses 6 textures just like a node, but all 6 must be defined.
-- "sprite" uses 1 texture.
-- "upright_sprite" uses 2 textures: {front, back}.
-- "wielditem" expects 'textures = {itemname}' (see 'visual' above).
-- "mesh" requires one texture for each mesh buffer/material (in order)

colors = {},
-- Number of required colors depends on visual

use_texture_alpha = false,
-- Use texture's alpha channel.
-- Excludes "upright_sprite" and "wielditem".
-- Note: currently causes visual issues when viewed through other
-- semi-transparent materials such as water.

spritediv = {x = 1, y = 1},
-- Used with spritesheet textures for animation and/or frame selection
-- according to position relative to player.
-- Defines the number of columns and rows in the spritesheet:
-- {columns, rows}.

initial_sprite_basepos = {x = 0, y = 0},
-- Used with spritesheet textures.
-- Defines the {column, row} position of the initially used frame in the
-- spritesheet.

is_visible = true,
-- If false, object is invisible and can't be pointed.

makes_footstep_sound = false,
-- If true, is able to make footstep sounds of nodes
-- (see node sound definition for details).

automatic_rotate = 0,
-- Set constant rotation in radians per second, positive or negative.
-- Object rotates along the local Y-axis, and works with set_rotation.
-- Set to 0 to disable constant rotation.

stepheight = 0,
-- If positive number, object will climb upwards when it moves
-- horizontally against a `walkable` node, if the height difference
-- is within `stepheight`.

automatic_face_movement_dir = 0.0,
-- Automatically set yaw to movement direction, offset in degrees.
-- 'false' to disable.

automatic_face_movement_max_rotation_per_sec = -1,
-- Limit automatic rotation to this value in degrees per second.
-- No limit if value &lt;= 0.

backface_culling = true,
-- Set to false to disable backface_culling for model

glow = 0,
-- Add this much extra lighting when calculating texture color.
-- Value &lt; 0 disables light's effect on texture color.
-- For faking self-lighting, UI style entities, or programmatic coloring
-- in mods.

nametag = "",
-- The name to display on the head of the object. By default empty.
-- If the object is a player, a nil or empty nametag is replaced by the player's name.
-- For all other objects, a nil or empty string removes the nametag.
-- To hide a nametag, set its color alpha to zero. That will disable it entirely.

nametag_color = &lt;ColorSpec&gt;,
-- Sets text color of nametag

nametag_bgcolor = &lt;ColorSpec&gt;,
-- Sets background color of nametag
-- `false` will cause the background to be set automatically based on user settings.
-- Default: false

infotext = "",
-- Same as infotext for nodes. Empty by default

static_save = true,
-- If false, never save this object statically. It will simply be
-- deleted when the block gets unloaded.
-- The get_staticdata() callback is never called then.
-- Defaults to 'true'.

damage_texture_modifier = "^[brighten",
-- Texture modifier to be applied for a short duration when object is hit

shaded = true,
-- Setting this to 'false' disables diffuse lighting of entity

show_on_minimap = false,
-- Defaults to true for players, false for other entities.
-- If set to true the entity will show as a marker on the minimap.
</pre><p> } </p><div class="fragment"><div class="line">Entity definition</div>
<div class="line">-----------------</div>
<div class="line"> </div>
<div class="line">Used by `minetest.register_entity`.</div>
<div class="line"> </div>
<div class="line">```lua</div>
<div class="line">{</div>
<div class="line">    initial_properties = {</div>
<div class="line">        visual = &quot;mesh&quot;,</div>
<div class="line">        mesh = &quot;boats_boat.obj&quot;,</div>
<div class="line">        ...,</div>
<div class="line">    },</div>
<div class="line">    -- A table of object properties, see the `Object properties` section.</div>
<div class="line">    -- The properties in this table are applied to the object</div>
<div class="line">    -- once when it is spawned.</div>
<div class="line"> </div>
<div class="line">    -- Refer to the &quot;Registered entities&quot; section for explanations</div>
<div class="line">    on_activate = function(self, staticdata, dtime_s) end,</div>
<div class="line">    on_deactivate = function(self, removal) end,</div>
<div class="line">    on_step = function(self, dtime, moveresult) end,</div>
<div class="line">    on_punch = function(self, puncher, time_from_last_punch, tool_capabilities, dir, damage) end,</div>
<div class="line">    on_death = function(self, killer) end,</div>
<div class="line">    on_rightclick = function(self, clicker) end,</div>
<div class="line">    on_attach_child = function(self, child) end,</div>
<div class="line">    on_detach_child = function(self, child) end,</div>
<div class="line">    on_detach = function(self, parent) end,</div>
<div class="line">    get_staticdata = function(self) end,</div>
<div class="line"> </div>
<div class="line">    _custom_field = whatever,</div>
<div class="line">    -- You can define arbitrary member variables here (see Item definition</div>
<div class="line">    -- for more info) by using a &#39;_&#39; prefix</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1109"></a>
ABM (ActiveBlockModifier) definition</h2>
<p>Used by <code>minetest.register_abm</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    label = &quot;Lava cooling&quot;,</div>
<div class="line">    -- Descriptive label for profiling purposes (optional).</div>
<div class="line">    -- Definitions with identical labels will be listed as one.</div>
<div class="line"> </div>
<div class="line">    nodenames = {&quot;default:lava_source&quot;},</div>
<div class="line">    -- Apply `action` function to these nodes.</div>
<div class="line">    -- `group:groupname` can also be used here.</div>
<div class="line"> </div>
<div class="line">    neighbors = {&quot;default:water_source&quot;, &quot;default:water_flowing&quot;},</div>
<div class="line">    -- Only apply `action` to nodes that have one of, or any</div>
<div class="line">    -- combination of, these neighbors.</div>
<div class="line">    -- If left out or empty, any neighbor will do.</div>
<div class="line">    -- `group:groupname` can also be used here.</div>
<div class="line"> </div>
<div class="line">    interval = 10.0,</div>
<div class="line">    -- Operation interval in seconds</div>
<div class="line"> </div>
<div class="line">    chance = 50,</div>
<div class="line">    -- Chance of triggering `action` per-node per-interval is 1.0 / chance</div>
<div class="line"> </div>
<div class="line">    min_y = -32768,</div>
<div class="line">    max_y = 32767,</div>
<div class="line">    -- min and max height levels where ABM will be processed (inclusive)</div>
<div class="line">    -- can be used to reduce CPU usage</div>
<div class="line"> </div>
<div class="line">    catch_up = true,</div>
<div class="line">    -- If true, catch-up behavior is enabled: The `chance` value is</div>
<div class="line">    -- temporarily reduced when returning to an area to simulate time lost</div>
<div class="line">    -- by the area being unattended. Note that the `chance` value can often</div>
<div class="line">    -- be reduced to 1.</div>
<div class="line"> </div>
<div class="line">    action = function(pos, node, active_object_count, active_object_count_wider),</div>
<div class="line">    -- Function triggered for each qualifying node.</div>
<div class="line">    -- `active_object_count` is number of active objects in the node&#39;s</div>
<div class="line">    -- mapblock.</div>
<div class="line">    -- `active_object_count_wider` is number of active objects in the node&#39;s</div>
<div class="line">    -- mapblock plus all 26 neighboring mapblocks. If any neighboring</div>
<div class="line">    -- mapblocks are unloaded an estimate is calculated for them based on</div>
<div class="line">    -- loaded mapblocks.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1110"></a>
LBM (LoadingBlockModifier) definition</h2>
<p>Used by <code>minetest.register_lbm</code>.</p>
<p>A loading block modifier (LBM) is used to define a function that is called for specific nodes (defined by <code>nodenames</code>) when a mapblock which contains such nodes gets activated (not loaded!)</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    label = &quot;Upgrade legacy doors&quot;,</div>
<div class="line">    -- Descriptive label for profiling purposes (optional).</div>
<div class="line">    -- Definitions with identical labels will be listed as one.</div>
<div class="line"> </div>
<div class="line">    name = &quot;modname:replace_legacy_door&quot;,</div>
<div class="line">    -- Identifier of the LBM, should follow the modname:&lt;whatever&gt; convention</div>
<div class="line"> </div>
<div class="line">    nodenames = {&quot;default:lava_source&quot;},</div>
<div class="line">    -- List of node names to trigger the LBM on.</div>
<div class="line">    -- Names of non-registered nodes and groups (as group:groupname)</div>
<div class="line">    -- will work as well.</div>
<div class="line"> </div>
<div class="line">    run_at_every_load = false,</div>
<div class="line">    -- Whether to run the LBM&#39;s action every time a block gets activated,</div>
<div class="line">    -- and not only the first time the block gets activated after the LBM</div>
<div class="line">    -- was introduced.</div>
<div class="line"> </div>
<div class="line">    action = function(pos, node, dtime_s) end,</div>
<div class="line">    -- Function triggered for each qualifying node.</div>
<div class="line">    -- `dtime_s` is the in-game time (in seconds) elapsed since the block</div>
<div class="line">    -- was last active</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1111"></a>
Tile definition</h2>
<ul>
<li><code>"image.png"</code></li>
<li><code>{name="image.png", animation={Tile Animation definition}}</code></li>
<li><code>{name="image.png", backface_culling=bool, align_style="node"/"world"/"user", scale=int}</code><ul>
<li>backface culling enabled by default for most nodes</li>
<li>align style determines whether the texture will be rotated with the node or kept aligned with its surroundings. "user" means that client setting will be used, similar to <code>glasslike_framed_optional</code>. Note: supported by solid nodes and nodeboxes only.</li>
<li>scale is used to make texture span several (exactly <code>scale</code>) nodes, instead of just one, in each direction. Works for world-aligned textures only. Note that as the effect is applied on per-mapblock basis, <code>16</code> should be equally divisible by <code>scale</code> or you may get wrong results.</li>
</ul>
</li>
<li><code>{name="image.png", color=ColorSpec}</code><ul>
<li>the texture's color will be multiplied with this color.</li>
<li>the tile's color overrides the owning node's color in all cases.</li>
</ul>
</li>
<li>deprecated, yet still supported field names:<ul>
<li><code>image</code> (name)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1112"></a>
Tile animation definition</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">    type = &quot;vertical_frames&quot;,</div>
<div class="line"> </div>
<div class="line">    aspect_w = 16,</div>
<div class="line">    -- Width of a frame in pixels</div>
<div class="line"> </div>
<div class="line">    aspect_h = 16,</div>
<div class="line">    -- Height of a frame in pixels</div>
<div class="line"> </div>
<div class="line">    length = 3.0,</div>
<div class="line">    -- Full loop length</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    type = &quot;sheet_2d&quot;,</div>
<div class="line"> </div>
<div class="line">    frames_w = 5,</div>
<div class="line">    -- Width in number of frames</div>
<div class="line"> </div>
<div class="line">    frames_h = 3,</div>
<div class="line">    -- Height in number of frames</div>
<div class="line"> </div>
<div class="line">    frame_length = 0.5,</div>
<div class="line">    -- Length of a single frame</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1113"></a>
Item definition</h2>
<p>Used by <code>minetest.register_node</code>, <code>minetest.register_craftitem</code>, and <code>minetest.register_tool</code>.</p>
<p>```lua { description = "", &ndash; Can contain new lines. "\n" has to be used as new line character. &ndash; See also: <code>get_description</code> in [<code><a class="el" href="structItemStack.html">ItemStack</a></code>]</p>
<p>short_description = "", &ndash; Must not contain new lines. &ndash; Defaults to nil. &ndash; Use an [<code><a class="el" href="structItemStack.html">ItemStack</a></code>] to get the short description, e.g.: &ndash; <a class="el" href="structItemStack.html">ItemStack(itemname)</a>:get_short_description()</p>
<p>groups = {}, &ndash; key = name, value = rating; rating = &lt;number&gt;. &ndash; If rating not applicable, use 1. &ndash; e.g. {wool = 1, fluffy = 3} &ndash; {soil = 2, outerspace = 1, crumbly = 1} &ndash; {bendy = 2, snappy = 1}, &ndash; {hard = 1, metal = 1, spikes = 1}</p>
<p>inventory_image = "", &ndash; Texture shown in the inventory GUI &ndash; Defaults to a 3D rendering of the node if left empty.</p>
<p>inventory_overlay = "", &ndash; An overlay texture which is not affected by colorization</p>
<p>wield_image = "", &ndash; Texture shown when item is held in hand &ndash; Defaults to a 3D rendering of the node if left empty.</p>
<p>wield_overlay = "", &ndash; Like inventory_overlay but only used in the same situation as wield_image</p>
<p>wield_scale = {x = 1, y = 1, z = 1}, &ndash; Scale for the item when held in hand</p>
<p>palette = "", &ndash; An image file containing the palette of a node. &ndash; You can set the currently used color as the "palette_index" field of &ndash; the item stack metadata. &ndash; The palette is always stretched to fit indices between 0 and 255, to &ndash; ensure compatibility with "colorfacedir" (and similar) nodes.</p>
<p>color = "#ffffffff", &ndash; Color the item is colorized with. The palette overrides this.</p>
<p>stack_max = 99, &ndash; Maximum amount of items that can be in a single stack. &ndash; The default can be changed by the setting <code>default_stack_max</code></p>
<p>range = 4.0, &ndash; Range of node and object pointing that is possible with this item held</p>
<p>liquids_pointable = false, &ndash; If true, item can point to all liquid nodes (<code>liquidtype ~= "none"</code>), &ndash; even those for which <code>pointable = false</code></p>
<p>light_source = 0, &ndash; When used for nodes: Defines amount of light emitted by node. &ndash; Otherwise: Defines texture glow when viewed as a dropped item &ndash; To set the maximum (14), use the value 'minetest.LIGHT_MAX'. &ndash; A value outside the range 0 to minetest.LIGHT_MAX causes undefined &ndash; behavior.</p>
<p>&ndash; See "Tool Capabilities" section for an example including explanation tool_capabilities = { full_punch_interval = 1.0, max_drop_level = 0, groupcaps = { &ndash; For example: choppy = {times = {2.50, 1.40, 1.00}, uses = 20, maxlevel = 2}, }, damage_groups = {groupname = damage}, &ndash; Damage values must be between -32768 and 32767 (2^15)</p>
<p>punch_attack_uses = nil, &ndash; Amount of uses this tool has for attacking players and entities &ndash; by punching them (0 = infinite uses). &ndash; For compatibility, this is automatically set from the first &ndash; suitable groupcap using the formula "uses * 3^(maxlevel - 1)". &ndash; It is recommend to set this explicitly instead of relying on the &ndash; fallback behavior. },</p>
<p>node_placement_prediction = nil, &ndash; If nil and item is node, prediction is made automatically. &ndash; If nil and item is not a node, no prediction is made. &ndash; If "" and item is anything, no prediction is made. &ndash; Otherwise should be name of node which the client immediately places &ndash; on ground when the player places the item. <a class="el" href="classServer.html">Server</a> will always update &ndash; with actual result shortly.</p>
<p>node_dig_prediction = "air", &ndash; if "", no prediction is made. &ndash; if "air", node is removed. &ndash; Otherwise should be name of node which the client immediately places &ndash; upon digging. <a class="el" href="classServer.html">Server</a> will always update with actual result shortly.</p>
<p>sound = { &ndash; Definition of item sounds to be played at various events. &ndash; All fields in this table are optional.</p>
<p>breaks = &lt;SimpleSoundSpec&gt;, &ndash; When tool breaks due to wear. Ignored for non-tools</p>
<p>eat = &lt;SimpleSoundSpec&gt;, &ndash; When item is eaten with <code>minetest.do_item_eat</code></p>
<p>punch_use = &lt;SimpleSoundSpec&gt;, &ndash; When item is used with the 'punch/mine' key pointing at a node or entity</p>
<p>punch_use_air = &lt;SimpleSoundSpec&gt;, &ndash; When item is used with the 'punch/mine' key pointing at nothing (air) },</p>
<p>on_place = function(itemstack, placer, pointed_thing), &ndash; When the 'place' key was pressed with the item in hand &ndash; and a node was pointed at. &ndash; Shall place item and return the leftover itemstack &ndash; or nil to not modify the inventory. &ndash; The placer may be any <a class="el" href="classObjectRef.html">ObjectRef</a> or nil. &ndash; default: minetest.item_place</p>
<p>on_secondary_use = function(itemstack, user, pointed_thing), &ndash; Same as on_place but called when not pointing at a node. &ndash; Function must return either nil if inventory shall not be modified, &ndash; or an itemstack to replace the original itemstack. &ndash; The user may be any <a class="el" href="classObjectRef.html">ObjectRef</a> or nil. &ndash; default: nil</p>
<p>on_drop = function(itemstack, dropper, pos), &ndash; Shall drop item and return the leftover itemstack. &ndash; The dropper may be any <a class="el" href="classObjectRef.html">ObjectRef</a> or nil. &ndash; default: minetest.item_drop</p>
<p>on_pickup = function(itemstack, picker, pointed_thing, time_from_last_punch, ...), &ndash; Called when a dropped item is punched by a player. &ndash; Shall pick-up the item and return the leftover itemstack or nil to not &ndash; modify the dropped item. &ndash; Parameters: &ndash; * <code>itemstack</code>: The <code><a class="el" href="structItemStack.html">ItemStack</a></code> to be picked up. &ndash; * <code>picker</code>: Any <code><a class="el" href="classObjectRef.html">ObjectRef</a></code> or <code>nil</code>. &ndash; * <code>pointed_thing</code> (optional): The dropped item (a <code>"__builtin:item"</code> &ndash; luaentity) as <code>type="object"</code> <code>pointed_thing</code>. &ndash; * <code>time_from_last_punch, ...</code> (optional): Other parameters from &ndash; <code>luaentity:on_punch</code>. &ndash; default: <code>minetest.item_pickup</code></p>
<p>on_use = function(itemstack, user, pointed_thing), &ndash; default: nil &ndash; When user pressed the 'punch/mine' key with the item in hand. &ndash; Function must return either nil if inventory shall not be modified, &ndash; or an itemstack to replace the original itemstack. &ndash; e.g. itemstack:take_item(); return itemstack &ndash; Otherwise, the function is free to do what it wants. &ndash; The user may be any <a class="el" href="classObjectRef.html">ObjectRef</a> or nil. &ndash; The default functions handle regular use cases.</p>
<p>after_use = function(itemstack, user, node, digparams), &ndash; default: nil &ndash; If defined, should return an itemstack and will be called instead of &ndash; wearing out the item (if tool). If returns nil, does nothing. &ndash; If after_use doesn't exist, it is the same as: &ndash; function(itemstack, user, node, digparams) &ndash; itemstack:add_wear(digparams.wear) &ndash; return itemstack &ndash; end &ndash; The user may be any <a class="el" href="classObjectRef.html">ObjectRef</a> or nil.</p>
<p>_custom_field = whatever, &ndash; Add your own custom fields. By convention, all custom field names &ndash; should start with <code>_</code> to avoid naming collisions with future engine &ndash; usage. } ```</p>
<h2><a class="anchor" id="autotoc_md1114"></a>
Node definition</h2>
<p>Used by <code>minetest.register_node</code>.</p>
<p>```lua { &ndash; &lt;all fields allowed in item definitions&gt;</p>
<p>drawtype = "normal", &ndash; See "Node drawtypes"</p>
<p>visual_scale = 1.0, &ndash; Supported for drawtypes "plantlike", "signlike", "torchlike", &ndash; "firelike", "mesh", "nodebox", "allfaces". &ndash; For plantlike and firelike, the image will start at the bottom of the &ndash; node. For torchlike, the image will start at the surface to which the &ndash; node "attaches". For the other drawtypes the image will be centered &ndash; on the node.</p>
<p>tiles = {tile definition 1, def2, def3, def4, def5, def6}, &ndash; Textures of node; +Y, -Y, +X, -X, +Z, -Z &ndash; List can be shortened to needed length.</p>
<p>overlay_tiles = {tile definition 1, def2, def3, def4, def5, def6}, &ndash; Same as <code>tiles</code>, but these textures are drawn on top of the base &ndash; tiles. You can use this to colorize only specific parts of your &ndash; texture. If the texture name is an empty string, that overlay is not &ndash; drawn. Since such tiles are drawn twice, it is not recommended to use &ndash; overlays on very common nodes.</p>
<p>special_tiles = {tile definition 1, Tile definition 2}, &ndash; Special textures of node; used rarely. &ndash; List can be shortened to needed length.</p>
<p>color = ColorSpec, &ndash; The node's original color will be multiplied with this color. &ndash; If the node has a palette, then this setting only has an effect in &ndash; the inventory and on the wield item.</p>
<p>use_texture_alpha = ..., &ndash; Specifies how the texture's alpha channel will be used for rendering. &ndash; possible values: &ndash; * "opaque": <a class="el" href="structNode.html">Node</a> is rendered opaque regardless of alpha channel &ndash; * "clip": A given pixel is either fully see-through or opaque &ndash; depending on the alpha channel being below/above 50% in value &ndash; * "blend": The alpha channel specifies how transparent a given pixel &ndash; of the rendered node is &ndash; The default is "opaque" for drawtypes normal, liquid and flowingliquid; &ndash; "clip" otherwise. &ndash; If set to a boolean value (deprecated): true either sets it to blend &ndash; or clip, false sets it to clip or opaque mode depending on the drawtype.</p>
<p>palette = "", &ndash; The node's <code>param2</code> is used to select a pixel from the image. &ndash; Pixels are arranged from left to right and from top to bottom. &ndash; The node's color will be multiplied with the selected pixel's color. &ndash; Tiles can override this behavior. &ndash; Only when <code>paramtype2</code> supports palettes.</p>
<p>post_effect_color = "#00000000", &ndash; Screen tint if player is inside node, see "ColorSpec"</p>
<p>paramtype = "none", &ndash; See "Nodes"</p>
<p>paramtype2 = "none", &ndash; See "Nodes"</p>
<p>place_param2 = 0, &ndash; <a class="el" href="unionValue.html">Value</a> for param2 that is set when player places node</p>
<p>is_ground_content = true, &ndash; If false, the cave generator and dungeon generator will not carve &ndash; through this node. &ndash; Specifically, this stops mod-added nodes being removed by caves and &ndash; dungeons when those generate in a neighbor mapchunk and extend out &ndash; beyond the edge of that mapchunk.</p>
<p>sunlight_propagates = false, &ndash; If true, sunlight will go infinitely through this node</p>
<p>walkable = true, &ndash; If true, objects collide with node</p>
<p>pointable = true, &ndash; If true, can be pointed at</p>
<p>diggable = true, &ndash; If false, can never be dug</p>
<p>climbable = false, &ndash; If true, can be climbed on like a ladder</p>
<p>move_resistance = 0, &ndash; Slows down movement of players through this node (max. 7). &ndash; If this is nil, it will be equal to liquid_viscosity. &ndash; Note: If liquid movement physics apply to the node &ndash; (see <code>liquid_move_physics</code>), the movement speed will also be &ndash; affected by the <code>movement_liquid_*</code> settings.</p>
<p>buildable_to = false, &ndash; If true, placed nodes can replace this node</p>
<p>floodable = false, &ndash; If true, liquids flow into and replace this node. &ndash; Warning: making a liquid node 'floodable' will cause problems.</p>
<p>liquidtype = "none", &ndash; specifies liquid flowing physics &ndash; * "none": no liquid flowing physics &ndash; * "source": spawns flowing liquid nodes at all 4 sides and below; &ndash; recommended drawtype: "liquid". &ndash; * "flowing": spawned from source, spawns more flowing liquid nodes &ndash; around it until <code>liquid_range</code> is reached; &ndash; will drain out without a source; &ndash; recommended drawtype: "flowingliquid". &ndash; If it's "source" or "flowing", then the &ndash; <code>liquid_alternative_*</code> fields <em>must</em> be specified</p>
<p>liquid_alternative_flowing = "", liquid_alternative_source = "", &ndash; These fields may contain node names that represent the &ndash; flowing version (<code>liquid_alternative_flowing</code>) and </p>
<h2><a class="anchor" id="autotoc_md1115"></a>
– source version (&lt;tt&gt;liquid_alternative_source&lt;/tt&gt;) of a liquid.</h2>
<p>&ndash; Specifically, these fields are required if any of these is true: &ndash; * <code>liquidtype ~= "none" or -- *</code>drawtype == "liquid" or </p>
<h2><a class="anchor" id="autotoc_md1116"></a>
– * `drawtype == "flowingliquid"</h2>
<h2><a class="anchor" id="autotoc_md1117"></a>
– Liquids consist of up to two nodes: source and flowing.</h2>
<p>&ndash; There are two ways to define a liquid: &ndash; 1) Source node and flowing node. This requires both fields to be &ndash; specified for both nodes. &ndash; 2) Standalone source node (cannot flow). <code>liquid_alternative_source</code> </p>
<h2><a class="anchor" id="autotoc_md1118"></a>
–    must be specified and &lt;tt&gt;liquid_range&lt;/tt&gt; must be set to 0.</h2>
<p>&ndash; Example: &ndash; liquid_alternative_flowing = "example:water_flowing", &ndash; liquid_alternative_source = "example:water_source",</p>
<p>liquid_viscosity = 0, &ndash; Controls speed at which the liquid spreads/flows (max. 7). &ndash; 0 is fastest, 7 is slowest. &ndash; By default, this also slows down movement of players inside the node &ndash; (can be overridden using <code>move_resistance</code>)</p>
<p>liquid_renewable = true, &ndash; If true, a new liquid source can be created by placing two or more &ndash; sources nearby</p>
<p>liquid_move_physics = nil, &ndash; specifies movement physics if inside node &ndash; * false: No liquid movement physics apply. &ndash; * true: Enables liquid movement physics. Enables things like &ndash; ability to "swim" up/down, sinking slowly if not moving, &ndash; smoother speed change when falling into, etc. The <code>movement_liquid_*</code> &ndash; settings apply. &ndash; * nil: Will be treated as true if <code>liquidtype ~= "none"</code> &ndash; and as false otherwise.</p>
<p>leveled = 0, &ndash; Only valid for "nodebox" drawtype with 'type = "leveled"'. &ndash; Allows defining the nodebox height without using param2. &ndash; The nodebox height is 'leveled' / 64 nodes. &ndash; The maximum value of 'leveled' is <code>leveled_max</code>.</p>
<p>leveled_max = 127, &ndash; Maximum value for <code>leveled</code> (0-127), enforced in &ndash; <code>minetest.set_node_level</code> and <code>minetest.add_node_level</code>. &ndash; Values above 124 might causes collision detection issues.</p>
<p>liquid_range = 8, &ndash; Maximum distance that flowing liquid nodes can spread around &ndash; source on flat land; &ndash; maximum = 8; set to 0 to disable liquid flow</p>
<p>drowning = 0, &ndash; <a class="el" href="classPlayer.html">Player</a> will take this amount of damage if no bubbles are left</p>
<p>damage_per_second = 0, &ndash; If player is inside node, this damage is caused</p>
<p>node_box = {type = "regular"}, &ndash; See "Node boxes"</p>
<p>connects_to = {}, &ndash; Used for nodebox nodes with the type == "connected". &ndash; Specifies to what neighboring nodes connections will be drawn. &ndash; e.g. <code>{"group:fence", "default:wood"}</code> or <code>"default:stone"</code></p>
<p>connect_sides = {}, &ndash; Tells connected nodebox nodes to connect only to these sides of this &ndash; node. possible: "top", "bottom", "front", "left", "back", "right"</p>
<p>mesh = "", &ndash; File name of mesh when using "mesh" drawtype</p>
<p>selection_box = { &ndash; see [<a class="el" href="structNode.html">Node</a> boxes] for possibilities }, &ndash; Custom selection box definition. Multiple boxes can be defined. &ndash; If "nodebox" drawtype is used and selection_box is nil, then node_box &ndash; definition is used for the selection box.</p>
<p>collision_box = { &ndash; see [<a class="el" href="structNode.html">Node</a> boxes] for possibilities }, &ndash; Custom collision box definition. Multiple boxes can be defined. &ndash; If "nodebox" drawtype is used and collision_box is nil, then node_box &ndash; definition is used for the collision box.</p>
<p>&ndash; Support maps made in and before January 2012 legacy_facedir_simple = false, legacy_wallmounted = false,</p>
<p>waving = 0, &ndash; Valid for drawtypes: &ndash; mesh, nodebox, plantlike, allfaces_optional, liquid, flowingliquid. &ndash; 1 - wave node like plants (node top moves side-to-side, bottom is fixed) &ndash; 2 - wave node like leaves (whole node moves side-to-side) &ndash; 3 - wave node like liquids (whole node moves up and down) &ndash; Not all models will properly wave. &ndash; plantlike drawtype can only wave like plants. &ndash; allfaces_optional drawtype can only wave like leaves. &ndash; liquid, flowingliquid drawtypes can only wave like liquids.</p>
<p>sounds = { &ndash; Definition of node sounds to be played at various events. &ndash; All fields in this table are optional.</p>
<p>footstep = &lt;SimpleSoundSpec&gt;, &ndash; If walkable, played when object walks on it. If node is &ndash; climbable or a liquid, played when object moves through it</p>
<p>dig = &lt;SimpleSoundSpec&gt; or "__group", &ndash; While digging node. &ndash; If <code>"__group"</code>, then the sound will be &ndash; <code>{name = "default_dig_&lt;groupname&gt;", gain = 0.5}</code> , where <code>&lt;groupname&gt;</code> is the &ndash; name of the item's digging group with the fastest digging time. &ndash; In case of a tie, one of the sounds will be played (but we &ndash; cannot predict which one) &ndash; Default value: <code>"__group"</code></p>
<p>dug = &lt;SimpleSoundSpec&gt;, &ndash; <a class="el" href="structNode.html">Node</a> was dug</p>
<p>place = &lt;SimpleSoundSpec&gt;, &ndash; <a class="el" href="structNode.html">Node</a> was placed. Also played after falling</p>
<p>place_failed = &lt;SimpleSoundSpec&gt;, &ndash; When node placement failed. &ndash; Note: This happens if the <em>built-in</em> node placement failed. &ndash; This sound will still be played if the node is placed in the &ndash; <code>on_place</code> callback manually.</p>
<p>fall = &lt;SimpleSoundSpec&gt;, &ndash; When node starts to fall or is detached },</p>
<p>drop = "", &ndash; Name of dropped item when dug. &ndash; Default dropped item is the node itself.</p>
<p>&ndash; Using a table allows multiple items, drop chances and item filtering: drop = { max_items = 1, &ndash; Maximum number of item lists to drop. &ndash; The entries in 'items' are processed in order. For each: &ndash; Item filtering is applied, chance of drop is applied, if both are &ndash; successful the entire item list is dropped. &ndash; Entry processing continues until the number of dropped item lists &ndash; equals 'max_items'. &ndash; Therefore, entries should progress from low to high drop chance. items = { &ndash; Examples: { &ndash; 1 in 1000 chance of dropping a diamond. &ndash; Default rarity is '1'. rarity = 1000, items = {"default:diamond"}, }, { &ndash; Only drop if using an item whose name is identical to one &ndash; of these. tools = {"default:shovel_mese", "default:shovel_diamond"}, rarity = 5, items = {"default:dirt"}, &ndash; Whether all items in the dropped item list inherit the &ndash; hardware coloring palette color from the dug node. &ndash; Default is 'false'. inherit_color = true, }, { &ndash; Only drop if using an item whose name contains &ndash; "default:shovel_" (this item filtering by string matching &ndash; is deprecated, use tool_groups instead). tools = {"~default:shovel_"}, rarity = 2, &ndash; The item list dropped. items = {"default:sand", "default:desert_sand"}, }, { &ndash; Only drop if using an item in the "magicwand" group, or &ndash; an item that is in both the "pickaxe" and the "lucky" &ndash; groups. tool_groups = { "magicwand", {"pickaxe", "lucky"} }, items = {"default:coal_lump"}, }, }, },</p>
<p>on_construct = function(pos), &ndash; <a class="el" href="structNode.html">Node</a> constructor; called after adding node. &ndash; Can set up metadata and stuff like that. &ndash; Not called for bulk node placement (i.e. schematics and VoxelManip). &ndash; Note: Within an on_construct callback, minetest.set_node can cause an &ndash; infinite loop if it invokes the same callback. &ndash; Consider using minetest.swap_node instead. &ndash; default: nil</p>
<p>on_destruct = function(pos), &ndash; <a class="el" href="structNode.html">Node</a> destructor; called before removing node. &ndash; Not called for bulk node placement. &ndash; default: nil</p>
<p>after_destruct = function(pos, oldnode), &ndash; <a class="el" href="structNode.html">Node</a> destructor; called after removing node. &ndash; Not called for bulk node placement. &ndash; default: nil</p>
<p>on_flood = function(pos, oldnode, newnode), &ndash; Called when a liquid (newnode) is about to flood oldnode, if it has &ndash; <code>floodable = true</code> in the nodedef. Not called for bulk node placement &ndash; (i.e. schematics and VoxelManip) or air nodes. If return true the &ndash; node is not flooded, but on_flood callback will most likely be called &ndash; over and over again every liquid update interval. &ndash; Default: nil &ndash; Warning: making a liquid node 'floodable' will cause problems.</p>
<p>preserve_metadata = function(pos, oldnode, oldmeta, drops), &ndash; Called when <code>oldnode</code> is about be converted to an item, but before the &ndash; node is deleted from the world or the drops are added. This is &ndash; generally the result of either the node being dug or an attached node &ndash; becoming detached. &ndash; * <code>pos</code>: node position &ndash; * <code>oldnode</code>: node table of node before it was deleted &ndash; * <code>oldmeta</code>: metadata of node before it was deleted, as a metadata table &ndash; * <code>drops</code>: a table of <code><a class="el" href="structItemStack.html">ItemStack</a></code>s, so any metadata to be preserved can &ndash; be added directly to one or more of the dropped items. See &ndash; "ItemStackMetaRef". &ndash; default: <code>nil</code></p>
<p>after_place_node = function(pos, placer, itemstack, pointed_thing), &ndash; Called after constructing node when node was placed using &ndash; minetest.item_place_node / minetest.place_node. &ndash; If return true no item is taken from itemstack. &ndash; <code>placer</code> may be any valid <a class="el" href="classObjectRef.html">ObjectRef</a> or nil. &ndash; default: nil</p>
<p>after_dig_node = function(pos, oldnode, oldmetadata, digger), &ndash; Called after destructing the node when node was dug using &ndash; <code>minetest.node_dig</code> / <code>minetest.dig_node</code>. &ndash; * <code>pos</code>: node position &ndash; * <code>oldnode</code>: node table of node before it was dug &ndash; * <code>oldmetadata</code>: metadata of node before it was dug, &ndash; as a metadata table &ndash; * <code>digger</code>: <a class="el" href="classObjectRef.html">ObjectRef</a> of digger &ndash; default: nil</p>
<p>can_dig = function(pos, [player]), &ndash; Returns true if node can be dug, or false if not. &ndash; default: nil</p>
<p>on_punch = function(pos, node, puncher, pointed_thing), &ndash; default: minetest.node_punch &ndash; Called when puncher (an <a class="el" href="classObjectRef.html">ObjectRef</a>) punches the node at pos. &ndash; By default calls minetest.register_on_punchnode callbacks.</p>
<p>on_rightclick = function(pos, node, clicker, itemstack, pointed_thing), &ndash; default: nil &ndash; Called when clicker (an <a class="el" href="classObjectRef.html">ObjectRef</a>) used the 'place/build' key &ndash; (not necessarily an actual rightclick) &ndash; while pointing at the node at pos with 'node' being the node table. &ndash; itemstack will hold clicker's wielded item. &ndash; Shall return the leftover itemstack. &ndash; Note: pointed_thing can be nil, if a mod calls this function. &ndash; This function does not get triggered by clients &lt;=0.4.16 if the &ndash; "formspec" node metadata field is set.</p>
<p>on_dig = function(pos, node, digger), &ndash; default: minetest.node_dig &ndash; By default checks privileges, wears out item (if tool) and removes node. &ndash; return true if the node was dug successfully, false otherwise. &ndash; Deprecated: returning nil is the same as returning true.</p>
<p>on_timer = function(pos, elapsed), &ndash; default: nil &ndash; called by NodeTimers, see minetest.get_node_timer and <a class="el" href="classNodeTimerRef.html">NodeTimerRef</a>. &ndash; elapsed is the total time passed since the timer was started. &ndash; return true to run the timer for another cycle with the same timeout &ndash; value.</p>
<p>on_receive_fields = function(pos, formname, fields, sender), &ndash; fields = {name1 = value1, name2 = value2, ...} &ndash; Called when an UI form (e.g. sign text input) returns data. &ndash; See minetest.register_on_player_receive_fields for more info. &ndash; default: nil</p>
<p>allow_metadata_inventory_move = function(pos, from_list, from_index, to_list, to_index, count, player), &ndash; Called when a player wants to move items inside the inventory. &ndash; Return value: number of items allowed to move.</p>
<p>allow_metadata_inventory_put = function(pos, listname, index, stack, player), &ndash; Called when a player wants to put something into the inventory. &ndash; Return value: number of items allowed to put. &ndash; Return value -1: Allow and don't modify item count in inventory.</p>
<p>allow_metadata_inventory_take = function(pos, listname, index, stack, player), &ndash; Called when a player wants to take something out of the inventory. &ndash; Return value: number of items allowed to take. &ndash; Return value -1: Allow and don't modify item count in inventory.</p>
<p>on_metadata_inventory_move = function(pos, from_list, from_index, to_list, to_index, count, player), on_metadata_inventory_put = function(pos, listname, index, stack, player), on_metadata_inventory_take = function(pos, listname, index, stack, player), &ndash; Called after the actual action has happened, according to what was &ndash; allowed. &ndash; No return value.</p>
<p>on_blast = function(pos, intensity), &ndash; intensity: 1.0 = mid range of regular TNT. &ndash; If defined, called when an explosion touches the node, instead of &ndash; removing the node.</p>
<p>mod_origin = "modname", &ndash; stores which mod actually registered a node &ndash; If the source could not be determined it contains "??" &ndash; Useful for getting which mod truly registered something &ndash; example: if a node is registered as ":othermodname:nodename", &ndash; nodename will show "othermodname", but mod_origin will say "modname" } </p><div class="fragment"><div class="line">Crafting recipes</div>
<div class="line">----------------</div>
<div class="line"> </div>
<div class="line">Crafting converts one or more inputs to one output itemstack of arbitrary</div>
<div class="line">count (except for fuels, which don&#39;t have an output). The conversion reduces</div>
<div class="line">each input ItemStack by 1.</div>
<div class="line"> </div>
<div class="line">Craft recipes are registered by `minetest.register_craft` and use a</div>
<div class="line">table format. The accepted parameters are listed below.</div>
<div class="line"> </div>
<div class="line">Recipe input items can either be specified by item name (item count = 1)</div>
<div class="line">or by group (see &quot;Groups in crafting recipes&quot; for details).</div>
<div class="line"> </div>
<div class="line">The following sections describe the types and syntaxes of recipes.</div>
<div class="line"> </div>
<div class="line">### Shaped</div>
<div class="line"> </div>
<div class="line">This is the default recipe type (when no `type` is specified).</div>
<div class="line"> </div>
<div class="line">A shaped recipe takes one or multiple items as input and has</div>
<div class="line">a single item stack as output. The input items must be specified</div>
<div class="line">in a 2-dimensional matrix (see parameters below) to specify the</div>
<div class="line">exact arrangement (the &quot;shape&quot;) in which the player must place them</div>
<div class="line">in the crafting grid.</div>
<div class="line"> </div>
<div class="line">For example, for a 3x3 recipe, the `recipes` table must have</div>
<div class="line">3 rows and 3 columns.</div>
<div class="line"> </div>
<div class="line">In order to craft the recipe, the players&#39; crafting grid must</div>
<div class="line">have equal or larger dimensions (both width and height).</div>
<div class="line"> </div>
<div class="line">Parameters:</div>
<div class="line"> </div>
<div class="line">* `type = &quot;shaped&quot;`: (optional) specifies recipe type as shaped</div>
<div class="line">* `output`: Itemstring of output itemstack (item counts &gt;= 1 are allowed)</div>
<div class="line">* `recipe`: A 2-dimensional matrix of items, with a width *w* and height *h*.</div>
<div class="line">    * *w* and *h* are chosen by you, they don&#39;t have to be equal but must be at least 1</div>
<div class="line">    * The matrix is specified as a table containing tables containing itemnames</div>
<div class="line">    * The inner tables are the rows. There must be *h* tables, specified from the top to the bottom row</div>
<div class="line">    * Values inside of the inner table are the columns.</div>
<div class="line">      Each inner table must contain a list of *w* items, specified from left to right</div>
<div class="line">    * Empty slots *must* be filled with the empty string</div>
<div class="line">* `replacements`: (optional) Allows you to replace input items with some other items</div>
<div class="line">      when something is crafted</div>
<div class="line">    * Provided as a list of item pairs of the form `{ old_item, new_item }` where</div>
<div class="line">      `old_item` is the input item to replace (same syntax as for a regular input</div>
<div class="line">      slot; groups are allowed) and `new_item` is an itemstring for the item stack</div>
<div class="line">      it will become</div>
<div class="line">    * When the output is crafted, Minetest iterates through the list</div>
<div class="line">      of input items if the crafting grid. For each input item stack, it checks if</div>
<div class="line">      it matches with an `old_item` in the item pair list.</div>
<div class="line">        * If it matches, the item will be replaced. Also, this item pair</div>
<div class="line">          will *not* be applied again for the remaining items</div>
<div class="line">        * If it does not match, the item is consumed (reduced by 1) normally</div>
<div class="line">    * The `new_item` will appear in one of 3 places:</div>
<div class="line">        * Crafting grid, if the input stack size was exactly 1</div>
<div class="line">        * Player inventory, if input stack size was larger</div>
<div class="line">        * Drops as item entity, if it fits neither in craft grid or inventory</div>
<div class="line"> </div>
<div class="line">#### Examples</div>
<div class="line"> </div>
<div class="line">A typical shaped recipe:</div>
<div class="line"> </div>
<div class="line">```lua</div>
<div class="line">-- Stone pickaxe</div>
<div class="line">{</div>
<div class="line">    output = &quot;example:stone_pickaxe&quot;,</div>
<div class="line">    -- A 3x3 recipe which needs 3 stone in the 1st row,</div>
<div class="line">    -- and 1 stick in the horizontal middle in each of the 2nd and 3nd row.</div>
<div class="line">    -- The 4 remaining slots have to be empty.</div>
<div class="line">    recipe = {</div>
<div class="line">        {&quot;example:stone&quot;, &quot;example:stone&quot;, &quot;example:stone&quot;}, -- row 1</div>
<div class="line">        {&quot;&quot;,              &quot;example:stick&quot;, &quot;&quot;             }, -- row 2</div>
<div class="line">        {&quot;&quot;,              &quot;example:stick&quot;, &quot;&quot;             }, -- row 3</div>
<div class="line">    --   ^ column 1       ^ column 2       ^ column 3</div>
<div class="line">    },</div>
<div class="line">    -- There is no replacements table, so every input item</div>
<div class="line">    -- will be consumed.</div>
<div class="line">}</div>
</div><!-- fragment --><p>Simple replacement example:</p>
<div class="fragment"><div class="line">-- Wet sponge</div>
<div class="line">{</div>
<div class="line">    output = &quot;example:wet_sponge&quot;,</div>
<div class="line">    -- 1x2 recipe with a water bucket above a dry sponge</div>
<div class="line">    recipe = {</div>
<div class="line">        {&quot;example:water_bucket&quot;},</div>
<div class="line">        {&quot;example:dry_sponge&quot;},</div>
<div class="line">    },</div>
<div class="line">    -- When the wet sponge is crafted, the water bucket</div>
<div class="line">    -- in the input slot is replaced with an empty</div>
<div class="line">    -- bucket</div>
<div class="line">    replacements = {</div>
<div class="line">        {&quot;example:water_bucket&quot;, &quot;example:empty_bucket&quot;},</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><p>Complex replacement example 1:</p>
<div class="fragment"><div class="line">-- Very wet sponge</div>
<div class="line">{</div>
<div class="line">    output = &quot;example:very_wet_sponge&quot;,</div>
<div class="line">    -- 3x3 recipe with a wet sponge in the center</div>
<div class="line">    -- and 4 water buckets around it</div>
<div class="line">    recipe = {</div>
<div class="line">        {&quot;&quot;,&quot;example:water_bucket&quot;,&quot;&quot;},</div>
<div class="line">        {&quot;example:water_bucket&quot;,&quot;example:wet_sponge&quot;,&quot;example:water_bucket&quot;},</div>
<div class="line">        {&quot;&quot;,&quot;example:water_bucket&quot;,&quot;&quot;},</div>
<div class="line">    },</div>
<div class="line">    -- When the wet sponge is crafted, all water buckets</div>
<div class="line">    -- in the input slot become empty</div>
<div class="line">    replacements = {</div>
<div class="line">        -- Without these repetitions, only the first</div>
<div class="line">        -- water bucket would be replaced.</div>
<div class="line">        {&quot;example:water_bucket&quot;, &quot;example:empty_bucket&quot;},</div>
<div class="line">        {&quot;example:water_bucket&quot;, &quot;example:empty_bucket&quot;},</div>
<div class="line">        {&quot;example:water_bucket&quot;, &quot;example:empty_bucket&quot;},</div>
<div class="line">        {&quot;example:water_bucket&quot;, &quot;example:empty_bucket&quot;},</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><p>Complex replacement example 2:</p>
<div class="fragment"><div class="line">-- Magic book:</div>
<div class="line">-- 3 magic orbs + 1 book crafts a magic book,</div>
<div class="line">-- and the orbs will be replaced with 3 different runes.</div>
<div class="line">{</div>
<div class="line">    output = &quot;example:magic_book&quot;,</div>
<div class="line">    -- 3x2 recipe</div>
<div class="line">    recipe = {</div>
<div class="line">        -- 3 items in the group `magic_orb` on top of a book in the middle</div>
<div class="line">        {&quot;group:magic_orb&quot;, &quot;group:magic_orb&quot;, &quot;group:magic_orb&quot;},</div>
<div class="line">        {&quot;&quot;, &quot;example:book&quot;, &quot;&quot;},</div>
<div class="line">    },</div>
<div class="line">    -- When the book is crafted, the 3 magic orbs will be turned into</div>
<div class="line">    -- 3 runes: ice rune, earth rune and fire rune (from left to right)</div>
<div class="line">    replacements = {</div>
<div class="line">        {&quot;group:magic_orb&quot;, &quot;example:ice_rune&quot;},</div>
<div class="line">        {&quot;group:magic_orb&quot;, &quot;example:earth_rune&quot;},</div>
<div class="line">        {&quot;group:magic_orb&quot;, &quot;example:fire_rune&quot;},</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1119"></a>
Shapeless</h3>
<p>Takes a list of input items (at least 1). The order or arrangement of input items does not matter.</p>
<p>In order to craft the recipe, the players' crafting grid must have matching or larger <em>count</em> of slots. The grid dimensions do not matter.</p>
<p>Parameters:</p>
<ul>
<li><code>type = "shapeless"</code>: Mandatory</li>
<li><code>output</code>: Same as for shaped recipe</li>
<li><code>recipe</code>: List of item names</li>
<li><code>replacements</code>: Same as for shaped recipe</li>
</ul>
<h4><a class="anchor" id="autotoc_md1120"></a>
Example</h4>
<div class="fragment"><div class="line">{</div>
<div class="line">    -- Craft a mushroom stew from a bowl, a brown mushroom and a red mushroom</div>
<div class="line">    -- (no matter where in the input grid the items are placed)</div>
<div class="line">    type = &quot;shapeless&quot;,</div>
<div class="line">    output = &quot;example:mushroom_stew&quot;,</div>
<div class="line">    recipe = {</div>
<div class="line">        &quot;example:bowl&quot;,</div>
<div class="line">        &quot;example:mushroom_brown&quot;,</div>
<div class="line">        &quot;example:mushroom_red&quot;,</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1121"></a>
Tool repair</h3>
<p>Syntax: </p><pre class="fragment">{
    type = "toolrepair",
    additional_wear = -0.02, -- multiplier of 65536
}
</pre><p>Adds a shapeless recipe for <em>every</em> tool that doesn't have the <code>disable_repair=1</code> group. If this recipe is used, repairing is possible with any crafting grid with at least 2 slots. The player can put 2 equal tools in the craft grid to get one "repaired" tool back. The wear of the output is determined by the wear of both tools, plus a 'repair bonus' given by <code>additional_wear</code>. To reduce the wear (i.e. 'repair'), you want <code>additional_wear</code> to be negative.</p>
<p>The formula used to calculate the resulting wear is: </p><pre class="fragment">65536 * (1 - ( (1 - tool_1_wear) + (1 - tool_2_wear) + additional_wear))
</pre><p>The result is rounded and can't be lower than 0. If the result is 65536 or higher, no crafting is possible.</p>
<h3><a class="anchor" id="autotoc_md1122"></a>
Cooking</h3>
<p>A cooking recipe has a single input item, a single output item stack and a cooking time. It represents cooking/baking/smelting/etc. items in an oven, furnace, or something similar; the exact meaning is up for games to decide, if they choose to use cooking at all.</p>
<p>The engine does not implement anything specific to cooking recipes, but the recipes can be retrieved later using <code>minetest.get_craft_result</code> to have a consistent interface across different games/mods.</p>
<p>Parameters:</p>
<ul>
<li><code>type = "cooking"</code>: Mandatory</li>
<li><code>output</code>: Same as for shaped recipe</li>
<li><code>recipe</code>: An itemname of the single input item</li>
<li><code>cooktime</code>: (optional) Time it takes to cook this item, in seconds. A floating-point number. (default: 3.0)</li>
<li><code>replacements</code>: Same meaning as for shaped recipes, but the mods that utilize cooking recipes (e.g. for adding a furnace node) need to implement replacements on their own</li>
</ul>
<p>Note: Games and mods are free to re-interpret the cooktime in special cases, e.g. for a super furnace that cooks items twice as fast.</p>
<h4><a class="anchor" id="autotoc_md1123"></a>
Example</h4>
<p>Cooking sand to glass in 3 seconds:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    type = &quot;cooking&quot;,</div>
<div class="line">    output = &quot;example:glass&quot;,</div>
<div class="line">    recipe = &quot;example:sand&quot;,</div>
<div class="line">    cooktime = 3.0,</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1124"></a>
Fuel</h3>
<p>A fuel recipe is an item associated with a "burning time" and an optional item replacement. There is no output. This is usually used as fuel for furnaces, ovens, stoves, etc.</p>
<p>Like with cooking recipes, the engine does not do anything specific with fuel recipes and it's up to games and mods to use them by retrieving them via <code>minetest.get_craft_result</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>type = "fuel"</code>: Mandatory</li>
<li><code>recipe</code>: Itemname of the item to be used as fuel</li>
<li><code>burntime</code>: (optional) Burning time this item provides, in seconds. A floating-point number. (default: 1.0)</li>
<li><code>replacements</code>: Same meaning as for shaped recipes, but the mods that utilize fuels need to implement replacements on their own</li>
</ul>
<p>Note: Games and mods are free to re-interpret the burntime in special cases, e.g. for an efficient furnace in which fuels burn twice as long.</p>
<h4><a class="anchor" id="autotoc_md1125"></a>
Examples</h4>
<p>Coal lump with a burntime of 20 seconds. Will be consumed when used.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    type = &quot;fuel&quot;,</div>
<div class="line">    recipe = &quot;example:coal_lump&quot;,</div>
<div class="line">    burntime = 20.0,</div>
<div class="line">}</div>
</div><!-- fragment --><p>Lava bucket with a burn time of 60 seconds. Will become an empty bucket if used:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    type = &quot;fuel&quot;,</div>
<div class="line">    recipe = &quot;example:lava_bucket&quot;,</div>
<div class="line">    burntime = 60.0,</div>
<div class="line">    replacements = {{&quot;example:lava_bucket&quot;, &quot;example:empty_bucket&quot;}},</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1126"></a>
Ore definition</h2>
<p>Used by <code>minetest.register_ore</code>.</p>
<p>See [Ores] section above for essential information.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    ore_type = &quot;&quot;,</div>
<div class="line">    -- Supported: &quot;scatter&quot;, &quot;sheet&quot;, &quot;puff&quot;, &quot;blob&quot;, &quot;vein&quot;, &quot;stratum&quot;</div>
<div class="line"> </div>
<div class="line">    ore = &quot;&quot;,</div>
<div class="line">    -- Ore node to place</div>
<div class="line"> </div>
<div class="line">    ore_param2 = 0,</div>
<div class="line">    -- Param2 to set for ore (e.g. facedir rotation)</div>
<div class="line"> </div>
<div class="line">    wherein = &quot;&quot;,</div>
<div class="line">    -- Node to place ore in. Multiple are possible by passing a list.</div>
<div class="line"> </div>
<div class="line">    clust_scarcity = 8 * 8 * 8,</div>
<div class="line">    -- Ore has a 1 out of clust_scarcity chance of spawning in a node.</div>
<div class="line">    -- If the desired average distance between ores is &#39;d&#39;, set this to</div>
<div class="line">    -- d * d * d.</div>
<div class="line"> </div>
<div class="line">    clust_num_ores = 8,</div>
<div class="line">    -- Number of ores in a cluster</div>
<div class="line"> </div>
<div class="line">    clust_size = 3,</div>
<div class="line">    -- Size of the bounding box of the cluster.</div>
<div class="line">    -- In this example, there is a 3 * 3 * 3 cluster where 8 out of the 27</div>
<div class="line">    -- nodes are coal ore.</div>
<div class="line"> </div>
<div class="line">    y_min = -31000,</div>
<div class="line">    y_max = 31000,</div>
<div class="line">    -- Lower and upper limits for ore (inclusive)</div>
<div class="line"> </div>
<div class="line">    flags = &quot;&quot;,</div>
<div class="line">    -- Attributes for the ore generation, see &#39;Ore attributes&#39; section above</div>
<div class="line"> </div>
<div class="line">    noise_threshold = 0,</div>
<div class="line">    -- If noise is above this threshold, ore is placed. Not needed for a</div>
<div class="line">    -- uniform distribution.</div>
<div class="line"> </div>
<div class="line">    noise_params = {</div>
<div class="line">        offset = 0,</div>
<div class="line">        scale = 1,</div>
<div class="line">        spread = {x = 100, y = 100, z = 100},</div>
<div class="line">        seed = 23,</div>
<div class="line">        octaves = 3,</div>
<div class="line">        persistence = 0.7</div>
<div class="line">    },</div>
<div class="line">    -- NoiseParams structure describing one of the perlin noises used for</div>
<div class="line">    -- ore distribution.</div>
<div class="line">    -- Needed by &quot;sheet&quot;, &quot;puff&quot;, &quot;blob&quot; and &quot;vein&quot; ores.</div>
<div class="line">    -- Omit from &quot;scatter&quot; ore for a uniform ore distribution.</div>
<div class="line">    -- Omit from &quot;stratum&quot; ore for a simple horizontal strata from y_min to</div>
<div class="line">    -- y_max.</div>
<div class="line"> </div>
<div class="line">    biomes = {&quot;desert&quot;, &quot;rainforest&quot;},</div>
<div class="line">    -- List of biomes in which this ore occurs.</div>
<div class="line">    -- Occurs in all biomes if this is omitted, and ignored if the Mapgen</div>
<div class="line">    -- being used does not support biomes.</div>
<div class="line">    -- Can be a list of (or a single) biome names, IDs, or definitions.</div>
<div class="line"> </div>
<div class="line">    -- Type-specific parameters</div>
<div class="line"> </div>
<div class="line">    -- &quot;sheet&quot;</div>
<div class="line">    column_height_min = 1,</div>
<div class="line">    column_height_max = 16,</div>
<div class="line">    column_midpoint_factor = 0.5,</div>
<div class="line"> </div>
<div class="line">    -- &quot;puff&quot;</div>
<div class="line">    np_puff_top = {</div>
<div class="line">        offset = 4,</div>
<div class="line">        scale = 2,</div>
<div class="line">        spread = {x = 100, y = 100, z = 100},</div>
<div class="line">        seed = 47,</div>
<div class="line">        octaves = 3,</div>
<div class="line">        persistence = 0.7</div>
<div class="line">    },</div>
<div class="line">    np_puff_bottom = {</div>
<div class="line">        offset = 4,</div>
<div class="line">        scale = 2,</div>
<div class="line">        spread = {x = 100, y = 100, z = 100},</div>
<div class="line">        seed = 11,</div>
<div class="line">        octaves = 3,</div>
<div class="line">        persistence = 0.7</div>
<div class="line">    },</div>
<div class="line"> </div>
<div class="line">    -- &quot;vein&quot;</div>
<div class="line">    random_factor = 1.0,</div>
<div class="line"> </div>
<div class="line">    -- &quot;stratum&quot;</div>
<div class="line">    np_stratum_thickness = {</div>
<div class="line">        offset = 8,</div>
<div class="line">        scale = 4,</div>
<div class="line">        spread = {x = 100, y = 100, z = 100},</div>
<div class="line">        seed = 17,</div>
<div class="line">        octaves = 3,</div>
<div class="line">        persistence = 0.7</div>
<div class="line">    },</div>
<div class="line">    stratum_thickness = 8, -- only used if no noise defined</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1127"></a>
Biome definition</h2>
<p>Used by <code>minetest.register_biome</code>.</p>
<p>The maximum number of biomes that can be used is 65535. However, using an excessive number of biomes will slow down map generation. Depending on desired performance and computing power the practical limit is much lower.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    name = &quot;tundra&quot;,</div>
<div class="line"> </div>
<div class="line">    node_dust = &quot;default:snow&quot;,</div>
<div class="line">    -- Node dropped onto upper surface after all else is generated</div>
<div class="line"> </div>
<div class="line">    node_top = &quot;default:dirt_with_snow&quot;,</div>
<div class="line">    depth_top = 1,</div>
<div class="line">    -- Node forming surface layer of biome and thickness of this layer</div>
<div class="line"> </div>
<div class="line">    node_filler = &quot;default:permafrost&quot;,</div>
<div class="line">    depth_filler = 3,</div>
<div class="line">    -- Node forming lower layer of biome and thickness of this layer</div>
<div class="line"> </div>
<div class="line">    node_stone = &quot;default:bluestone&quot;,</div>
<div class="line">    -- Node that replaces all stone nodes between roughly y_min and y_max.</div>
<div class="line"> </div>
<div class="line">    node_water_top = &quot;default:ice&quot;,</div>
<div class="line">    depth_water_top = 10,</div>
<div class="line">    -- Node forming a surface layer in seawater with the defined thickness</div>
<div class="line"> </div>
<div class="line">    node_water = &quot;&quot;,</div>
<div class="line">    -- Node that replaces all seawater nodes not in the surface layer</div>
<div class="line"> </div>
<div class="line">    node_river_water = &quot;default:ice&quot;,</div>
<div class="line">    -- Node that replaces river water in mapgens that use</div>
<div class="line">    -- default:river_water</div>
<div class="line"> </div>
<div class="line">    node_riverbed = &quot;default:gravel&quot;,</div>
<div class="line">    depth_riverbed = 2,</div>
<div class="line">    -- Node placed under river water and thickness of this layer</div>
<div class="line"> </div>
<div class="line">    node_cave_liquid = &quot;default:lava_source&quot;,</div>
<div class="line">    node_cave_liquid = {&quot;default:water_source&quot;, &quot;default:lava_source&quot;},</div>
<div class="line">    -- Nodes placed inside 50% of the medium size caves.</div>
<div class="line">    -- Multiple nodes can be specified, each cave will use a randomly</div>
<div class="line">    -- chosen node from the list.</div>
<div class="line">    -- If this field is left out or &#39;nil&#39;, cave liquids fall back to</div>
<div class="line">    -- classic behavior of lava and water distributed using 3D noise.</div>
<div class="line">    -- For no cave liquid, specify &quot;air&quot;.</div>
<div class="line"> </div>
<div class="line">    node_dungeon = &quot;default:cobble&quot;,</div>
<div class="line">    -- Node used for primary dungeon structure.</div>
<div class="line">    -- If absent, dungeon nodes fall back to the &#39;mapgen_cobble&#39; mapgen</div>
<div class="line">    -- alias, if that is also absent, dungeon nodes fall back to the biome</div>
<div class="line">    -- &#39;node_stone&#39;.</div>
<div class="line">    -- If present, the following two nodes are also used.</div>
<div class="line"> </div>
<div class="line">    node_dungeon_alt = &quot;default:mossycobble&quot;,</div>
<div class="line">    -- Node used for randomly-distributed alternative structure nodes.</div>
<div class="line">    -- If alternative structure nodes are not wanted leave this absent.</div>
<div class="line"> </div>
<div class="line">    node_dungeon_stair = &quot;stairs:stair_cobble&quot;,</div>
<div class="line">    -- Node used for dungeon stairs.</div>
<div class="line">    -- If absent, stairs fall back to &#39;node_dungeon&#39;.</div>
<div class="line"> </div>
<div class="line">    y_max = 31000,</div>
<div class="line">    y_min = 1,</div>
<div class="line">    -- Upper and lower limits for biome.</div>
<div class="line">    -- Alternatively you can use xyz limits as shown below.</div>
<div class="line"> </div>
<div class="line">    max_pos = {x = 31000, y = 128, z = 31000},</div>
<div class="line">    min_pos = {x = -31000, y = 9, z = -31000},</div>
<div class="line">    -- xyz limits for biome, an alternative to using &#39;y_min&#39; and &#39;y_max&#39;.</div>
<div class="line">    -- Biome is limited to a cuboid defined by these positions.</div>
<div class="line">    -- Any x, y or z field left undefined defaults to -31000 in &#39;min_pos&#39; or</div>
<div class="line">    -- 31000 in &#39;max_pos&#39;.</div>
<div class="line"> </div>
<div class="line">    vertical_blend = 8,</div>
<div class="line">    -- Vertical distance in nodes above &#39;y_max&#39; over which the biome will</div>
<div class="line">    -- blend with the biome above.</div>
<div class="line">    -- Set to 0 for no vertical blend. Defaults to 0.</div>
<div class="line"> </div>
<div class="line">    heat_point = 0,</div>
<div class="line">    humidity_point = 50,</div>
<div class="line">    -- Characteristic temperature and humidity for the biome.</div>
<div class="line">    -- These values create &#39;biome points&#39; on a voronoi diagram with heat and</div>
<div class="line">    -- humidity as axes. The resulting voronoi cells determine the</div>
<div class="line">    -- distribution of the biomes.</div>
<div class="line">    -- Heat and humidity have average values of 50, vary mostly between</div>
<div class="line">    -- 0 and 100 but can exceed these values.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1128"></a>
Decoration definition</h2>
<p>See [<a class="el" href="classDecoration.html">Decoration</a> types]. Used by <code>minetest.register_decoration</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    deco_type = &quot;simple&quot;,</div>
<div class="line">    -- Type. &quot;simple&quot; or &quot;schematic&quot; supported</div>
<div class="line"> </div>
<div class="line">    place_on = &quot;default:dirt_with_grass&quot;,</div>
<div class="line">    -- Node (or list of nodes) that the decoration can be placed on</div>
<div class="line"> </div>
<div class="line">    sidelen = 8,</div>
<div class="line">    -- Size of the square (X / Z) divisions of the mapchunk being generated.</div>
<div class="line">    -- Determines the resolution of noise variation if used.</div>
<div class="line">    -- If the chunk size is not evenly divisible by sidelen, sidelen is made</div>
<div class="line">    -- equal to the chunk size.</div>
<div class="line"> </div>
<div class="line">    fill_ratio = 0.02,</div>
<div class="line">    -- The value determines &#39;decorations per surface node&#39;.</div>
<div class="line">    -- Used only if noise_params is not specified.</div>
<div class="line">    -- If &gt;= 10.0 complete coverage is enabled and decoration placement uses</div>
<div class="line">    -- a different and much faster method.</div>
<div class="line"> </div>
<div class="line">    noise_params = {</div>
<div class="line">        offset = 0,</div>
<div class="line">        scale = 0.45,</div>
<div class="line">        spread = {x = 100, y = 100, z = 100},</div>
<div class="line">        seed = 354,</div>
<div class="line">        octaves = 3,</div>
<div class="line">        persistence = 0.7,</div>
<div class="line">        lacunarity = 2.0,</div>
<div class="line">        flags = &quot;absvalue&quot;</div>
<div class="line">    },</div>
<div class="line">    -- NoiseParams structure describing the perlin noise used for decoration</div>
<div class="line">    -- distribution.</div>
<div class="line">    -- A noise value is calculated for each square division and determines</div>
<div class="line">    -- &#39;decorations per surface node&#39; within each division.</div>
<div class="line">    -- If the noise value &gt;= 10.0 complete coverage is enabled and</div>
<div class="line">    -- decoration placement uses a different and much faster method.</div>
<div class="line"> </div>
<div class="line">    biomes = {&quot;Oceanside&quot;, &quot;Hills&quot;, &quot;Plains&quot;},</div>
<div class="line">    -- List of biomes in which this decoration occurs. Occurs in all biomes</div>
<div class="line">    -- if this is omitted, and ignored if the Mapgen being used does not</div>
<div class="line">    -- support biomes.</div>
<div class="line">    -- Can be a list of (or a single) biome names, IDs, or definitions.</div>
<div class="line"> </div>
<div class="line">    y_min = -31000,</div>
<div class="line">    y_max = 31000,</div>
<div class="line">    -- Lower and upper limits for decoration (inclusive).</div>
<div class="line">    -- These parameters refer to the Y co-ordinate of the &#39;place_on&#39; node.</div>
<div class="line"> </div>
<div class="line">    spawn_by = &quot;default:water&quot;,</div>
<div class="line">    -- Node (or list of nodes) that the decoration only spawns next to.</div>
<div class="line">    -- Checks the 8 neighboring nodes on the same Y, and also the ones</div>
<div class="line">    -- at Y+1, excluding both center nodes.</div>
<div class="line"> </div>
<div class="line">    num_spawn_by = 1,</div>
<div class="line">    -- Number of spawn_by nodes that must be surrounding the decoration</div>
<div class="line">    -- position to occur.</div>
<div class="line">    -- If absent or -1, decorations occur next to any nodes.</div>
<div class="line"> </div>
<div class="line">    flags = &quot;liquid_surface, force_placement, all_floors, all_ceilings&quot;,</div>
<div class="line">    -- Flags for all decoration types.</div>
<div class="line">    -- &quot;liquid_surface&quot;: Instead of placement on the highest solid surface</div>
<div class="line">    --   in a mapchunk column, placement is on the highest liquid surface.</div>
<div class="line">    --   Placement is disabled if solid nodes are found above the liquid</div>
<div class="line">    --   surface.</div>
<div class="line">    -- &quot;force_placement&quot;: Nodes other than &quot;air&quot; and &quot;ignore&quot; are replaced</div>
<div class="line">    --   by the decoration.</div>
<div class="line">    -- &quot;all_floors&quot;, &quot;all_ceilings&quot;: Instead of placement on the highest</div>
<div class="line">    --   surface in a mapchunk the decoration is placed on all floor and/or</div>
<div class="line">    --   ceiling surfaces, for example in caves and dungeons.</div>
<div class="line">    --   Ceiling decorations act as an inversion of floor decorations so the</div>
<div class="line">    --   effect of &#39;place_offset_y&#39; is inverted.</div>
<div class="line">    --   Y-slice probabilities do not function correctly for ceiling</div>
<div class="line">    --   schematic decorations as the behavior is unchanged.</div>
<div class="line">    --   If a single decoration registration has both flags the floor and</div>
<div class="line">    --   ceiling decorations will be aligned vertically.</div>
<div class="line"> </div>
<div class="line">    ----- Simple-type parameters</div>
<div class="line"> </div>
<div class="line">    decoration = &quot;default:grass&quot;,</div>
<div class="line">    -- The node name used as the decoration.</div>
<div class="line">    -- If instead a list of strings, a randomly selected node from the list</div>
<div class="line">    -- is placed as the decoration.</div>
<div class="line"> </div>
<div class="line">    height = 1,</div>
<div class="line">    -- Decoration height in nodes.</div>
<div class="line">    -- If height_max is not 0, this is the lower limit of a randomly</div>
<div class="line">    -- selected height.</div>
<div class="line"> </div>
<div class="line">    height_max = 0,</div>
<div class="line">    -- Upper limit of the randomly selected height.</div>
<div class="line">    -- If absent, the parameter &#39;height&#39; is used as a constant.</div>
<div class="line"> </div>
<div class="line">    param2 = 0,</div>
<div class="line">    -- Param2 value of decoration nodes.</div>
<div class="line">    -- If param2_max is not 0, this is the lower limit of a randomly</div>
<div class="line">    -- selected param2.</div>
<div class="line"> </div>
<div class="line">    param2_max = 0,</div>
<div class="line">    -- Upper limit of the randomly selected param2.</div>
<div class="line">    -- If absent, the parameter &#39;param2&#39; is used as a constant.</div>
<div class="line"> </div>
<div class="line">    place_offset_y = 0,</div>
<div class="line">    -- Y offset of the decoration base node relative to the standard base</div>
<div class="line">    -- node position.</div>
<div class="line">    -- Can be positive or negative. Default is 0.</div>
<div class="line">    -- Effect is inverted for &quot;all_ceilings&quot; decorations.</div>
<div class="line">    -- Ignored by &#39;y_min&#39;, &#39;y_max&#39; and &#39;spawn_by&#39; checks, which always refer</div>
<div class="line">    -- to the &#39;place_on&#39; node.</div>
<div class="line"> </div>
<div class="line">    ----- Schematic-type parameters</div>
<div class="line"> </div>
<div class="line">    schematic = &quot;foobar.mts&quot;,</div>
<div class="line">    -- If schematic is a string, it is the filepath relative to the current</div>
<div class="line">    -- working directory of the specified Minetest schematic file.</div>
<div class="line">    -- Could also be the ID of a previously registered schematic.</div>
<div class="line"> </div>
<div class="line">    schematic = {</div>
<div class="line">        size = {x = 4, y = 6, z = 4},</div>
<div class="line">        data = {</div>
<div class="line">            {name = &quot;default:cobble&quot;, param1 = 255, param2 = 0},</div>
<div class="line">            {name = &quot;default:dirt_with_grass&quot;, param1 = 255, param2 = 0},</div>
<div class="line">            {name = &quot;air&quot;, param1 = 255, param2 = 0},</div>
<div class="line">              ...</div>
<div class="line">        },</div>
<div class="line">        yslice_prob = {</div>
<div class="line">            {ypos = 2, prob = 128},</div>
<div class="line">            {ypos = 5, prob = 64},</div>
<div class="line">              ...</div>
<div class="line">        },</div>
<div class="line">    },</div>
<div class="line">    -- Alternative schematic specification by supplying a table. The fields</div>
<div class="line">    -- size and data are mandatory whereas yslice_prob is optional.</div>
<div class="line">    -- See &#39;Schematic specifier&#39; for details.</div>
<div class="line"> </div>
<div class="line">    replacements = {[&quot;oldname&quot;] = &quot;convert_to&quot;, ...},</div>
<div class="line">    -- Map of node names to replace in the schematic after reading it.</div>
<div class="line"> </div>
<div class="line">    flags = &quot;place_center_x, place_center_y, place_center_z&quot;,</div>
<div class="line">    -- Flags for schematic decorations. See &#39;Schematic attributes&#39;.</div>
<div class="line"> </div>
<div class="line">    rotation = &quot;90&quot;,</div>
<div class="line">    -- Rotation can be &quot;0&quot;, &quot;90&quot;, &quot;180&quot;, &quot;270&quot;, or &quot;random&quot;</div>
<div class="line"> </div>
<div class="line">    place_offset_y = 0,</div>
<div class="line">    -- If the flag &#39;place_center_y&#39; is set this parameter is ignored.</div>
<div class="line">    -- Y offset of the schematic base node layer relative to the &#39;place_on&#39;</div>
<div class="line">    -- node.</div>
<div class="line">    -- Can be positive or negative. Default is 0.</div>
<div class="line">    -- Effect is inverted for &quot;all_ceilings&quot; decorations.</div>
<div class="line">    -- Ignored by &#39;y_min&#39;, &#39;y_max&#39; and &#39;spawn_by&#39; checks, which always refer</div>
<div class="line">    -- to the &#39;place_on&#39; node.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1129"></a>
Chat command definition</h2>
<p>Used by <code>minetest.register_chatcommand</code>.</p>
<p>Specifies the function to be called and the privileges required when a player issues the command. A help message that is the concatenation of the params and description fields is shown when the "/help" chatcommand is issued.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    params = &quot;&quot;,</div>
<div class="line">    -- Short parameter description.  See the below note.</div>
<div class="line"> </div>
<div class="line">    description = &quot;&quot;,</div>
<div class="line">    -- General description of the command&#39;s purpose.</div>
<div class="line"> </div>
<div class="line">    privs = {},</div>
<div class="line">    -- Required privileges to run. See `minetest.check_player_privs()` for</div>
<div class="line">    -- the format and see [Privileges] for an overview of privileges.</div>
<div class="line"> </div>
<div class="line">    func = function(name, param),</div>
<div class="line">    -- Called when command is run.</div>
<div class="line">    -- * `name` is the name of the player who issued the command.</div>
<div class="line">    -- * `param` is a string with the full arguments to the command.</div>
<div class="line">    -- Returns a boolean for success and a string value.</div>
<div class="line">    -- The string is shown to the issuing player upon exit of `func` or,</div>
<div class="line">    -- if `func` returns `false` and no string, the help message is shown.</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note that in params, the conventional use of symbols is as follows:</p>
<ul>
<li><code>&lt;&gt;</code> signifies a placeholder to be replaced when the command is used. For example, when a player name is needed: <code>&lt;name&gt;</code></li>
<li><code>[]</code> signifies param is optional and not required when the command is used. For example, if you require param1 but param2 is optional: <code>&lt;param1&gt; [&lt;param2&gt;]</code></li>
<li><code>|</code> signifies exclusive or. The command requires one param from the options provided. For example: <code>&lt;param1&gt; | &lt;param2&gt;</code></li>
<li><code>()</code> signifies grouping. For example, when param1 and param2 are both required, or only param3 is required: <code>(&lt;param1&gt; &lt;param2&gt;) | &lt;param3&gt;</code></li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    params = &quot;&lt;name&gt; &lt;privilege&gt;&quot;,</div>
<div class="line"> </div>
<div class="line">    description = &quot;Remove privilege from player&quot;,</div>
<div class="line"> </div>
<div class="line">    privs = {privs=true},  -- Require the &quot;privs&quot; privilege to run</div>
<div class="line"> </div>
<div class="line">    func = function(name, param),</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1130"></a>
Privilege definition</h2>
<p>Used by <code>minetest.register_privilege</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    description = &quot;&quot;,</div>
<div class="line">    -- Privilege description</div>
<div class="line"> </div>
<div class="line">    give_to_singleplayer = true,</div>
<div class="line">    -- Whether to grant the privilege to singleplayer.</div>
<div class="line"> </div>
<div class="line">    give_to_admin = true,</div>
<div class="line">    -- Whether to grant the privilege to the server admin.</div>
<div class="line">    -- Uses value of &#39;give_to_singleplayer&#39; by default.</div>
<div class="line"> </div>
<div class="line">    on_grant = function(name, granter_name),</div>
<div class="line">    -- Called when given to player &#39;name&#39; by &#39;granter_name&#39;.</div>
<div class="line">    -- &#39;granter_name&#39; will be nil if the priv was granted by a mod.</div>
<div class="line"> </div>
<div class="line">    on_revoke = function(name, revoker_name),</div>
<div class="line">    -- Called when taken from player &#39;name&#39; by &#39;revoker_name&#39;.</div>
<div class="line">    -- &#39;revoker_name&#39; will be nil if the priv was revoked by a mod.</div>
<div class="line"> </div>
<div class="line">    -- Note that the above two callbacks will be called twice if a player is</div>
<div class="line">    -- responsible, once with the player name, and then with a nil player</div>
<div class="line">    -- name.</div>
<div class="line">    -- Return true in the above callbacks to stop register_on_priv_grant or</div>
<div class="line">    -- revoke being called.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1131"></a>
Detached inventory callbacks</h2>
<p>Used by <code>minetest.create_detached_inventory</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    allow_move = function(inv, from_list, from_index, to_list, to_index, count, player),</div>
<div class="line">    -- Called when a player wants to move items inside the inventory.</div>
<div class="line">    -- Return value: number of items allowed to move.</div>
<div class="line"> </div>
<div class="line">    allow_put = function(inv, listname, index, stack, player),</div>
<div class="line">    -- Called when a player wants to put something into the inventory.</div>
<div class="line">    -- Return value: number of items allowed to put.</div>
<div class="line">    -- Return value -1: Allow and don&#39;t modify item count in inventory.</div>
<div class="line"> </div>
<div class="line">    allow_take = function(inv, listname, index, stack, player),</div>
<div class="line">    -- Called when a player wants to take something out of the inventory.</div>
<div class="line">    -- Return value: number of items allowed to take.</div>
<div class="line">    -- Return value -1: Allow and don&#39;t modify item count in inventory.</div>
<div class="line"> </div>
<div class="line">    on_move = function(inv, from_list, from_index, to_list, to_index, count, player),</div>
<div class="line">    on_put = function(inv, listname, index, stack, player),</div>
<div class="line">    on_take = function(inv, listname, index, stack, player),</div>
<div class="line">    -- Called after the actual action has happened, according to what was</div>
<div class="line">    -- allowed.</div>
<div class="line">    -- No return value.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1132"></a>
HUD Definition</h2>
<p>Since most values have multiple different functions, please see the documentation in [HUD] section.</p>
<p>Used by <code><a class="el" href="classObjectRef.html">ObjectRef</a>:hud_add</code>. Returned by <code><a class="el" href="classObjectRef.html">ObjectRef</a>:hud_get</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    hud_elem_type = &quot;image&quot;,</div>
<div class="line">    -- Type of element, can be &quot;image&quot;, &quot;text&quot;, &quot;statbar&quot;, &quot;inventory&quot;,</div>
<div class="line">    -- &quot;waypoint&quot;, &quot;image_waypoint&quot;, &quot;compass&quot; or &quot;minimap&quot;</div>
<div class="line"> </div>
<div class="line">    position = {x=0.5, y=0.5},</div>
<div class="line">    -- Top left corner position of element</div>
<div class="line"> </div>
<div class="line">    name = &quot;&lt;name&gt;&quot;,</div>
<div class="line"> </div>
<div class="line">    scale = {x = 1, y = 1},</div>
<div class="line"> </div>
<div class="line">    text = &quot;&lt;text&gt;&quot;,</div>
<div class="line"> </div>
<div class="line">    text2 = &quot;&lt;text&gt;&quot;,</div>
<div class="line"> </div>
<div class="line">    number = 0,</div>
<div class="line"> </div>
<div class="line">    item = 0,</div>
<div class="line"> </div>
<div class="line">    direction = 0,</div>
<div class="line">    -- Direction: 0: left-right, 1: right-left, 2: top-bottom, 3: bottom-top</div>
<div class="line"> </div>
<div class="line">    alignment = {x=0, y=0},</div>
<div class="line"> </div>
<div class="line">    offset = {x=0, y=0},</div>
<div class="line"> </div>
<div class="line">    world_pos = {x=0, y=0, z=0},</div>
<div class="line"> </div>
<div class="line">    size = {x=0, y=0},</div>
<div class="line"> </div>
<div class="line">    z_index = 0,</div>
<div class="line">    -- Z index: lower z-index HUDs are displayed behind higher z-index HUDs</div>
<div class="line"> </div>
<div class="line">    style = 0,</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1133"></a>
Particle definition</h2>
<p>Used by <code>minetest.add_particle</code>.</p>
<p>```lua { pos = {x=0, y=0, z=0}, velocity = {x=0, y=0, z=0}, acceleration = {x=0, y=0, z=0}, &ndash; Spawn particle at pos with velocity and acceleration</p>
<p>expirationtime = 1, &ndash; Disappears after expirationtime seconds</p>
<p>size = 1, &ndash; Scales the visual size of the particle texture. &ndash; If <code>node</code> is set, size can be set to 0 to spawn a randomly-sized &ndash; particle (just like actual node dig particles).</p>
<p>collisiondetection = false, &ndash; If true collides with <code>walkable</code> nodes and, depending on the &ndash; <code>object_collision</code> field, objects too.</p>
<p>collision_removal = false, &ndash; If true particle is removed when it collides. &ndash; Requires collisiondetection = true to have any effect.</p>
<p>object_collision = false, &ndash; If true particle collides with objects that are defined as &ndash; <code>physical = true,</code> and <code>collide_with_objects = true,</code>. &ndash; Requires collisiondetection = true to have any effect.</p>
<p>vertical = false, &ndash; If true faces player using y axis only</p>
<p>texture = "image.png", &ndash; The texture of the particle &ndash; v5.6.0 and later: also supports the table format described in the &ndash; following section</p>
<p>playername = "singleplayer", &ndash; <a class="el" href="classOptional.html">Optional</a>, if specified spawns particle only on the player's client</p>
<p>animation = {Tile Animation definition}, &ndash; <a class="el" href="classOptional.html">Optional</a>, specifies how to animate the particle texture</p>
<p>glow = 0 &ndash; <a class="el" href="classOptional.html">Optional</a>, specify particle self-luminescence in darkness. &ndash; Values 0-14.</p>
<p>node = {name = "ignore", param2 = 0}, &ndash; <a class="el" href="classOptional.html">Optional</a>, if specified the particle will have the same appearance as &ndash; node dig particles for the given node. &ndash; <code>texture</code> and <code>animation</code> will be ignored if this is set.</p>
<p>node_tile = 0, &ndash; <a class="el" href="classOptional.html">Optional</a>, only valid in combination with <code>node</code> &ndash; If set to a valid number 1-6, specifies the tile from which the &ndash; particle texture is picked. &ndash; Otherwise, the default behavior is used. (currently: any random tile)</p>
<p>drag = {x=0, y=0, z=0}, &ndash; v5.6.0 and later: <a class="el" href="classOptional.html">Optional</a> drag value, consult the following section</p>
<p>bounce = {min = ..., max = ..., bias = 0}, &ndash; v5.6.0 and later: <a class="el" href="classOptional.html">Optional</a> bounce range, consult the following section } ```</p>
<h2><a class="anchor" id="autotoc_md1134"></a>
&lt;tt&gt;ParticleSpawner&lt;/tt&gt; definition</h2>
<p>Used by <code>minetest.add_particlespawner</code>.</p>
<p>Before v5.6.0, particlespawners used a different syntax and had a more limited set of features. Definition fields that are the same in both legacy and modern versions are shown in the next listing, and the fields that are used by legacy versions are shown separated by a comment; the modern fields are too complex to compactly describe in this manner and are documented after the listing.</p>
<p>The older syntax can be used in combination with the newer syntax (e.g. having <code>minpos</code>, <code>maxpos</code>, and <code>pos</code> all set) to support older servers. On newer servers, the new syntax will override the older syntax; on older servers, the newer syntax will be ignored.</p>
<p>```lua { &ndash; Common fields (same name and meaning in both new and legacy syntax)</p>
<p>amount = 1, &ndash; Number of particles spawned over the time period <code>time</code>.</p>
<p>time = 1, &ndash; Lifespan of spawner in seconds. &ndash; If time is 0 spawner has infinite lifespan and spawns the <code>amount</code> on &ndash; a per-second basis.</p>
<p>collisiondetection = false, &ndash; If true collide with <code>walkable</code> nodes and, depending on the &ndash; <code>object_collision</code> field, objects too.</p>
<p>collision_removal = false, &ndash; If true particles are removed when they collide. &ndash; Requires collisiondetection = true to have any effect.</p>
<p>object_collision = false, &ndash; If true particles collide with objects that are defined as &ndash; <code>physical = true,</code> and <code>collide_with_objects = true,</code>. &ndash; Requires collisiondetection = true to have any effect.</p>
<p>attached = <a class="el" href="classObjectRef.html">ObjectRef</a>, &ndash; If defined, particle positions, velocities and accelerations are &ndash; relative to this object's position and yaw</p>
<p>vertical = false, &ndash; If true face player using y axis only</p>
<p>texture = "image.png", &ndash; The texture of the particle</p>
<p>playername = "singleplayer", &ndash; <a class="el" href="classOptional.html">Optional</a>, if specified spawns particles only on the player's client</p>
<p>animation = {Tile Animation definition}, &ndash; <a class="el" href="classOptional.html">Optional</a>, specifies how to animate the particles' texture &ndash; v5.6.0 and later: set length to -1 to synchronize the length &ndash; of the animation with the expiration time of individual particles. &ndash; (-2 causes the animation to be played twice, and so on)</p>
<p>glow = 0, &ndash; <a class="el" href="classOptional.html">Optional</a>, specify particle self-luminescence in darkness. &ndash; Values 0-14.</p>
<p>node = {name = "ignore", param2 = 0}, &ndash; <a class="el" href="classOptional.html">Optional</a>, if specified the particles will have the same appearance as &ndash; node dig particles for the given node. &ndash; <code>texture</code> and <code>animation</code> will be ignored if this is set.</p>
<p>node_tile = 0, &ndash; <a class="el" href="classOptional.html">Optional</a>, only valid in combination with <code>node</code> &ndash; If set to a valid number 1-6, specifies the tile from which the &ndash; particle texture is picked. &ndash; Otherwise, the default behavior is used. (currently: any random tile)</p>
<p>&ndash; Legacy definition fields</p>
<p>minpos = {x=0, y=0, z=0}, maxpos = {x=0, y=0, z=0}, minvel = {x=0, y=0, z=0}, maxvel = {x=0, y=0, z=0}, minacc = {x=0, y=0, z=0}, maxacc = {x=0, y=0, z=0}, minexptime = 1, maxexptime = 1, minsize = 1, maxsize = 1, &ndash; The particles' properties are random values between the min and max &ndash; values. &ndash; applies to: pos, velocity, acceleration, expirationtime, size &ndash; If <code>node</code> is set, min and maxsize can be set to 0 to spawn &ndash; randomly-sized particles (just like actual node dig particles). } </p><div class="fragment"><div class="line">### Modern definition fields</div>
<div class="line"> </div>
<div class="line">After v5.6.0, spawner properties can be defined in several different ways depending</div>
<div class="line">on the level of control you need. `pos` for instance can be set as a single vector,</div>
<div class="line">in which case all particles will appear at that exact point throughout the lifetime</div>
<div class="line">of the spawner. Alternately, it can be specified as a min-max pair, specifying a</div>
<div class="line">cubic range the particles can appear randomly within. Finally, some properties can</div>
<div class="line">be animated by suffixing their key with `_tween` (e.g. `pos_tween`) and supplying</div>
<div class="line">a tween table.</div>
<div class="line"> </div>
<div class="line">The following definitions are all equivalent, listed in order of precedence from</div>
<div class="line">lowest (the legacy syntax) to highest (tween tables). If multiple forms of a</div>
<div class="line">property definition are present, the highest-precedence form will be selected</div>
<div class="line">and all lower-precedence fields will be ignored, allowing for graceful</div>
<div class="line">degradation in older clients).</div>
<div class="line"> </div>
<div class="line">```lua</div>
<div class="line">{</div>
<div class="line">  -- old syntax</div>
<div class="line">  maxpos = {x = 0, y = 0, z = 0},</div>
<div class="line">  minpos = {x = 0, y = 0, z = 0},</div>
<div class="line"> </div>
<div class="line">  -- absolute value</div>
<div class="line">  pos = 0,</div>
<div class="line">  -- all components of every particle&#39;s position vector will be set to this</div>
<div class="line">  -- value</div>
<div class="line"> </div>
<div class="line">  -- vec3</div>
<div class="line">  pos = vector.new(0,0,0),</div>
<div class="line">  -- all particles will appear at this exact position throughout the lifetime</div>
<div class="line">  -- of the particlespawner</div>
<div class="line"> </div>
<div class="line">  -- vec3 range</div>
<div class="line">  pos = {</div>
<div class="line">        -- the particle will appear at a position that is picked at random from</div>
<div class="line">        -- within a cubic range</div>
<div class="line"> </div>
<div class="line">        min = vector.new(0,0,0),</div>
<div class="line">        -- `min` is the minimum value this property will be set to in particles</div>
<div class="line">        -- spawned by the generator</div>
<div class="line"> </div>
<div class="line">        max = vector.new(0,0,0),</div>
<div class="line">        -- `max` is the minimum value this property will be set to in particles</div>
<div class="line">        -- spawned by the generator</div>
<div class="line"> </div>
<div class="line">        bias = 0,</div>
<div class="line">        -- when `bias` is 0, all random values are exactly as likely as any</div>
<div class="line">        -- other. when it is positive, the higher it is, the more likely values</div>
<div class="line">        -- will appear towards the minimum end of the allowed spectrum. when</div>
<div class="line">        -- it is negative, the lower it is, the more likely values will appear</div>
<div class="line">        -- towards the maximum end of the allowed spectrum. the curve is</div>
<div class="line">        -- exponential and there is no particular maximum or minimum value</div>
<div class="line">    },</div>
<div class="line"> </div>
<div class="line">    -- tween table</div>
<div class="line">    pos_tween = {...},</div>
<div class="line">    -- a tween table should consist of a list of frames in the same form as the</div>
<div class="line">    -- untweened pos property above, which the engine will interpolate between,</div>
<div class="line">    -- and optionally a number of properties that control how the interpolation</div>
<div class="line">    -- takes place. currently **only two frames**, the first and the last, are</div>
<div class="line">    -- used, but extra frames are accepted for the sake of forward compatibility.</div>
<div class="line">    -- any of the above definition styles can be used here as well in any combination</div>
<div class="line">    -- supported by the property type</div>
<div class="line"> </div>
<div class="line">    pos_tween = {</div>
<div class="line">        style = &quot;fwd&quot;,</div>
<div class="line">        -- linear animation from first to last frame (default)</div>
<div class="line">        style = &quot;rev&quot;,</div>
<div class="line">        -- linear animation from last to first frame</div>
<div class="line">        style = &quot;pulse&quot;,</div>
<div class="line">        -- linear animation from first to last then back to first again</div>
<div class="line">        style = &quot;flicker&quot;,</div>
<div class="line">        -- like &quot;pulse&quot;, but slightly randomized to add a bit of stutter</div>
<div class="line"> </div>
<div class="line">        reps = 1,</div>
<div class="line">        -- number of times the animation is played over the particle&#39;s lifespan</div>
<div class="line"> </div>
<div class="line">        start = 0.0,</div>
<div class="line">        -- point in the spawner&#39;s lifespan at which the animation begins. 0 is</div>
<div class="line">        -- the very beginning, 1 is the very end</div>
<div class="line"> </div>
<div class="line">        -- frames can be defined in a number of different ways, depending on the</div>
<div class="line">        -- underlying type of the property. for now, all but the first and last</div>
<div class="line">        -- frame are ignored</div>
<div class="line"> </div>
<div class="line">        -- frames</div>
<div class="line"> </div>
<div class="line">            -- floats</div>
<div class="line">            0, 0,</div>
<div class="line"> </div>
<div class="line">            -- vec3s</div>
<div class="line">            vector.new(0,0,0),</div>
<div class="line">            vector.new(0,0,0),</div>
<div class="line"> </div>
<div class="line">            -- vec3 ranges</div>
<div class="line">            { min = vector.new(0,0,0), max = vector.new(0,0,0), bias = 0 },</div>
<div class="line">            { min = vector.new(0,0,0), max = vector.new(0,0,0), bias = 0 },</div>
<div class="line"> </div>
<div class="line">            -- mixed</div>
<div class="line">            0, { min = vector.new(0,0,0), max = vector.new(0,0,0), bias = 0 },</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><p>All of the properties that can be defined in this way are listed in the next section, along with the datatypes they accept.</p>
<h4><a class="anchor" id="autotoc_md1135"></a>
List of particlespawner properties</h4>
<p>All of the properties in this list can be animated with <code>*_tween</code> tables unless otherwise specified. For example, <code>jitter</code> can be tweened by setting a <code>jitter_tween</code> table instead of (or in addition to) a <code>jitter</code> table/value. In this section, a float range is a table defined as so: { min = A, max = B } A and B are your supplemented values. For a vec3 range this means they are vectors. Types used are defined in the previous section.</p>
<ul>
<li>vec3 range <code>pos</code>: the position at which particles can appear</li>
<li>vec3 range <code>vel</code>: the initial velocity of the particle</li>
<li>vec3 range <code>acc</code>: the direction and speed with which the particle accelerates</li>
<li>vec3 range <code>jitter</code>: offsets the velocity of each particle by a random amount within the specified range each frame. used to create Brownian motion.</li>
<li>vec3 range <code>drag</code>: the amount by which absolute particle velocity along each axis is decreased per second. a value of 1.0 means that the particle will be slowed to a stop over the space of a second; a value of -1.0 means that the particle speed will be doubled every second. to avoid interfering with gravity provided by <code>acc</code>, a drag vector like <code>vector.new(1,0,1)</code> can be used instead of a uniform value.</li>
<li>float range <code>bounce</code>: how bouncy the particles are when <code>collisiondetection</code> is turned on. values less than or equal to <code>0</code> turn off particle bounce; <code>1</code> makes the particles bounce without losing any velocity, and <code>2</code> makes them double their velocity with every bounce. <code>bounce</code> is not bounded but values much larger than <code>1.0</code> probably aren't very useful.</li>
<li>float range <code>exptime</code>: the number of seconds after which the particle disappears.</li>
<li>table <code>attract</code>: sets the birth orientation of particles relative to various shapes defined in world coordinate space. this is an alternative means of setting the velocity which allows particles to emerge from or enter into some entity or node on the map, rather than simply being assigned random velocity values within a range. the velocity calculated by this method will be <b>added</b> to that specified by <code>vel</code> if <code>vel</code> is also set, so in most cases **<code>vel</code> should be set to 0**. <code>attract</code> has the fields:<ul>
<li>string <code>kind</code>: selects the kind of shape towards which the particles will be oriented. it must have one of the following values:<ul>
<li><code>"none"</code>: no attractor is set and the <code>attractor</code> table is ignored</li>
<li><code>"point"</code>: the particles are attracted to a specific point in space. use this also if you want a sphere-like effect, in combination with the <code>radius</code> property.</li>
<li><code>"line"</code>: the particles are attracted to an (infinite) line passing through the points <code>origin</code> and <code>angle</code>. use this for e.g. beacon effects, energy beam effects, etc.</li>
<li><code>"plane"</code>: the particles are attracted to an (infinite) plane on whose surface <code>origin</code> designates a point in world coordinate space. use this for e.g. particles entering or emerging from a portal.</li>
</ul>
</li>
<li>float range <code>strength</code>: the speed with which particles will move towards <code>attractor</code>. If negative, the particles will instead move away from that point.</li>
<li>vec3 <code>origin</code>: the origin point of the shape towards which particles will initially be oriented. functions as an offset if <code>origin_attached</code> is also set.</li>
<li>vec3 <code>direction</code>: sets the direction in which the attractor shape faces. for lines, this sets the angle of the line; e.g. a vector of (0,1,0) will create a vertical line that passes through <code>origin</code>. for planes, <code>direction</code> is the surface normal of an infinite plane on whose surface <code>origin</code> is a point. functions as an offset if <code>direction_attached</code> is also set.</li>
<li>entity <code>origin_attached</code>: allows the origin to be specified as an offset from the position of an entity rather than a coordinate in world space.</li>
<li>entity <code>direction_attached</code>: allows the direction to be specified as an offset from the position of an entity rather than a coordinate in world space.</li>
<li>bool <code>die_on_contact</code>: if true, the particles' lifetimes are adjusted so that they will die as they cross the attractor threshold. this behavior is the default but is undesirable for some kinds of animations; set it to false to allow particles to live out their natural lives.</li>
</ul>
</li>
<li>vec3 range <code>radius</code>: if set, particles will be arranged in a sphere around <code>pos</code>. A constant can be used to create a spherical shell of particles, a vector to create an ovoid shell, and a range to create a volume; e.g. <code>{min = 0.5, max = 1, bias = 1}</code> will allow particles to appear between 0.5 and 1 nodes away from <code>pos</code> but will cluster them towards the center of the sphere. Usually if <code>radius</code> is used, <code>pos</code> should be a single point, but it can still be a range if you really know what you're doing (e.g. to create a "roundcube" emitter volume).</li>
</ul>
<h3><a class="anchor" id="autotoc_md1136"></a>
Textures</h3>
<p>In versions before v5.6.0, particlespawner textures could only be specified as a single texture string. After v5.6.0, textures can now be specified as a table as well. This table contains options that allow simple animations to be applied to the texture.</p>
<div class="fragment"><div class="line">texture = {</div>
<div class="line">    name = &quot;mymod_particle_texture.png&quot;,</div>
<div class="line">    -- the texture specification string</div>
<div class="line"> </div>
<div class="line">    alpha = 1.0,</div>
<div class="line">    -- controls how visible the particle is; at 1.0 the particle is fully</div>
<div class="line">    -- visible, at 0, it is completely invisible.</div>
<div class="line"> </div>
<div class="line">    alpha_tween = {1, 0},</div>
<div class="line">    -- can be used instead of `alpha` to animate the alpha value over the</div>
<div class="line">    -- particle&#39;s lifetime. these tween tables work identically to the tween</div>
<div class="line">    -- tables used in particlespawner properties, except that time references</div>
<div class="line">    -- are understood with respect to the particle&#39;s lifetime, not the</div>
<div class="line">    -- spawner&#39;s. {1,0} fades the particle out over its lifetime.</div>
<div class="line"> </div>
<div class="line">    scale = 1,</div>
<div class="line">    scale = {x = 1, y = 1},</div>
<div class="line">    -- scales the texture onscreen</div>
<div class="line"> </div>
<div class="line">    scale_tween = {</div>
<div class="line">        {x = 1, y = 1},</div>
<div class="line">        {x = 0, y = 1},</div>
<div class="line">    },</div>
<div class="line">    -- animates the scale over the particle&#39;s lifetime. works like the</div>
<div class="line">    -- alpha_tween table, but can accept two-dimensional vectors as well as</div>
<div class="line">    -- integer values. the example value would cause the particle to shrink</div>
<div class="line">    -- in one dimension over the course of its life until it disappears</div>
<div class="line"> </div>
<div class="line">    blend = &quot;alpha&quot;,</div>
<div class="line">    -- (default) blends transparent pixels with those they are drawn atop</div>
<div class="line">    -- according to the alpha channel of the source texture. useful for</div>
<div class="line">    -- e.g. material objects like rocks, dirt, smoke, or node chunks</div>
<div class="line">    blend = &quot;add&quot;,</div>
<div class="line">    -- adds the value of pixels to those underneath them, modulo the sources</div>
<div class="line">    -- alpha channel. useful for e.g. bright light effects like sparks or fire</div>
<div class="line">    blend = &quot;screen&quot;,</div>
<div class="line">    -- like &quot;add&quot; but less bright. useful for subtler light effects. note that</div>
<div class="line">    -- this is NOT formally equivalent to the &quot;screen&quot; effect used in image</div>
<div class="line">    -- editors and compositors, as it does not respect the alpha channel of</div>
<div class="line">    -- of the image being blended</div>
<div class="line">    blend = &quot;sub&quot;,</div>
<div class="line">    -- the inverse of &quot;add&quot;; the value of the source pixel is subtracted from</div>
<div class="line">    -- the pixel underneath it. a white pixel will turn whatever is underneath</div>
<div class="line">    -- it black; a black pixel will be &quot;transparent&quot;. useful for creating</div>
<div class="line">    -- darkening effects</div>
<div class="line"> </div>
<div class="line">    animation = {Tile Animation definition},</div>
<div class="line">    -- overrides the particlespawner&#39;s global animation property for a single</div>
<div class="line">    -- specific texture</div>
<div class="line">}</div>
</div><!-- fragment --><p>Instead of setting a single texture definition, it is also possible to set a <code>texpool</code> property. A <code>texpool</code> consists of a list of possible particle textures. Every time a particle is spawned, the engine will pick a texture at random from the <code>texpool</code> and assign it as that particle's texture. You can also specify a <code>texture</code> in addition to a <code>texpool</code>; the <code>texture</code> value will be ignored on newer clients but will be sent to older (pre-v5.6.0) clients that do not implement texpools.</p>
<div class="fragment"><div class="line">texpool = {</div>
<div class="line">    &quot;mymod_particle_texture.png&quot;;</div>
<div class="line">    { name = &quot;mymod_spark.png&quot;, fade = &quot;out&quot; },</div>
<div class="line">    {</div>
<div class="line">      name = &quot;mymod_dust.png&quot;,</div>
<div class="line">      alpha = 0.3,</div>
<div class="line">      scale = 1.5,</div>
<div class="line">      animation = {</div>
<div class="line">            type = &quot;vertical_frames&quot;,</div>
<div class="line">            aspect_w = 16, aspect_h = 16,</div>
<div class="line"> </div>
<div class="line">            length = 3,</div>
<div class="line">            -- the animation lasts for 3s and then repeats</div>
<div class="line">            length = -3,</div>
<div class="line">            -- repeat the animation three times over the particle&#39;s lifetime</div>
<div class="line">            -- (post-v5.6.0 clients only)</div>
<div class="line">      },</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1137"></a>
List of animatable texture properties</h4>
<p>While animated particlespawner values vary over the course of the particlespawner's lifetime, animated texture properties vary over the lifespans of the individual particles spawned with that texture. So a particle with the texture property</p>
<div class="fragment"><div class="line">alpha_tween = {</div>
<div class="line">    0.0, 1.0,</div>
<div class="line">    style = &quot;pulse&quot;,</div>
<div class="line">    reps = 4,</div>
<div class="line">}</div>
</div><!-- fragment --><p>would be invisible at its spawning, pulse visible four times throughout its lifespan, and then vanish again before expiring.</p>
<ul>
<li>float <code>alpha</code> (0.0 - 1.0): controls the visibility of the texture</li>
<li>vec2 <code>scale</code>: controls the size of the displayed billboard onscreen. Its units are multiples of the parent particle's assigned size (see the <code>size</code> property above)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1138"></a>
&lt;tt&gt;HTTPRequest&lt;/tt&gt; definition</h2>
<p>Used by <code>HTTPApiTable.fetch</code> and <code>HTTPApiTable.fetch_async</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    url = &quot;http://example.org&quot;,</div>
<div class="line"> </div>
<div class="line">    timeout = 10,</div>
<div class="line">    -- Timeout for request to be completed in seconds. Default depends on engine settings.</div>
<div class="line"> </div>
<div class="line">    method = &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot; or &quot;DELETE&quot;</div>
<div class="line">    -- The http method to use. Defaults to &quot;GET&quot;.</div>
<div class="line"> </div>
<div class="line">    data = &quot;Raw request data string&quot; OR {field1 = &quot;data1&quot;, field2 = &quot;data2&quot;},</div>
<div class="line">    -- Data for the POST, PUT or DELETE request.</div>
<div class="line">    -- Accepts both a string and a table. If a table is specified, encodes</div>
<div class="line">    -- table as x-www-form-urlencoded key-value pairs.</div>
<div class="line"> </div>
<div class="line">    user_agent = &quot;ExampleUserAgent&quot;,</div>
<div class="line">    -- Optional, if specified replaces the default minetest user agent with</div>
<div class="line">    -- given string</div>
<div class="line"> </div>
<div class="line">    extra_headers = { &quot;Accept-Language: en-us&quot;, &quot;Accept-Charset: utf-8&quot; },</div>
<div class="line">    -- Optional, if specified adds additional headers to the HTTP request.</div>
<div class="line">    -- You must make sure that the header strings follow HTTP specification</div>
<div class="line">    -- (&quot;Key: Value&quot;).</div>
<div class="line"> </div>
<div class="line">    multipart = boolean</div>
<div class="line">    -- Optional, if true performs a multipart HTTP request.</div>
<div class="line">    -- Default is false.</div>
<div class="line">    -- Post only, data must be array</div>
<div class="line"> </div>
<div class="line">    post_data = &quot;Raw POST request data string&quot; OR {field1 = &quot;data1&quot;, field2 = &quot;data2&quot;},</div>
<div class="line">    -- Deprecated, use `data` instead. Forces `method = &quot;POST&quot;`.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1139"></a>
&lt;tt&gt;HTTPRequestResult&lt;/tt&gt; definition</h2>
<p>Passed to <code>HTTPApiTable.fetch</code> callback. Returned by <code>HTTPApiTable.fetch_async_get</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    completed = true,</div>
<div class="line">    -- If true, the request has finished (either succeeded, failed or timed</div>
<div class="line">    -- out)</div>
<div class="line"> </div>
<div class="line">    succeeded = true,</div>
<div class="line">    -- If true, the request was successful</div>
<div class="line"> </div>
<div class="line">    timeout = false,</div>
<div class="line">    -- If true, the request timed out</div>
<div class="line"> </div>
<div class="line">    code = 200,</div>
<div class="line">    -- HTTP status code</div>
<div class="line"> </div>
<div class="line">    data = &quot;response&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1140"></a>
Authentication handler definition</h2>
<p>Used by <code>minetest.register_authentication_handler</code>.</p>
<p>```lua { get_auth = function(name), &ndash; Get authentication data for existing player <code>name</code> (<code>nil</code> if player &ndash; doesn't exist). &ndash; Returns following structure: &ndash; <code>{password=&lt;string&gt;, privileges=&lt;table&gt;, last_login=&lt;number or nil&gt;}</code></p>
<p>create_auth = function(name, password), &ndash; Create new auth data for player <code>name</code>. &ndash; Note that <code>password</code> is not plain-text but an arbitrary &ndash; representation decided by the engine.</p>
<p>delete_auth = function(name), &ndash; Delete auth data of player <code>name</code>. &ndash; Returns boolean indicating success (false if player is nonexistent).</p>
<p>set_password = function(name, password), &ndash; Set password of player <code>name</code> to <code>password</code>. &ndash; Auth data should be created if not present.</p>
<p>set_privileges = function(name, privileges), &ndash; Set privileges of player <code>name</code>. &ndash; <code>privileges</code> is in table form, auth data should be created if not &ndash; present.</p>
<p>reload = function(), &ndash; Reload authentication data from the storage location. &ndash; Returns boolean indicating success.</p>
<p>record_login = function(name), &ndash; Called when player joins, used for keeping track of last_login</p>
<p>iterate = function(), &ndash; Returns an iterator (use with <code>for</code> loops) for all player names &ndash; currently in the auth database } ```</p>
<h2><a class="anchor" id="autotoc_md1141"></a>
Bit Library</h2>
<p>Functions: bit.tobit, bit.tohex, bit.bnot, bit.band, bit.bor, bit.bxor, bit.lshift, bit.rshift, bit.arshift, bit.rol, bit.ror, bit.bswap</p>
<p>See <a href="http://bitop.luajit.org/">http://bitop.luajit.org/</a> for advanced information.</p>
<h2><a class="anchor" id="autotoc_md1142"></a>
Error Handling</h2>
<p>When an error occurs that is not caught, Minetest calls the function <code>minetest.error_handler</code> with the error object as its first argument. The second argument is the stack level where the error occurred. The return value is the error string that should be shown. By default this is a backtrace from <code>debug.traceback</code>. If the error object is not a string, it is first converted with <code>tostring</code> before being displayed. This means that you can use tables as error objects so long as you give them <code>__tostring</code> metamethods.</p>
<p>You can override <code>minetest.error_handler</code>. You should call the previous handler with the correct stack level in your implementation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
